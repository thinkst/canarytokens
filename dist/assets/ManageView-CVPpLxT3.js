const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ManageToken-Dn5bZ6Pf.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-u89F_Qyh.js","assets/index-DpRmQAbD.js","assets/index-DeFGzVqy.css","assets/ManageToken-BSJlWt4W.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-DnW5CRfg.js","assets/BaseCodeSnippet.vue_vue_type_script_setup_true_lang-CoQ4SXyK.js","assets/BaseCopyButton-DeB9flV3.js","assets/BaseCopyButton-LPnTCIdy.css","assets/BaseCodeSnippet-D6zLgBnL.css","assets/ManageToken-B7S66wF4.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-C4vCRP2D.js","assets/ManageToken-CYI1B9-n.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-CnYHlqUk.js","assets/ManageToken-BA8nyymr.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-DJYITR2I.js","assets/BaseSwitch-CruQz2-7.js","assets/BaseSwitch-DoZCPshJ.css","assets/ManageToken-BxAJcjKf.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-MM2pN29y.js","assets/ManageToken-CIVltMYx.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-DskIDesB.js","assets/TokenDisplay-BlTd1c62.css","assets/ManageToken-VLYuytys.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-C-cX8COu.js","assets/ManageToken-B9gdzDld.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-_KQ063vi.js","assets/ManageToken-DkMC9c7J.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-BM16C0EP.js","assets/ManageToken-C4Go817p.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-DwmrcMjv.js","assets/TokenDisplay-DxajFBBI.css","assets/ManageToken-CeRxh4v2.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-Dlf2TpQu.js","assets/ManageToken-Bix2gmDQ.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-CQuzBA0e.js","assets/ManageToken-Crc9zNkh.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-Dr60ryqt.js","assets/ManageToken-MGEae6n7.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-BNK0afRy.js","assets/ManageToken-zpuxtiDG.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-D0GosO3y.js","assets/ManageToken-C3QI_3AQ.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-B_EQyaGC.js","assets/pwaIconService-CUPfSyaP.js","assets/ManageToken-DPasi7kR.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-BhqjhDXJ.js","assets/ManageToken-DcL_5e-j.js","assets/ManageToken-BkyiOH0f.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-T4jbU5Dy.js","assets/ManageToken-BjN59b6X.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-G7cAI1Xk.js","assets/ManageToken-l1hpzbJC.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-D3WXEHdp.js","assets/ManageToken-BwrId9CU.js","assets/generateSVNToken-BEAqsqRu.js","assets/ManageToken-C7hN4CN0.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-BPdYmB0Q.js","assets/ManageToken-CVD0Lu4q.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-DqMEdGfd.js","assets/ManageToken-BwfjZ809.js","assets/TokenDisplay-DBrrF0oE.js","assets/TokenDisplay-2eAMrOh4.css","assets/ManageToken-JARUpXFZ.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-DuIHFea7.js","assets/ManageToken-3zvy-7iW.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-BF5dD-ag.js","assets/ManageToken-CwX8SKmf.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-BHhomiZI.js"])))=>i.map(i=>d[i]);
import{A as H}from"./AppLayoutOneColumn-CV0K8Hhf.js";import{d as O,r as m,o as K,S as p,a as _,c as h,b as w,w as V,u as E,e as T,T as C,G as j,U,s as Y,f as u,g as S,h as x,i as d,j as f,_ as q,k as N,n as F,l as W,t as B,m as z,p as $,q as G,v as J,x as Z,y as Q,z as X,A as ee,B as oe,C as ae,D as te,E as D,F as ne,H as se,I as re,J as le,K as ue,L as _e,M as ie,N as o}from"./index-DpRmQAbD.js";import{_ as de}from"./BaseSwitch-CruQz2-7.js";const ce={class:"flex flex-col gap-24"},L="An error occurred. Please try again.",pe=O({__name:"SettingsToken",props:{tokenBackendResponse:{}},setup(R){const n=R;function s(){return n.tokenBackendResponse.canarydrop.type===C.WEB_BUG||n.tokenBackendResponse.canarydrop.type===C.WEB_IMAGE||n.tokenBackendResponse.canarydrop.type===C.IDP_APP}function r(){return n.tokenBackendResponse.canarydrop.type===C.WEB_IMAGE}const v=m(n.tokenBackendResponse.canarydrop.alert_email_recipient),t=m(n.tokenBackendResponse.canarydrop.alert_webhook_url),M=m(s()),A=m(r()),e=m({[p.EMAIL]:!1,[p.WEB_HOOK]:!1,[p.BROWSER_SCANNER]:!1,[p.WEB_IMAGE]:!1}),k=m({[p.EMAIL]:!1,[p.WEB_HOOK]:!1,[p.BROWSER_SCANNER]:!1,[p.WEB_IMAGE]:!1}),i=m({[p.EMAIL]:!1,[p.WEB_HOOK]:!1,[p.BROWSER_SCANNER]:!1,[p.WEB_IMAGE]:!1});K(()=>{Object.keys(p).forEach(c=>{const l=j[c];e.value[c]=!!n.tokenBackendResponse.canarydrop[l],k.value[c]=!1,i.value[c]=!1})});function I(c){return c?"on":"off"}async function b(c,l){var a;const y={value:I(l),token:(a=n.tokenBackendResponse.canarydrop.canarytoken)==null?void 0:a._value,auth:n.tokenBackendResponse.canarydrop.auth,setting:U[c]};Object.keys(i.value).forEach(g=>{i.value[g]=!1}),k.value[c]=!0;try{const g=await Y(y);g.status===200?e.value[c]=l:(console.log("Error:",g.data.detail),i.value[c]=!0)}catch(g){console.log(g,"error!"),i.value[c]=!0}finally{k.value[c]=!1}}return(c,l)=>{const y=de;return _(),h("div",ce,[v.value?(_(),w(y,{key:0,id:"email-alert",modelValue:e.value.EMAIL,"onUpdate:modelValue":l[0]||(l[0]=a=>e.value.EMAIL=a),label:"Email alerts","helper-message":c.tokenBackendResponse.canarydrop.alert_email_recipient,loading:k.value.EMAIL,"has-error":i.value.EMAIL,"error-message":L,onClick:l[1]||(l[1]=V(a=>b(E(p).EMAIL,!e.value.EMAIL),["prevent"]))},null,8,["modelValue","helper-message","loading","has-error"])):T("",!0),t.value?(_(),w(y,{key:1,id:"webhook-alert",modelValue:e.value.WEB_HOOK,"onUpdate:modelValue":l[2]||(l[2]=a=>e.value.WEB_HOOK=a),label:"Webhook reporting","helper-message":n.tokenBackendResponse.canarydrop.alert_webhook_url,loading:k.value.WEB_HOOK,"has-error":i.value.WEB_HOOK,"error-message":L,onClick:l[3]||(l[3]=V(a=>b(E(p).WEB_HOOK,!e.value.WEB_HOOK),["prevent"]))},null,8,["modelValue","helper-message","loading","has-error"])):T("",!0),M.value?(_(),w(y,{key:2,id:"browser-alert",modelValue:e.value.BROWSER_SCANNER,"onUpdate:modelValue":l[4]||(l[4]=a=>e.value.BROWSER_SCANNER=a),label:"Browser scanner","helper-message":"Runs Javascript fingerprinting when the token is browsed",loading:k.value.BROWSER_SCANNER,"has-error":i.value.BROWSER_SCANNER,"error-message":L,onClick:l[5]||(l[5]=V(a=>b(E(p).BROWSER_SCANNER,!e.value.BROWSER_SCANNER),["prevent"]))},null,8,["modelValue","loading","has-error"])):T("",!0),A.value?(_(),w(y,{key:3,id:"custom-image",modelValue:e.value.WEB_IMAGE,"onUpdate:modelValue":l[6]||(l[6]=a=>e.value.WEB_IMAGE=a),label:"Custom web image","helper-message":"Serve your alternative image",loading:k.value.WEB_IMAGE,"has-error":i.value.WEB_IMAGE,"error-message":L,onClick:l[7]||(l[7]=V(a=>b(E(p).WEB_IMAGE,!e.value.WEB_IMAGE),["prevent"]))},null,8,["modelValue","loading","has-error"])):T("",!0)])}}}),me={class:"grid sm:grid-cols-[1fr_5fr] border gap-32 border-grey-200 items-center p-32 bg-white rounded-3xl shadow-solid-shadow-grey"},ve={class:"justify-center hidden sm:flex"},ke=["src"],ge={class:"text-left"},fe={class:"mt-16 leading-relaxed text-balance text-grey-500"},Ee=O({__name:"BannerTextCanarytools",setup(R){return(n,s)=>{const r=q;return _(),h("div",me,[u("div",ve,[u("img",{src:E(S)("thinkst_canary_logo.png"),alt:"logo Canarytokens",class:"w-full sm:block max-w-[8rem]"},null,8,ke)]),u("div",ge,[s[2]||(s[2]=u("p",{class:"text-xl font-semibold leading-normal text-grey-800"}," We hope you enjoy the free version of Canarytokens! ",-1)),u("p",fe,[s[1]||(s[1]=x(" For more (non-public) tokens, support, mass-deployment-tools and better management of your deployed tokens, check out our commercial offering at ")),d(r,{class:"font-semibold",href:"https://canary.tools",target:"_blank"},{default:f(()=>s[0]||(s[0]=[x("https://canary.tools")])),_:1})])])])}}}),ye={class:"relative mb-16"},he=["src","alt"],Te={key:1,class:"flex flex-row justify-center w-full"},we=O({__name:"DeleteTokenModal",props:{auth:{},token:{},type:{},closeModal:{type:Function}},setup(R){const n=N(),s=m(!1),r=m(""),v=m(""),t=R,M=async()=>{s.value=!0,r.value="";const A={auth:t.auth,token:t.token};try{const e=await z(A);e.status===200?(v.value="Yay! Your Canarytoken, plus associated alerts, has been successfully deleted.",setTimeout(()=>{t.closeModal(),n.push({name:"home"})},3e3)):e.status===404?(t.closeModal(),n.push({name:"error"})):r.value="Oh no! Something went wrong when deleting your Canarytoken."}catch(e){console.log(e,"err!"),r.value=e.toString()}finally{s.value=!1}};return(A,e)=>{const k=$,i=G,I=J;return _(),w(I,{"documentation-link":"","has-back-button":!1,title:"Delete token","has-close-button":!0},{footer:f(()=>[u("div",null,[r.value||v.value?(_(),w(k,{key:0,class:F(`w-[90%] m-auto ${r.value?"mb-16":""}`),variant:v.value?"success":"danger",message:r.value||v.value},null,8,["class","variant","message"])):T("",!0),v.value?T("",!0):(_(),h("div",Te,[d(i,{variant:"grey",class:"mr-8",onClick:e[0]||(e[0]=b=>A.closeModal())},{default:f(()=>e[2]||(e[2]=[x("No, keep it")])),_:1}),d(i,{variant:"danger",loading:s.value,onClick:e[1]||(e[1]=b=>M())},{default:f(()=>e[3]||(e[3]=[x("Yes, delete")])),_:1},8,["loading"])]))])]),default:f(()=>[u("span",ye,[d(W,{title:E(B)[t.type].label,"logo-img-url":E(B)[t.type].icon,class:"h-[6rem] w-[6rem]","has-shadow":!0,"has-animation":!0},null,8,["title","logo-img-url"]),u("img",{src:E(S)("token_icons/delete_token_badge.png"),alt:`${E(B)[t.type].label}`,class:"absolute w-[1.3rem] bottom-[.5rem] right-[.3rem]"},null,8,he)]),e[4]||(e[4]=u("div",{class:"text-center"},[u("p",{class:"text-xl font-semibold leading-normal text-grey-800"}," Are you sure you want to delete this Canarytoken? "),u("p",{class:"mt-8 leading-normal text-normal text-grey-300"}," All associated alerts will be permanently lost ")],-1))]),_:1})}}}),xe={class:"flex flex-row items-center justify-between mt-32"},Re=O({__name:"DeleteTokenButton",props:{memo:{},token:{},auth:{},type:{}},setup(R){function n(s,r,v){const{open:t,close:M}=Z({component:we,attrs:{type:s,auth:r,token:v,closeModal:()=>M()}});t()}return(s,r)=>{const v=G;return _(),h("div",xe,[r[2]||(r[2]=u("div",{class:"flex flex-col"},[u("span",null,"Delete Canarytoken"),u("span",{class:"text-xs leading-4 text-grey-500 pr-[3rem]"},"Remove this Canarytoken and delete all related alerts")],-1)),u("div",null,[d(v,{variant:"danger",border:!0,onClick:r[0]||(r[0]=t=>n(s.type,s.auth,s.token))},{default:f(()=>r[1]||(r[1]=[x("Delete")])),_:1})])])}}}),Ae={},be={class:"flex flex-row items-center self-start flex-grow gap-16 py-8 w-full bg-grey-100 rounded-2xl min-h-[3rem] text-grey"},Me={class:"py-8 text-pretty"};function Be(R,n){const s=X("font-awesome-icon");return _(),h("div",null,[n[0]||(n[0]=u("h3",{class:"inline-block mb-8 text-grey-500"},"Your Memo for this token",-1)),u("div",be,[d(s,{icon:"quote-left",class:"pl-16 text-2xl text-grey-300"}),u("p",Me,[ee(R.$slots,"default")])])])}const Oe=Q(Ae,[["render",Be]]),Ie={key:0,class:"flex flex-col items-center gap-8 mb-24"},Ce={class:"text-xl text-center text-grey-800"},Ve={key:1,class:"flex flex-col items-center w-full gap-8"},De={key:3,class:"md:mx-32 md:max-w-[50vw] w-full"},Le={class:"flex flex-col justify-center p-16 md:p-32 rounded-3xl bg-grey-50"},Pe={class:"flex flex-col w-full gap-8"},Se={key:0},Ne={key:1},We={class:"font-bold"},$e=["href"],Ge={class:"flex justify-center sm:max-w-[50vw]"},He=O({__name:"ManageToken",setup(R){const n=oe(),s=N(),r=m(!1),v=m(null),t=m(),M=m(),A=m({props:{}}),e=m(0),k=m(),i=ae(()=>t.value.canarydrop.expected_referrer==="microsoftonline.com"?C.AZURE_ENTRA_CONFIG:t.value.canarydrop.type);function I(){const y=n.params.auth,a=n.params.token;s.push({name:"history",params:{auth:y,token:a}})}function b(){window.open(k.value.public_location,"_blank")}async function c(){r.value=!0;const y={auth:n.params.auth,token:n.params.token};try{const a=await _e(y);r.value=!1,t.value=a.data,M.value=`token_icons/${B[i.value].icon}`,e.value=t.value.canarydrop.triggered_details.hits.length,k.value=t.value.canarydrop.key_exposed_details,l()}catch(a){console.log(a,"err!"),v.value=a.toString(),s.push({name:"error"})}finally{r.value=!1}}async function l(){A.value=await le(()=>ie(Object.assign({"./tokens/adobe_pdf/ManageToken.vue":()=>o(()=>import("./ManageToken-Dn5bZ6Pf.js"),__vite__mapDeps([0,1,2,3])),"./tokens/aws_keys/ManageToken.vue":()=>o(()=>import("./ManageToken-BSJlWt4W.js"),__vite__mapDeps([4,5,6,7,2,3,8,9])),"./tokens/azure_id/ManageToken.vue":()=>o(()=>import("./ManageToken-B7S66wF4.js"),__vite__mapDeps([10,11,2,3,6,7,8,9])),"./tokens/azure_id_config/ManageToken.vue":()=>o(()=>import("./ManageToken-CYI1B9-n.js"),__vite__mapDeps([12,13,2,3])),"./tokens/clonedsite/ManageToken.vue":()=>o(()=>import("./ManageToken-BA8nyymr.js"),__vite__mapDeps([14,15,16,2,3,17,6,7,8,9])),"./tokens/cmd/ManageToken.vue":()=>o(()=>import("./ManageToken-BxAJcjKf.js"),__vite__mapDeps([18,19,6,7,2,3,8,9])),"./tokens/credit_card_v2/ManageToken.vue":()=>o(()=>import("./ManageToken-CIVltMYx.js"),__vite__mapDeps([20,21,2,3,7,8,22])),"./tokens/cssclonedsite/ManageToken.vue":()=>o(()=>import("./ManageToken-VLYuytys.js"),__vite__mapDeps([23,24,6,7,2,3,8,9])),"./tokens/dns/ManageToken.vue":()=>o(()=>import("./ManageToken-B9gdzDld.js"),__vite__mapDeps([25,26,6,7,2,3,8,9])),"./tokens/fast_redirect/ManageToken.vue":()=>o(()=>import("./ManageToken-DkMC9c7J.js"),__vite__mapDeps([27,28,6,7,2,3,8,9])),"./tokens/idp_app/ManageToken.vue":()=>o(()=>import("./ManageToken-C4Go817p.js"),__vite__mapDeps([29,30,2,3,6,7,8,9,31])),"./tokens/kubeconfig/ManageToken.vue":()=>o(()=>import("./ManageToken-CeRxh4v2.js"),__vite__mapDeps([32,33,2,3])),"./tokens/log4shell/ManageToken.vue":()=>o(()=>import("./ManageToken-Bix2gmDQ.js"),__vite__mapDeps([34,35,6,7,2,3,8,9])),"./tokens/ms_excel/ManageToken.vue":()=>o(()=>import("./ManageToken-Crc9zNkh.js"),__vite__mapDeps([36,37,2,3])),"./tokens/ms_word/ManageToken.vue":()=>o(()=>import("./ManageToken-MGEae6n7.js"),__vite__mapDeps([38,39,2,3])),"./tokens/my_sql/ManageToken.vue":()=>o(()=>import("./ManageToken-zpuxtiDG.js"),__vite__mapDeps([40,41,16,2,3,17,6,7,8,9])),"./tokens/pwa/ManageToken.vue":()=>o(()=>import("./ManageToken-C3QI_3AQ.js"),__vite__mapDeps([42,43,2,3,44])),"./tokens/qr_code/ManageToken.vue":()=>o(()=>import("./ManageToken-DPasi7kR.js"),__vite__mapDeps([45,46,2,3])),"./tokens/signed_exe/ManageToken.vue":()=>o(()=>import("./ManageToken-DcL_5e-j.js"),__vite__mapDeps([47,2,3])),"./tokens/slow_redirect/ManageToken.vue":()=>o(()=>import("./ManageToken-BkyiOH0f.js"),__vite__mapDeps([48,49,6,7,2,3,8,9])),"./tokens/smtp/ManageToken.vue":()=>o(()=>import("./ManageToken-BjN59b6X.js"),__vite__mapDeps([50,51,6,7,2,3,8,9])),"./tokens/sql_server/ManageToken.vue":()=>o(()=>import("./ManageToken-l1hpzbJC.js"),__vite__mapDeps([52,53,6,7,2,3,8,9])),"./tokens/svn/ManageToken.vue":()=>o(()=>import("./ManageToken-BwrId9CU.js"),__vite__mapDeps([54,55,6,7,2,3,8,9])),"./tokens/web/ManageToken.vue":()=>o(()=>import("./ManageToken-C7hN4CN0.js"),__vite__mapDeps([56,57,6,7,2,3,8,9])),"./tokens/web_image/ManageToken.vue":()=>o(()=>import("./ManageToken-CVD0Lu4q.js"),__vite__mapDeps([58,59,6,7,2,3,8,9])),"./tokens/webdav/ManageToken.vue":()=>o(()=>import("./ManageToken-BwfjZ809.js"),__vite__mapDeps([60,61,6,7,2,3,8,9,62])),"./tokens/windows_dir/ManageToken.vue":()=>o(()=>import("./ManageToken-JARUpXFZ.js"),__vite__mapDeps([63,2,3,64])),"./tokens/windows_fake_fs/ManageToken.vue":()=>o(()=>import("./ManageToken-3zvy-7iW.js"),__vite__mapDeps([65,66,2,3])),"./tokens/wireguard/ManageToken.vue":()=>o(()=>import("./ManageToken-CwX8SKmf.js"),__vite__mapDeps([67,68,6,7,2,3,8,9]))}),`./tokens/${i.value}/ManageToken.vue`,4))}return l(),te(()=>n.params.token,c,{immediate:!0}),(y,a)=>{const g=ue,P=$;return _(),h(re,null,[t.value?(_(),h("div",Ie,[d(W,{title:E(B)[i.value].label,"logo-img-url":E(B)[i.value].icon,class:"h-[4rem] w-[4rem]","has-shadow":!1},null,8,["title","logo-img-url"]),u("h2",Ce,D(E(B)[i.value].label),1)])):T("",!0),r.value?(_(),h("div",Ve,[d(g,{type:"circle",class:"w-[60px] h-[60px]"}),d(g,{type:"header",class:"w-[200px]"}),d(g,{type:"rectangle",class:"md:max-w-[50vw] w-full h-[250px] mt-16"})])):T("",!0),v.value?(_(),w(P,{key:2,variant:"danger",message:"Oh no! Something went wrong when managing your Canarytoken data. Please refresh the page or try again later."})):T("",!0),t.value?(_(),h("div",De,[u("div",Le,[(_(),w(se,null,{fallback:f(()=>[u("div",Pe,[d(g,{class:"w-[100px]",type:"text"}),d(g,{class:"w-full",type:"header"})])]),default:f(()=>[(_(),w(ne(A.value),{"token-backend-response":t.value},null,8,["token-backend-response"]))]),_:1})),d(Oe,{class:"mt-32"},{default:f(()=>[x(D(t.value.canarydrop.memo),1)]),_:1}),d(pe,{"token-backend-response":t.value,class:"mt-32"},null,8,["token-backend-response"]),d(P,{class:"mt-32",variant:e.value?"danger":"info","text-link":e.value?"Check History":"",onClick:I},{default:f(()=>[e.value?(_(),h("span",Ne,[a[0]||(a[0]=x(" This Canarytoken has been triggered ")),u("span",We,D(e.value),1),x(" time"+D(e.value>1?"s":""),1)])):(_(),h("span",Se,"This Canarytoken has never been triggered"))]),_:1},8,["variant","text-link"]),k.value?(_(),w(P,{key:0,class:"mt-32",variant:"warning","text-link":"Go to token",onClick:b},{default:f(()=>[a[1]||(a[1]=x(" This Canarytoken has been found ")),u("a",{class:"font-bold",href:k.value.public_location,target:"_blank"},"here",8,$e),a[2]||(a[2]=x(" on the internet. Please replace it with a new Canarytoken. "))]),_:1})):T("",!0),d(Re,{memo:t.value.canarydrop.memo,token:t.value.canarydrop.canarytoken._value,auth:t.value.canarydrop.auth,type:t.value.canarydrop.type},null,8,["memo","token","auth","type"])]),u("div",Ge,[d(Ee,{class:"mt-32 mb-8"})])])):T("",!0)],64)}}}),Ye=O({__name:"ManageView",setup(R){return(n,s)=>(_(),w(H,null,{default:f(()=>[d(He)]),_:1}))}});export{Ye as default};
