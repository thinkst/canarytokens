const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ManageToken-i_fnutN0.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-DK94ZVqI.js","assets/index-HOUULui1.js","assets/index-ChsMcly_.css","assets/ManageToken-C_uMURxy.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-Czjaiyd3.js","assets/BaseCodeSnippet.vue_vue_type_script_setup_true_lang-BUeMzadI.js","assets/BaseCodeSnippet-BD9YfSrM.css","assets/ManageToken-CiE-LrJg.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-BUKQSWKP.js","assets/ManageToken-tWHIlH6q.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-CecIDdpP.js","assets/ManageToken-C7TODrqo.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-6IyZxJpK.js","assets/BaseSwitch-DGTIgwSZ.js","assets/BaseSwitch-DoZCPshJ.css","assets/ManageToken-nHdWfYKI.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-DprqiGWg.js","assets/ManageToken-DzKUO7mS.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-Der4m50V.js","assets/ManageToken-CfdHpl4N.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-D3L0XB7T.js","assets/ManageToken-DoDm45ao.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-DL1LO_UW.js","assets/ManageToken-BinG70e3.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-CMvC4VOT.js","assets/ManageToken-BA4PQvGG.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-r8-uA9Pa.js","assets/ManageToken-C5rRKFXo.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-m-3IcL3N.js","assets/ManageToken-DJFJ1rsC.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-oWZKIiJr.js","assets/ManageToken-DwRTL5vu.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-BwAJpJg2.js","assets/ManageToken-CapjaHo2.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-BticnBXJ.js","assets/pwaIconService-DeNjRsQv.js","assets/ManageToken-B0iAZO6p.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-hScXcl38.js","assets/ManageToken-CzvabOG2.js","assets/ManageToken-DPzdfpf6.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-DLBtcW3Y.js","assets/ManageToken-RMCG0o7y.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-DGbvcO07.js","assets/ManageToken-BUq3BpRq.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-By2BJG6a.js","assets/ManageToken-DsQABDN9.js","assets/generateSVNToken-4-Qt209O.js","assets/ManageToken-COnB-9yq.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-BA9h5UAm.js","assets/ManageToken-Ct2XKBvs.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-CZOTcxeX.js","assets/ManageToken-BReTzsNe.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-DJxZ-XEL.js","assets/ManageToken-fz2rwRpx.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-BjxqjDG_.js"])))=>i.map(i=>d[i]);
import{A as G}from"./AppLayoutOneColumn-BPfiWI2F.js";import{d as O,r as m,o as H,S as c,a as u,c as E,b as h,w as C,u as f,e as T,T as D,G as K,U as j,s as U,f as l,g as L,h as A,i as _,j as y,_ as Y,k as P,n as q,l as N,t as b,m as F,p as W,q as $,v as z,x as J,y as Z,z as Q,A as X,B as ee,C as oe,D as ae,E as V,F as te,H as ne,I as se,J as re,K as le,L as ue,M as ie,N as n}from"./index-HOUULui1.js";import{_ as _e}from"./BaseSwitch-DGTIgwSZ.js";const de={class:"flex flex-col gap-24"},S="An error occurred. Please try again.",ce=O({__name:"SettingsToken",props:{tokenBackendResponse:{}},setup(x){const t=x;function s(){return t.tokenBackendResponse.canarydrop.type===D.WEB_BUG||t.tokenBackendResponse.canarydrop.type===D.WEB_IMAGE}function r(){return t.tokenBackendResponse.canarydrop.type===D.WEB_IMAGE}const v=m(t.tokenBackendResponse.canarydrop.alert_email_recipient),a=m(t.tokenBackendResponse.canarydrop.alert_webhook_url),M=m(s()),w=m(r()),e=m({[c.EMAIL]:!1,[c.WEB_HOOK]:!1,[c.BROWSER_SCANNER]:!1,[c.WEB_IMAGE]:!1}),p=m({[c.EMAIL]:!1,[c.WEB_HOOK]:!1,[c.BROWSER_SCANNER]:!1,[c.WEB_IMAGE]:!1}),k=m({[c.EMAIL]:!1,[c.WEB_HOOK]:!1,[c.BROWSER_SCANNER]:!1,[c.WEB_IMAGE]:!1});H(()=>{Object.keys(c).forEach(i=>{const o=K[i];e.value[i]=!!t.tokenBackendResponse.canarydrop[o],p.value[i]=!1,k.value[i]=!1})});function I(i){return i?"on":"off"}async function R(i,o){var d;const g={value:I(o),token:(d=t.tokenBackendResponse.canarydrop.canarytoken)==null?void 0:d._value,auth:t.tokenBackendResponse.canarydrop.auth,setting:j[i]};Object.keys(k.value).forEach(B=>{k.value[B]=!1}),p.value[i]=!0;try{const B=await U(g);B.status===200?e.value[i]=o:(console.log("Error:",B.data.detail),k.value[i]=!0)}catch(B){console.log(B,"error!"),k.value[i]=!0}finally{p.value[i]=!1}}return(i,o)=>{const g=_e;return u(),E("div",de,[v.value?(u(),h(g,{key:0,id:"email-alert",modelValue:e.value.EMAIL,"onUpdate:modelValue":o[0]||(o[0]=d=>e.value.EMAIL=d),label:"Email alerts","helper-message":i.tokenBackendResponse.canarydrop.alert_email_recipient,loading:p.value.EMAIL,"has-error":k.value.EMAIL,"error-message":S,onClick:o[1]||(o[1]=C(d=>R(f(c).EMAIL,!e.value.EMAIL),["prevent"]))},null,8,["modelValue","helper-message","loading","has-error"])):T("",!0),a.value?(u(),h(g,{key:1,id:"webhook-alert",modelValue:e.value.WEB_HOOK,"onUpdate:modelValue":o[2]||(o[2]=d=>e.value.WEB_HOOK=d),label:"Webhook reporting","helper-message":t.tokenBackendResponse.canarydrop.alert_webhook_url,loading:p.value.WEB_HOOK,"has-error":k.value.WEB_HOOK,"error-message":S,onClick:o[3]||(o[3]=C(d=>R(f(c).WEB_HOOK,!e.value.WEB_HOOK),["prevent"]))},null,8,["modelValue","helper-message","loading","has-error"])):T("",!0),M.value?(u(),h(g,{key:2,id:"browser-alert",modelValue:e.value.BROWSER_SCANNER,"onUpdate:modelValue":o[4]||(o[4]=d=>e.value.BROWSER_SCANNER=d),label:"Browser scanner","helper-message":"Runs Javascript fingerprinting when the token is browsed",loading:p.value.BROWSER_SCANNER,"has-error":k.value.BROWSER_SCANNER,"error-message":S,onClick:o[5]||(o[5]=C(d=>R(f(c).BROWSER_SCANNER,!e.value.BROWSER_SCANNER),["prevent"]))},null,8,["modelValue","loading","has-error"])):T("",!0),w.value?(u(),h(g,{key:3,id:"custom-image",modelValue:e.value.WEB_IMAGE,"onUpdate:modelValue":o[6]||(o[6]=d=>e.value.WEB_IMAGE=d),label:"Custom web image","helper-message":"Serve your alternative image",loading:p.value.WEB_IMAGE,"has-error":k.value.WEB_IMAGE,"error-message":S,onClick:o[7]||(o[7]=C(d=>R(f(c).WEB_IMAGE,!e.value.WEB_IMAGE),["prevent"]))},null,8,["modelValue","loading","has-error"])):T("",!0)])}}}),me={class:"grid sm:grid-cols-[1fr_5fr] border gap-32 border-grey-200 items-center p-32 bg-white rounded-3xl shadow-solid-shadow-grey"},pe={class:"justify-center hidden sm:flex"},ve=["src"],ke={class:"text-left"},ge={class:"mt-16 leading-relaxed text-balance text-grey-500"},fe=O({__name:"BannerTextCanarytools",setup(x){return(t,s)=>{const r=Y;return u(),E("div",me,[l("div",pe,[l("img",{src:f(L)("thinkst_canary_logo.png"),alt:"logo Canarytokens",class:"w-full sm:block max-w-[8rem]"},null,8,ve)]),l("div",ke,[s[2]||(s[2]=l("p",{class:"text-xl font-semibold leading-normal text-grey-800"}," We hope you enjoy the free version of Canarytokens! ",-1)),l("p",ge,[s[1]||(s[1]=A(" For more (non-public) tokens, support, mass-deployment-tools and better management of your deployed tokens, check out our commercial offering at ")),_(r,{class:"font-semibold",href:"https://canary.tools",target:"_blank"},{default:y(()=>s[0]||(s[0]=[A("https://canary.tools")])),_:1})])])])}}}),Ee={class:"relative mb-16"},ye=["src","alt"],he={key:1,class:"flex flex-row justify-center w-full"},Te=O({__name:"DeleteTokenModal",props:{auth:{},token:{},type:{},closeModal:{type:Function}},setup(x){const t=P(),s=m(!1),r=m(""),v=m(""),a=x,M=async()=>{s.value=!0,r.value="";const w={auth:a.auth,token:a.token};try{const e=await F(w);e.status===200?(v.value="Yay! Your Canarytoken, plus associated alerts, has been successfully deleted.",setTimeout(()=>{a.closeModal(),t.push({name:"home"})},3e3)):e.status===404?(a.closeModal(),t.push({name:"error"})):r.value="Oh no! Something went wrong when deleting your Canarytoken."}catch(e){console.log(e,"err!"),r.value=e.toString()}finally{s.value=!1}};return(w,e)=>{const p=W,k=$,I=z;return u(),h(I,{"documentation-link":"","has-back-button":!1,title:"Delete token","has-close-button":!0},{footer:y(()=>[l("div",null,[r.value||v.value?(u(),h(p,{key:0,class:q(`w-[90%] m-auto ${r.value?"mb-16":""}`),variant:v.value?"success":"danger",message:r.value||v.value},null,8,["class","variant","message"])):T("",!0),v.value?T("",!0):(u(),E("div",he,[_(k,{variant:"grey",class:"mr-8",onClick:e[0]||(e[0]=R=>w.closeModal())},{default:y(()=>e[2]||(e[2]=[A("No, keep it")])),_:1}),_(k,{variant:"danger",loading:s.value,onClick:e[1]||(e[1]=R=>M())},{default:y(()=>e[3]||(e[3]=[A("Yes, delete")])),_:1},8,["loading"])]))])]),default:y(()=>[l("span",Ee,[_(N,{title:f(b)[a.type].label,"logo-img-url":f(b)[a.type].icon,class:"h-[6rem] w-[6rem]","has-shadow":!0,"has-animation":!0},null,8,["title","logo-img-url"]),l("img",{src:f(L)("token_icons/delete_token_badge.png"),alt:`${f(b)[a.type].label}`,class:"absolute w-[1.3rem] bottom-[.5rem] right-[.3rem]"},null,8,ye)]),e[4]||(e[4]=l("div",{class:"text-center"},[l("p",{class:"text-xl font-semibold leading-normal text-grey-800"}," Are you sure you want to delete this Canarytoken? "),l("p",{class:"mt-8 leading-normal text-normal text-grey-300"}," All associated alerts will be permanently lost ")],-1))]),_:1})}}}),xe={class:"flex flex-row items-center justify-between mt-32"},Re=O({__name:"DeleteTokenButton",props:{memo:{},token:{},auth:{},type:{}},setup(x){function t(s,r,v){const{open:a,close:M}=J({component:Te,attrs:{type:s,auth:r,token:v,closeModal:()=>M()}});a()}return(s,r)=>{const v=$;return u(),E("div",xe,[r[2]||(r[2]=l("div",{class:"flex flex-col"},[l("span",null,"Delete Canarytoken"),l("span",{class:"text-xs leading-4 text-grey-500 pr-[3rem]"},"Remove this Canarytoken and delete all related alerts")],-1)),l("div",null,[_(v,{variant:"danger",border:!0,onClick:r[0]||(r[0]=a=>t(s.type,s.auth,s.token))},{default:y(()=>r[1]||(r[1]=[A("Delete")])),_:1})])])}}}),we={},Ae={class:"flex flex-row items-center self-start flex-grow gap-16 py-8 w-full bg-grey-100 rounded-2xl min-h-[3rem] text-grey"},Me={class:"py-8 text-pretty"};function be(x,t){const s=Q("font-awesome-icon");return u(),E("div",null,[t[0]||(t[0]=l("h3",{class:"inline-block mb-8 text-grey-500"},"Your Memo for this token",-1)),l("div",Ae,[_(s,{icon:"quote-left",class:"pl-16 text-2xl text-grey-300"}),l("p",Me,[X(x.$slots,"default")])])])}const Be=Z(we,[["render",be]]),Oe={key:0,class:"flex flex-col items-center gap-8 mb-24"},Ie={class:"text-xl text-center text-grey-800"},Ce={key:1,class:"flex flex-col items-center w-full gap-8"},Ve={key:3,class:"md:mx-32 md:max-w-[50vw] w-full"},Se={class:"flex flex-col justify-center p-16 md:p-32 rounded-3xl bg-grey-50"},De={class:"flex flex-col w-full gap-8"},Le={key:0},Pe={key:1},Ne={class:"font-bold"},We={class:"flex justify-center sm:max-w-[50vw]"},$e=O({__name:"ManageToken",setup(x){const t=ee(),s=P(),r=m(!1),v=m(null),a=m(),M=m(),w=m({props:{}}),e=m(0),p=oe(()=>a.value.canarydrop.expected_referrer==="microsoftonline.com"?D.AZURE_ENTRA_CONFIG:a.value.canarydrop.type);function k(){const i=t.params.auth,o=t.params.token;s.push({name:"history",params:{auth:i,token:o}})}async function I(){r.value=!0;const i={auth:t.params.auth,token:t.params.token};try{const o=await ue(i);r.value=!1,a.value=o.data,M.value=`token_icons/${b[p.value].icon}`,e.value=a.value.canarydrop.triggered_details.hits.length,R()}catch(o){console.log(o,"err!"),v.value=o.toString(),s.push({name:"error"})}finally{r.value=!1}}async function R(){w.value=await re(()=>ie(Object.assign({"./tokens/adobe_pdf/ManageToken.vue":()=>n(()=>import("./ManageToken-i_fnutN0.js"),__vite__mapDeps([0,1,2,3])),"./tokens/aws_keys/ManageToken.vue":()=>n(()=>import("./ManageToken-C_uMURxy.js"),__vite__mapDeps([4,5,6,2,3,7])),"./tokens/azure_id/ManageToken.vue":()=>n(()=>import("./ManageToken-CiE-LrJg.js"),__vite__mapDeps([8,9,2,3,6,7])),"./tokens/azure_id_config/ManageToken.vue":()=>n(()=>import("./ManageToken-tWHIlH6q.js"),__vite__mapDeps([10,11,2,3])),"./tokens/clonedsite/ManageToken.vue":()=>n(()=>import("./ManageToken-C7TODrqo.js"),__vite__mapDeps([12,13,14,2,3,15,6,7])),"./tokens/cmd/ManageToken.vue":()=>n(()=>import("./ManageToken-nHdWfYKI.js"),__vite__mapDeps([16,17,2,3])),"./tokens/cssclonedsite/ManageToken.vue":()=>n(()=>import("./ManageToken-DzKUO7mS.js"),__vite__mapDeps([18,19,6,2,3,7])),"./tokens/dns/ManageToken.vue":()=>n(()=>import("./ManageToken-CfdHpl4N.js"),__vite__mapDeps([20,21,6,2,3,7])),"./tokens/fast_redirect/ManageToken.vue":()=>n(()=>import("./ManageToken-DoDm45ao.js"),__vite__mapDeps([22,23,6,2,3,7])),"./tokens/kubeconfig/ManageToken.vue":()=>n(()=>import("./ManageToken-BinG70e3.js"),__vite__mapDeps([24,25,2,3])),"./tokens/log4shell/ManageToken.vue":()=>n(()=>import("./ManageToken-BA4PQvGG.js"),__vite__mapDeps([26,27,6,2,3,7])),"./tokens/ms_excel/ManageToken.vue":()=>n(()=>import("./ManageToken-C5rRKFXo.js"),__vite__mapDeps([28,29,2,3])),"./tokens/ms_word/ManageToken.vue":()=>n(()=>import("./ManageToken-DJFJ1rsC.js"),__vite__mapDeps([30,31,2,3])),"./tokens/my_sql/ManageToken.vue":()=>n(()=>import("./ManageToken-DwRTL5vu.js"),__vite__mapDeps([32,33,14,2,3,15,6,7])),"./tokens/pwa/ManageToken.vue":()=>n(()=>import("./ManageToken-CapjaHo2.js"),__vite__mapDeps([34,35,2,3,36])),"./tokens/qr_code/ManageToken.vue":()=>n(()=>import("./ManageToken-B0iAZO6p.js"),__vite__mapDeps([37,38,2,3])),"./tokens/signed_exe/ManageToken.vue":()=>n(()=>import("./ManageToken-CzvabOG2.js"),__vite__mapDeps([39,2,3])),"./tokens/slow_redirect/ManageToken.vue":()=>n(()=>import("./ManageToken-DPzdfpf6.js"),__vite__mapDeps([40,41,6,2,3,7])),"./tokens/smtp/ManageToken.vue":()=>n(()=>import("./ManageToken-RMCG0o7y.js"),__vite__mapDeps([42,43,6,2,3,7])),"./tokens/sql_server/ManageToken.vue":()=>n(()=>import("./ManageToken-BUq3BpRq.js"),__vite__mapDeps([44,45,6,2,3,7])),"./tokens/svn/ManageToken.vue":()=>n(()=>import("./ManageToken-DsQABDN9.js"),__vite__mapDeps([46,47,6,2,3,7])),"./tokens/web/ManageToken.vue":()=>n(()=>import("./ManageToken-COnB-9yq.js"),__vite__mapDeps([48,49,6,2,3,7])),"./tokens/web_image/ManageToken.vue":()=>n(()=>import("./ManageToken-Ct2XKBvs.js"),__vite__mapDeps([50,51,6,2,3,7])),"./tokens/windows_dir/ManageToken.vue":()=>n(()=>import("./ManageToken-BReTzsNe.js"),__vite__mapDeps([52,2,3,53])),"./tokens/wireguard/ManageToken.vue":()=>n(()=>import("./ManageToken-fz2rwRpx.js"),__vite__mapDeps([54,55,6,2,3,7]))}),`./tokens/${p.value}/ManageToken.vue`,4))}return R(),ae(()=>t.params.token,I,{immediate:!0}),(i,o)=>{const g=le,d=W;return u(),E(se,null,[a.value?(u(),E("div",Oe,[_(N,{title:f(b)[p.value].label,"logo-img-url":f(b)[p.value].icon,class:"h-[4rem] w-[4rem]","has-shadow":!1},null,8,["title","logo-img-url"]),l("h2",Ie,V(f(b)[p.value].label),1)])):T("",!0),r.value?(u(),E("div",Ce,[_(g,{type:"circle",class:"w-[60px] h-[60px]"}),_(g,{type:"header",class:"w-[200px]"}),_(g,{type:"rectangle",class:"md:max-w-[50vw] w-full h-[250px] mt-16"})])):T("",!0),v.value?(u(),h(d,{key:2,variant:"danger",message:"Oh no! Something went wrong when managing your Canarytoken data. Please refresh the page or try again later."})):T("",!0),a.value?(u(),E("div",Ve,[l("div",Se,[(u(),h(ne,null,{fallback:y(()=>[l("div",De,[_(g,{class:"w-[100px]",type:"text"}),_(g,{class:"w-full",type:"header"})])]),default:y(()=>[(u(),h(te(w.value),{"token-backend-response":a.value},null,8,["token-backend-response"]))]),_:1})),_(Be,{class:"mt-32"},{default:y(()=>[A(V(a.value.canarydrop.memo),1)]),_:1}),_(ce,{"token-backend-response":a.value,class:"mt-32"},null,8,["token-backend-response"]),_(d,{class:"mt-32",variant:e.value?"danger":"info","text-link":e.value?"Check History":"",onClick:k},{default:y(()=>[e.value?(u(),E("span",Pe,[o[0]||(o[0]=A(" This Canarytoken has been triggered ")),l("span",Ne,V(e.value),1),A(" time"+V(e.value>1?"s":""),1)])):(u(),E("span",Le,"This Canarytoken has never been triggered"))]),_:1},8,["variant","text-link"]),_(Re,{memo:a.value.canarydrop.memo,token:a.value.canarydrop.canarytoken._value,auth:a.value.canarydrop.auth,type:a.value.canarydrop.type},null,8,["memo","token","auth","type"])]),l("div",We,[_(fe,{class:"mt-32 mb-8"})])])):T("",!0)],64)}}}),je=O({__name:"ManageView",setup(x){return(t,s)=>(u(),h(G,null,{default:y(()=>[_($e)]),_:1}))}});export{je as default};
