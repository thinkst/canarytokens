import{r as h,g as Te,d as q,ab as re,e as s,h as l,a9 as ne,k as t,M as T,y as V,W as Me,H as ye,K as O,L as se,I as J,v as P,j as C,l as b,m as Z,O as G,V as H,q as ae,i as k,au as X,ax as Be,av as he,ay as be,al as De,am as Re,f as U,w as B,ae as oe,p as Ne,o as ie,D as le,az as je,aw as Le,aA as Pe,E as Ae,af as Ve,ag as Ie,aB as ve,aC as Oe,F as fe,C as Ge}from"./index-CVx3_slE.js";import{g as Fe,s as Ue}from"./awsInfra-DAo_AsVB.js";import{a as _e,b as I,c as qe,d as L,e as te}from"./constants-DJ0HIoY4.js";import{_ as Qe}from"./BaseLabel.vue_vue_type_script_setup_true_lang-BxRQFccT.js";function ue($,u){const e=h(""),c=h(!1),o=h(""),n=h(""),v=h(""),d=Te();if(d){const{auth_token:a,token:r}=d;n.value=a,v.value=r}c.value=!0,e.value="";async function g(){try{const a=await Fe(v.value,n.value,$,u);a.data.result||(e.value=a.data.message),o.value=a.data.proposed_data}catch(a){e.value=a.message||"An error occurred"}finally{c.value=!1}}return{handleGenerateName:g,isGenerateNameError:e,isGenerateNameLoading:c,generatedName:o}}const We=["for"],He=["id","disabled","checked"],ze=q({__name:"BaseInputCheckbox",props:{id:{},label:{},modelValue:{type:Boolean},hideLabel:{type:Boolean},tooltipContent:{},disabled:{type:Boolean}},emits:["update:modelValue"],setup($,{emit:u}){const e=$,c=u,o=n=>{const v=n.target;c("update:modelValue",v.checked)};return(n,v)=>{const d=re("tooltip");return s(),l("label",Me(n.$attrs,{for:e.id,class:[{"label-disabled":n.disabled}]}),[ne(t("input",{id:e.id,type:"checkbox",disabled:n.disabled,checked:n.modelValue,onChange:o},null,40,He),[[d,n.tooltipContent&&{content:n.tooltipContent}]]),t("span",{class:V([{"sr-only":e.hideLabel}])},T(n.label),3)],16,We)}}}),Ye=ye(ze,[["__scopeId","data-v-8ba47227"]]),Xe={key:0,class:"asset-card__badge text-xs text-white bg-yellow rounded-lg px-4 py-[2px] absolute"},Je={class:"asset-card__content"},Ze=["src","alt"],Ke={class:"text-sm text-grey-400 text-pretty"},et={class:"asset-card__list-data list-none"},tt={class:"label text-grey-400"},st=["src","alt"],at={class:"asset-card__options"},nt=q({__name:"AssetCard",props:{assetType:{},assetData:{},isActiveSelected:{type:Boolean},viewType:{}},emits:["openAsset","deleteAsset","selectAsset"],setup($,{emit:u}){const e=u,c=$,o=h(!1),n=h(),v=h(!1),d=O(()=>{const m=_e[c.assetType];return c.assetData[m]}),g=O(()=>{const m=_e[c.assetType];return Object.entries(c.assetData).map(([E,N])=>E.includes(m)||E.includes("off_inventory")?null:Array.isArray(N)?[E,N.length]:[E,N]).filter(E=>E!==null)}),a=O(()=>I[c.assetType]),r=O(()=>c.assetData.off_inventory);function x(m){return I[m]}function i(m){return qe.includes(m)}function f(){e("openAsset"),n.value&&n.value.blur()}function y(){o.value=!0}function A(){o.value=!1}function D(m){v.value=m,e("selectAsset",v.value)}return se(()=>c.isActiveSelected,m=>{m===!1&&(v.value=m)}),(m,S)=>{const E=Ye,N=J("font-awesome-icon"),F=re("tooltip");return s(),l("li",{class:V(["asset-card__wrapper",m.viewType])},[r.value?ne((s(),l("span",Xe,S[2]||(S[2]=[P("Not found")]))),[[F,{html:!0,content:"We couldn`t find this resource in your inventory.<br/>If you wish to remove it permanently, delete it from the list."}]]):C("",!0),t("button",{ref_key:"assetCardRef",ref:n,class:V(["asset-card group border group bg-white rounded-2xl top-[0px] border-grey-200 duration-100 ease-in-out",{active:v.value,"border-yellow":r.value}]),onClick:ae(f,["stop"]),onMouseover:y,onFocus:y,onMouseleave:A,onBlur:A},[t("div",Je,[t("img",{src:b(Z)(`aws_infra_icons/${c.assetType}.svg`),alt:`logo-${m.assetType}`,class:"rounded-full"},null,8,Ze),t("p",Ke,T(d.value),1)]),t("ul",et,[(s(!0),l(G,null,H(g.value,([M,Q])=>(s(),l("li",{key:M,class:"text-sm"},[t("span",tt,T(x(M))+": ",1),t("span",{class:V(["value text-grey-700",{"with-icon":i(M)}])},[i(M)?(s(),l("img",{key:0,src:b(Z)(`aws_infra_icons/${M}.svg`),alt:`${M} icon`,class:"w-[1.5rem] h-[1.5rem]"},null,8,st)):C("",!0),t("span",{class:V({"cropped-data":g.value.length>1})},T(Q),3)],2)]))),128))]),t("div",{class:V([{"shadow-solid-shadow-yellow":r.value},"asset-card__btn-edit text-sm w-full leading-5 font-semibold border-t-2 border-grey-50 text-grey-700 h-[2rem] rounded-b-2xl transition duration-100 shadow-solid-shadow-grey"])},T(o.value?"Edit":a.value),3)],34),t("div",at,[k(E,{id:"select-asset",label:"Select asset",class:"input-select text-sm text-grey-500","tooltip-content":"Select asset","hide-label":!0,"model-value":v.value,"onUpdate:modelValue":S[0]||(S[0]=M=>D(M))},null,8,["model-value"]),t("button",{type:"button",class:"list-btn-edit text-sm text-grey-400",onClick:ae(f,["stop"])}," Edit "),ne((s(),l("button",{type:"button",class:"btn-delete w-[1.5rem] text-grey-300 rounded-full hover:text-green-500","aria-label":"Delete asset",onClick:S[1]||(S[1]=M=>e("deleteAsset"))},[k(N,{"aria-hidden":"true",icon:"trash"})])),[[F,{content:"Delete asset"}]])])],2)}}}),z=$=>he().required().label(I[$]),ot=X().shape({bucket_name:z("bucket_name"),objects:Be().of(X().shape({object_path:he().required().label(I.object_path)}))}),lt=X().shape({queue_name:z("queue_name"),message_count:be().typeError(`${I.message_count} must be a number`).required(I.message_count)}),rt=X().shape({ssm_parameter_value:z("ssm_parameter_value"),ssm_parameter_name:z("ssm_parameter_name")}),it=X().shape({secretsmanager_secret_name:z("secretsmanager_secret_name"),secretsmanager_secret_value:z("secretsmanager_secret_value")}),ut=X().shape({dynamodb_partition_key:z("dynamodb_partition_key"),dynamodb_name:z("dynamodb_name"),dynamodb_row_count:be().typeError(`${I.dynamodb_row_count} must be a number`).required(I.dynamodb_row_count)}),ct=X(),dt=["id","value","placeholder","aria-invalid","required","disabled"],pt={class:"error-message"},mt={key:0,id:"error",class:"text-xs leading-4 text-red"},vt={key:1,id:"error",class:"text-xs leading-4 text-red"},ft=q({__name:"AssetTextField",props:{id:{},label:{},placeholder:{},required:{type:Boolean},disabled:{type:Boolean},maxLength:{},variant:{},icon:{},hasRemove:{type:Boolean},hideLabel:{type:Boolean},assetType:{},fieldType:{},value:{}},emits:["update:modelValue","handleRemoveInstance","handleRegenerateInstance"],setup($,{emit:u}){const e=$,{variant:c="large",hasRemove:o=!1,hideLabel:n=!1}=e,v=u,d=De(e,"id"),{value:g,handleChange:a,errorMessage:r,resetField:x}=Re(d,void 0,{initialValue:e.value}),i=h(""),f=h(!1);function y(m){r&&r.value&&a(m)}async function A(){i.value="";const{handleGenerateName:m,isGenerateNameError:S,isGenerateNameLoading:E,generatedName:N}=ue(e.assetType,e.fieldType);f.value=E.value,await m(),i.value=S.value,x({value:N.value}),f.value=!1}const D=O(()=>e.icon?Z(e.icon):"");return se(()=>e.value,m=>{a(m)}),(m,S)=>{const E=Qe,N=Ne,F=J("font-awesome-icon"),M=re("tooltip");return s(),l("div",{class:V(["textfield-wrapper",b(c)])},[b(n)?C("",!0):(s(),U(E,{key:0,id:d.value},{default:B(()=>[P(T(e.label),1)]),_:1},8,["id"])),m.icon?(s(),l("span",{key:1,class:V(["icon",[{"top-[2rem]":!b(n)},{"top-[0.5rem]":b(n)}]]),style:oe({"background-image":`url(${D.value})`})},null,6)):C("",!0),t("input",{id:d.value,value:b(g),class:V([{input__error:b(r)},{input__disabled:m.disabled},{"input__with-icon":m.icon}]),placeholder:m.placeholder,"aria-invalid":!!b(r),"aria-describedby":"helper error",required:m.required,disabled:m.disabled,onBlur:S[0]||(S[0]=(...Q)=>b(a)&&b(a)(...Q)),onInput:S[1]||(S[1]=Q=>y(Q))},null,42,dt),f.value?(s(),U(N,{key:2,height:"1.5rem",class:"textfield__loading"})):C("",!0),t("div",{class:V(["textfield__cta",{"top-[2rem]":!b(n)}])},[f.value?C("",!0):ne((s(),l("button",{key:0,type:"button",class:"textfield__cta__regenerate","aria-label":"Regenerate input content",onClick:A},[k(F,{"aria-hidden":"true",icon:"rotate-right"})])),[[M,{content:"Regenerate content"}]]),b(o)?ne((s(),l("button",{key:1,type:"button",class:"textfield__cta__remove","aria-label":"Remove instance",onClick:S[2]||(S[2]=Q=>v("handleRemoveInstance"))},[k(F,{"aria-hidden":"true",icon:"trash"})])),[[M,{content:"Remove instance"}]]):C("",!0)],2),t("div",pt,[b(r)?(s(),l("p",mt,T(b(r)),1)):C("",!0),i.value?(s(),l("p",vt,T(i.value),1)):C("",!0)])],2)}}}),we=ye(ft,[["__scopeId","data-v-a8a7ca05"]]),_t={class:"flex flex-row justify-between my-16"},gt={class:"flex flex-row gap-8 items-center"},yt=["src","alt"],ht={class:"flex flex-col"},bt={class:"text-grey-500"},At={class:"paginated_object_list__wrapper"},wt={key:0,class:"flex flex-col items-center"},St={class:"mt-16 flex flex-row gap-16"},$t=["disabled"],xt=["onClick"],kt=["disabled"],ge=10,Et=q({__name:"FormObjects",props:{assetType:{},assetKey:{},objectKey:{},fields:{},prepend:{type:Function},remove:{type:Function}},setup($){const u=$,e=h(1),c=h(0),o=h(!1),n=h(""),v=O(()=>Math.ceil(u.fields.length/ge)),d=O(()=>u.objectKey);ie(()=>{a(),window.addEventListener("resize",()=>a())});const g=O(()=>(e.value-1)*c.value);function a(){const A=document.querySelector(".paginated_object_list__wrapper");c.value=A instanceof HTMLElement?A.offsetWidth:0}function r(){return Z(`aws_infra_icons/${u.assetKey}.svg`)}function x(A){return I[A]}function i(){e.value>=1&&e.value--}function f(){e.value<v.value&&e.value++}async function y(){o.value=!0;const{handleGenerateName:A,isGenerateNameError:D,isGenerateNameLoading:m,generatedName:S}=ue(u.assetType,u.objectKey);o.value=m.value,await A(),n.value=D.value,u.prepend({[d.value]:S.value}),o.value=!1}return(A,D)=>{const m=le,S=J("font-awesome-icon");return s(),l(G,null,[t("div",_t,[t("div",gt,[t("img",{src:r(),alt:`icon ${x(u.assetKey)}`,class:"h-[2rem] w-[2rem]"},null,8,yt),t("legend",ht,[t("span",bt,T(x(u.assetKey)),1),t("span",null,T(x(u.objectKey)),1)])]),k(m,{type:"button",variant:"text",icon:"plus",loading:o.value,onClick:y},{default:B(()=>D[0]||(D[0]=[P(" Add object ")])),_:1},8,["loading"])]),t("div",At,[t("fieldset",{class:"paginated_object_list",style:oe({"--page-count":v.value,"--list-rows":v.value>1?ge:A.fields.length,"--scroll-position":`${g.value}`,"--container-width":`${c.value}px`})},[(s(!0),l(G,null,H(A.fields,(E,N)=>(s(),l("div",{key:N,class:"object_item pl-24"},[(s(!0),l(G,null,H(E.value,(F,M)=>(s(),l("div",{key:M},[k(we,{id:`${u.assetKey}.${N}.${M}`,value:E.value[M],label:x(M),"field-type":d.value,variant:"small",icon:"aws_infra_icons/objects.svg","hide-label":!0,"has-remove":!0,"asset-type":u.assetType,onHandleRemoveInstance:Q=>A.remove(N)},null,8,["id","value","label","field-type","asset-type","onHandleRemoveInstance"])]))),128))]))),128))],4)]),v.value>1?(s(),l("div",wt,[t("div",St,[t("button",{type:"button",disabled:e.value===1,class:"text-grey-200 hover:text-green-500 pointer",onClick:ae(i,["stop"])},[D[1]||(D[1]=t("span",{class:"sr-only"},"Prev",-1)),k(S,{icon:"chevron-left","aria-hidden":"true"})],8,$t),(s(!0),l(G,null,H(v.value,E=>(s(),l("button",{key:E,class:"w-[1.5rem] h-[1.5rem] border border-solid border-grey-300 rounded-full text-sm text-grey-400 hover:text-green-500 pointer",type:"button",onClick:ae(N=>e.value=E,["stop"])},[t("span",{class:V({"text-grey-700 font-semibold":e.value===E})},T(E),3)],8,xt))),128)),t("button",{type:"button",disabled:e.value===v.value,class:"text-grey-200 hover:text-green-500 pointer",onClick:ae(f,["stop"])},[D[2]||(D[2]=t("span",{class:"sr-only"},"Next",-1)),k(S,{icon:"chevron-right","aria-hidden":"true"})],8,kt)])])):C("",!0)],64)}}}),Ct=q({__name:"FormAsset",props:{assetType:{},assetData:{},validationSchema:{},triggerSubmit:{type:Boolean},triggerCancel:{type:Boolean},closeModal:{type:Function}},emits:["update-asset","invalid-submit"],setup($,{emit:u}){const e=$,c=u,o=h({}),n=h(null),v=h([]);ie(()=>{var f;v.value={...e.assetData},((f=n.value)==null?void 0:f.$el.getElementsByTagName("input")[0]).focus()});function d(i){c("update-asset",i),e.closeModal()}function g(i){c("invalid-submit",i)}function a(){n.value&&n.value.$el.requestSubmit()}function r(){c("update-asset",v)}function x(i){return I[i]}return se(()=>e.assetData,i=>{o.value={...i}},{immediate:!0}),se(()=>e.triggerSubmit,i=>{if(i===!0)return a()},{immediate:!0}),se(()=>e.triggerCancel,i=>{if(i===!0)return r()},{immediate:!0}),(i,f)=>(s(),U(b(Le),{ref_key:"formAssetRef",ref:n,"initial-values":o.value,"validation-schema":e.validationSchema,onSubmit:d,onInvalidSubmit:g},{default:B(()=>[(s(!0),l(G,null,H(o.value,(y,A)=>(s(),l("div",{key:A},[Array.isArray(y)?(s(),U(b(je),{key:0,name:"objects"},{default:B(({fields:D,prepend:m,remove:S})=>[k(Et,{"asset-type":e.assetType,"asset-key":A,"object-key":"object_path",fields:D,prepend:m,remove:S},null,8,["asset-type","asset-key","fields","prepend","remove"])]),_:2},1024)):(s(),U(we,{key:1,id:A,value:o.value[A],label:x(A),"field-type":A,"asset-type":e.assetType},null,8,["id","value","label","field-type","asset-type"]))]))),128))]),_:1},8,["initial-values","validation-schema"]))}}),Tt={class:"border bg-white rounded-2xl shadow-solid-shadow-grey border-grey-200 p-16 mx-24 my-16 2xl:mx-[8vw] xl:mx-[3vw]"},Mt=q({__name:"ModalAsset",props:{assetType:{},assetData:{},closeModal:{type:Function}},emits:["update-asset"],setup($,{emit:u}){const e=$,c=u,o=h(!1),n=h(!1);function v(x){c("update-asset",x)}function d(){o.value=!0}function g(){o.value=!1}function a(){n.value=!0,e.closeModal()}const r=O(()=>{switch(e.assetType){case L.S3BUCKET:return ot;case L.SQSQUEUE:return lt;case L.SSMPARAMETER:return rt;case L.SECRETMANAGERSECRET:return it;case L.DYNAMODBTABLE:return ut;default:return ct}});return(x,i)=>{const f=le,y=Ae;return s(),U(y,{title:`Edit ${e.assetType}`,"has-close-button":!0,class:"flex flex-row items-stretch",onKeydown:Pe(d,["enter"])},{footer:B(()=>[k(f,{variant:"grey",onClick:a},{default:B(()=>i[0]||(i[0]=[P("Cancel")])),_:1}),k(f,{variant:"primary",type:"submit",onClick:d},{default:B(()=>i[1]||(i[1]=[P("Save")])),_:1})]),default:B(()=>[t("div",Tt,[k(Ct,{"asset-type":e.assetType,"asset-data":e.assetData,"close-modal":e.closeModal,"validation-schema":r.value,"trigger-submit":o.value,"trigger-cancel":n.value,onUpdateAsset:v,onInvalidSubmit:g},null,8,["asset-type","asset-data","close-modal","validation-schema","trigger-submit","trigger-cancel"])])]),_:1},8,["title"])}}}),Bt={key:0},Dt={key:1},Rt={class:"flex flex-16 gap-16"},Nt={key:0},jt={key:1},Lt=q({__name:"ModalDeleteAsset",props:{assetType:{},isBulkDelete:{type:Boolean},closeModal:{type:Function},onDeleteConfirmed:{type:Function}},setup($){const u=$;function e(){u.closeModal(),u.onDeleteConfirmed()}return(c,o)=>{const n=le,v=Ae;return s(),U(v,{title:`Delete ${u.assetType?u.assetType:""}`,"has-close-button":!0},{footer:B(()=>[t("div",Rt,[k(n,{variant:"secondary",onClick:u.closeModal},{default:B(()=>[o[0]||(o[0]=P("No, keep ")),c.assetType?(s(),l("span",Nt,"it")):C("",!0),c.isBulkDelete?(s(),l("span",jt,"them")):C("",!0)]),_:1},8,["onClick"]),k(n,{variant:"danger",onClick:e},{default:B(()=>o[1]||(o[1]=[P("Delete")])),_:1})])]),default:B(()=>[o[2]||(o[2]=P(" Are you sure you want to delete ")),c.assetType?(s(),l("span",Bt,"this "+T(c.assetType)+"?",1)):C("",!0),c.isBulkDelete?(s(),l("span",Dt,"all selected assets?")):C("",!0)]),_:1},8,["title"])}}}),Pt={class:"sr-only"},Vt=q({__name:"ButtonAddAsset",props:{assetType:{}},emits:["add-asset"],setup($,{emit:u}){const e=u;return(c,o)=>{const n=J("font-awesome-icon");return s(),l("button",{class:"border group rounded-2xl top-[0px] border-grey-200 duration-100 ease-in-out hover:border-green-600 focus:border-green-600",onClick:o[0]||(o[0]=v=>e("add-asset"))},[k(n,{"aria-hidden":"true",icon:"plus",class:"group-hover:text-green-600 group-focus:text-green-600 text-grey-300"}),t("span",Pt,"Add New "+T(c.assetType),1)])}}}),It={class:"flex flex-row gap-16"},Ot={class:"flex flex-row items-center gap-16 h-[2rem]"},Gt=["alt"],Ft={class:"flex flex-row items-center gap-8 h-[1.5rem]"},Ut=["alt"],qt=q({__name:"SelectAddAsset",props:{isTypeMissingPermission:{}},emits:["selectOption"],setup($,{emit:u}){const e=$,c=u,o={label:"Choose asset",value:""},n=h(o),v=O(()=>Object.values(L).map(a=>e.isTypeMissingPermission.includes(a)?null:{label:I[a],value:a}).filter(a=>a!==null));function d(){n.value=o}function g(a){c("selectOption",a)}return(a,r)=>{const x=J("font-awesome-icon"),i=J("v-select");return s(),l("div",It,[r[2]||(r[2]=t("label",{for:"Add-new-instance",class:"mt-8 ml-4 font-semibold"},"Add ",-1)),k(i,{id:"Add-new-instance",modelValue:n.value,"onUpdate:modelValue":r[0]||(r[0]=f=>n.value=f),class:"v-select min-w-[20rem]",options:v.value,searchable:!1,onOpen:d,onInput:g,"onOption:selected":r[1]||(r[1]=f=>g(f.value))},{"open-indicator":B(({attributes:f})=>[t("span",Ve(Ie(f)),[k(x,{icon:"chevron-up",class:"w-6 h-6 hover:text-grey-400"})],16)]),option:B(({label:f,value:y})=>[t("div",Ot,[y?(s(),l("div",{key:0,alt:`icon-${y}-`,style:oe({backgroundImage:`url(${b(Z)(`aws_infra_icons/${y}.svg`)})`}),class:"bg-cover w-[2rem] h-[2rem] duration-100 rounded-full"},null,12,Gt)):C("",!0),P(" "+T(f),1)])]),"selected-option":B(({label:f,value:y})=>[t("div",Ft,[y?(s(),l("div",{key:0,alt:`icon-${y}`,style:oe({backgroundImage:`url(${b(Z)(`aws_infra_icons/${y}.svg`)})`}),class:"bg-cover w-[1.5rem] h-[1.5rem] duration-100 rounded-full"},null,12,Ut)):C("",!0),P(" "+T(f),1)])]),_:1},8,["modelValue","options"])])}}});function Qt($){const u=h([]),e=h(!1),c=O(()=>{let d=0;return u.value.forEach(g=>{const a=Object.values(g)[0];Array.isArray(a)&&(d+=a.length)}),d});function o(){e.value=!1,u.value=Object.keys($.value).map(d=>({[d]:[]}))}function n(d,g,a){const r=u.value.find(x=>g in x);r&&Array.isArray(r[g])&&(d&&!r[g].includes(a)&&(e.value=!0,r[g].push(a)),d||(r[g]=r[g].filter(x=>x!==a)))}function v(){const d={...$.value};u.value.forEach(g=>{const a=Object.keys(g)[0],r=g[a],x=[...r].sort((i,f)=>f-i);d[a]&&Array.isArray(r)&&x.forEach(i=>{var f,y;i>=0&&i<(((f=d[a])==null?void 0:f.length)??0)&&((y=d[a])==null||y.splice(i,1))})}),$.value=d,o()}return{isActiveSelected:e,numberSelectedAssets:c,handleRemoveAllSelected:v,handleSelectAsset:n,resetSelectedAssetObj:o}}const Wt={class:"flex items-stretch flex-col px-24"},Ht={class:"flex justify-between mb-24"},zt={class:"flex items-center gap-8 text-grey-500"},Yt={class:"min-h-[3rem] flex items-center"},Xt={key:0,class:"flex flex-col items-center justify-between w-full gap-24 md:flex-row"},Jt={class:"flex flex-row flex-wrap gap-8 list-none justify-left"},Zt={key:1,class:"bg-grey-100 rounded-xl px-24 py-8 flex flex-row w-fit gap-8"},Kt=["id"],es={class:"mb-16 mt-40 uppercase"},ts={key:0},ss={class:"flex flex-col items-center mt-32"},rs=q({__name:"GeneratePlan",props:{initialStepData:{}},emits:["updateStep","storeCurrentStepData"],setup($,{emit:u}){const e=u,c=$,{token:o,auth_token:n,proposed_plan:v}=c.initialStepData,d=h("gridView"),g=h(!0),a=h(""),r=h(!1),x=h(!1),i=h(""),f=h(!1),y=h({S3Bucket:[],SQSQueue:[],SSMParameter:[],SecretsManagerSecret:[],DynamoDBTable:[]}),A=h(""),D=h("loading"),{isActiveSelected:m,numberSelectedAssets:S,handleRemoveAllSelected:E,handleSelectAsset:N,resetSelectedAssetObj:F}=Qt(y);ie(()=>{y.value=v.assets,F()});const M=O(()=>Object.entries(y.value).filter(([,w])=>w===null).map(([w])=>w));function Q(w){const{off_inventory:p,...j}=w;return j}function ce(w){d.value=w}function Se(w){A.value=w}function $e(w){return A.value===w||A.value===""}function de(w,p,j,W){const{open:R,close:_}=fe({component:Lt,attrs:{assetType:w,isBulkDelete:W,closeModal:()=>{_()},onDeleteConfirmed:()=>{W?E():p.splice(j,1)}}});R()}function xe(w,p,j){const{open:W,close:R}=fe({component:Mt,attrs:{assetType:p,assetData:Q(w),closeModal:()=>{R()},"onUpdate-asset":_=>{D.value="none",me(_,p,j)}}});W()}async function pe(w){D.value="list";const p=()=>{switch(w){case L.S3BUCKET:return te[L.S3BUCKET];case L.SQSQUEUE:return te[L.SQSQUEUE];case L.SSMPARAMETER:return te[L.SSMPARAMETER];case L.SECRETMANAGERSECRET:return te[L.SECRETMANAGERSECRET];case L.DYNAMODBTABLE:return te[L.DYNAMODBTABLE];default:return{}}},j={...p()};async function W(){g.value=!0;try{(await Promise.all(Object.keys(p()).map(async _=>{if(Array.isArray(j[_]))return null;if(_==="off_inventory")return{key:_,value:!1};const{handleGenerateName:Y,isGenerateNameError:K,isGenerateNameLoading:ee,generatedName:Ce}=ue(w,_);return g.value=ee.value,await Y(),a.value=K.value,{key:_,value:Ce.value}}))).forEach(_=>{_&&(j[_.key]=_.value)})}catch(R){a.value=R.message||"An error occurred"}finally{g.value=!1}}await W(),me(j,w,-1),location.href=`#section-${w}`}function me(w,p,j){y.value[p]||(y.value[p]=[]),j===-1?y.value[p].push(w):(y.value[p][j]=w,setTimeout(()=>{"list"},0))}g.value=!1;async function ke(w){r.value=!0,x.value=!1,i.value="",f.value=!1;try{const p=await Ue(o,n,w);p.status!==200&&(r.value=!1,x.value=!0,i.value=p.data.message),f.value=!0,e("storeCurrentStepData",{token:o,auth_token:n}),e("updateStep")}catch(p){x.value=!0,i.value=p.message||"We couldn`t save the plan. Please, try again",f.value=!1}finally{r.value=!1}}async function Ee(w){await ke(w)}return(w,p)=>{const j=Ge,W=le;return s(),l(G,null,[p[9]||(p[9]=t("div",{class:"infra-token__title-wrapper"},[t("h2",null,"Proposed Plan")],-1)),t("div",Wt,[t("div",null,[t("div",Ht,[t("div",null,[k(qt,{"is-type-missing-permission":M.value,onSelectOption:p[0]||(p[0]=R=>pe(R))},null,8,["is-type-missing-permission"])]),t("div",zt,[p[7]||(p[7]=P(" View: ")),t("button",{type:"button",class:V({"text-green-500":d.value==="listView"}),onClick:p[1]||(p[1]=R=>ce("listView"))}," List ",2),p[8]||(p[8]=P(" | ")),t("button",{type:"button",class:V({"text-green-500":d.value==="gridView"}),onClick:p[2]||(p[2]=R=>ce("gridView"))}," Grid ",2)])]),t("div",Yt,[b(S)?C("",!0):(s(),l("div",Xt,[t("ul",Jt,[k(ve,{id:"filterAll",category:"All","category-type":"Assets",selected:!A.value,"high-contrast":!0,onClick:p[3]||(p[3]=R=>A.value="")},null,8,["selected"]),(s(!0),l(G,null,H(y.value,(R,_)=>(s(),l("li",{key:_},[k(ve,{category:b(I)[_],"category-type":"Assets","high-contrast":!0,selected:A.value===_,onClick:Y=>Se(_)},null,8,["category","selected","onClick"])]))),128))])])),b(S)?(s(),l("div",Zt,[t("span",null,T(b(S))+" assets selected: ",1),t("button",{type:"button",class:"font-semibold hover:text-red",onClick:p[4]||(p[4]=R=>de(null,null,0,!0))}," Delete Selected "),t("button",{type:"button",class:"ml-8 font-semibold hover:text-green-500",onClick:p[5]||(p[5]=(...R)=>b(F)&&b(F)(...R))}," Unselect All ")])):C("",!0)]),a.value?(s(),U(j,{key:0,variant:"danger"},{default:B(()=>[P(T(a.value),1)]),_:1})):C("",!0),(s(!0),l(G,null,H(y.value,(R,_)=>(s(),l(G,{key:_},[$e(_)?(s(),l("section",{key:0,id:`section-${_}`,class:"asset-section"},[t("h1",es,T(b(I)[_]),1),M.value.includes(_)?(s(),l("div",ts,[k(j,{variant:"warning"},{default:B(()=>[P("We couldn't inventory your "+T(b(I)[_])+". Please check the permissions and run the inventory again.",1)]),_:2},1024)])):(s(),l("div",{key:1,class:V([{"grid grid-col-1 gap-8 auto-rows-fr":d.value==="listView"},{"grid gap-8 grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 auto-rows-fr":d.value==="gridView"}])},[k(Oe,{name:D.value},{default:B(()=>[(s(!0),l(G,null,H(R,(Y,K)=>(s(),U(nt,{key:`${_}-${Object.values(Y)[0]}`,"asset-type":_,"view-type":d.value,"asset-data":Y,"is-active-selected":b(m),onOpenAsset:ee=>xe(Y,_,K),onSelectAsset:ee=>b(N)(ee,_,K),onDeleteAsset:ee=>de(_,y.value[_],K,!1)},null,8,["asset-type","view-type","asset-data","is-active-selected","onOpenAsset","onSelectAsset","onDeleteAsset"]))),128))]),_:2},1032,["name"]),k(Vt,{"asset-type":_,onAddAsset:Y=>pe(_)},null,8,["asset-type","onAddAsset"])],2))],8,Kt)):C("",!0)],64))),128))]),t("div",ss,[k(W,{loading:r.value,onClick:p[6]||(p[6]=R=>Ee(b(v)))},{default:B(()=>[P(T(r.value?"Saving the plan...":"Save Plan"),1)]),_:1},8,["loading"]),x.value?(s(),U(j,{key:0,variant:"danger"},{default:B(()=>[P(T(i.value),1)]),_:1})):C("",!0)])])],64)}}});export{rs as default};
