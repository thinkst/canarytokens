import{d as x,r as o,au as B,av as W,ay as C,o as D,e as f,f as v,w as n,k as l,i as s,l as m,aw as M,v as _,M as E,j as $,C as q,D as F,E as N}from"./index-BDTIPFyt.js";import{_ as V}from"./BaseFormSelect.vue_vue_type_style_index_0_lang-Vb8MDKd0.js";import{_ as I}from"./BaseFormTextField.vue_vue_type_style_index_0_lang-BAEYHnTD.js";import{A as g}from"./constants-DJ0HIoY4.js";import{e as R}from"./awsInfra-DuYOQ03w.js";import"./BaseLabel.vue_vue_type_script_setup_true_lang-DVt1QwvA.js";const j={class:"lg:basis-6/12"},T={class:"flex flex col justify-center gap-8 mt-24"},K=x({__name:"ModalEditAWSInfo",props:{initialStepData:{},closeModal:{type:Function},saveData:{type:Function}},setup(S){const t=S,i=o([]),r=o(""),c=o(!1),u=o(!1),d=o(""),b=B().shape({aws_region:W().required("AWS region is required"),aws_account_number:C().typeError("AWS account must be a number").required("AWS account number is required").test("len","AWS account number must have 12 digits",a=>a.toString().length===12)});D(()=>{i.value=g.filter(a=>a.value===t.initialStepData.aws_region),r.value=t.initialStepData.aws_account_number});async function h(a){c.value=!0,console.log("values",a);try{const e=await R(t.initialStepData.token,t.initialStepData.auth_token,r.value,i.value[0].value);t.saveData(a),t.closeModal(),e.status!==200&&(u.value=!0,d.value=e.data.message||"Could not edit token!")}catch(e){u.value=!0,d.value=e||"Could not edit token!"}finally{c.value=!1}}return(a,e)=>{const y=I,A=V,w=q,p=F,k=N;return f(),v(k,{title:"Edit account informations","has-close-button":!0,"hide-footer":!0,"content-class":"items-stretch"},{default:n(()=>[l("div",null,[s(m(M),{class:"flex flex-col","validation-schema":m(b),onSubmit:h},{default:n(()=>[l("div",j,[s(y,{id:"aws_account_number",type:"text",placeholder:"e.g. 012345678901",label:"AWS account number","full-width":"",required:"",value:r.value},null,8,["value"]),l("div",null,[s(A,{id:"aws_region",label:"AWS Region",options:m(g),placeholder:"Select AWS region",required:"",searchable:"",value:i.value[0]},null,8,["options","value"])])]),u.value?(f(),v(w,{key:0,variant:"danger"},{default:n(()=>[_(E(d.value),1)]),_:1})):$("",!0),l("div",T,[s(p,{variant:"grey",onClick:a.closeModal},{default:n(()=>e[0]||(e[0]=[_("Cancel")])),_:1},8,["onClick"]),s(p,{variant:"primary",type:"submit",loading:c.value},{default:n(()=>e[1]||(e[1]=[_("Save")])),_:1},8,["loading"])])]),_:1},8,["validation-schema"])])]),_:1})}}});export{K as default};
