const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ModalInfoSnippet-JJFtPUJ8.js","assets/index-DMASL9eO.js","assets/index-CUHUoo6I.css","assets/BaseBulletList.vue_vue_type_script_setup_true_lang-CYiyfudI.js","assets/BaseBulletListItem-Bkan3weV.js","assets/BaseBulletListItem-CohxRw82.css"])))=>i.map(i=>d[i]);
import{d as D,r as c,K as R,aF as F,aG as L,I as P,ad as V,e as n,f as u,w as s,k as r,i as o,l as _,aO as O,v as f,h as d,O as v,ab as q,j as T,F as W,an as j,D as G,P as z,aE as K,E as Z,b as H,c as J}from"./index-DMASL9eO.js";import{_ as Q}from"./BaseCodeSnippet.vue_vue_type_script_setup_true_lang-BAjR7rjw.js";import{p as U}from"./constants-leaU8Fgz.js";import"./BaseCopyButton-Big_n0PG.js";const X={class:"place-self-center w-full"},Y={class:"text-right"},ee={class:"text-center flex mt-24 gap-8 items-center justify-center"},se=D({__name:"ModalSetupRolePolicySnippet",props:{closeModal:{type:Function},roleName:{},externalId:{},managementAwsAccount:{},accountNumber:{}},emits:["updateExternalId"],setup(w,{emit:h}){const x=H(()=>J(()=>import("./ModalInfoSnippet-JJFtPUJ8.js"),__vite__mapDeps([0,1,2,3,4,5]))),a=w,y=h,l=c(""),p=c(!1),i=c(!1),g={external_id:a.externalId||""},b=R(()=>{const t=a.externalId||l.value;return`aws iam create-role --no-cli-pager --role-name ${a.roleName} --assume-role-policy-document '{"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Principal": {"AWS": "arn:aws:sts::${a.managementAwsAccount}:assumed-role/InventoryManagerRole/${t}"}, "Action": "sts:AssumeRole", "Condition": {"StringEquals": {"sts:ExternalId": "${t}"}}}]}'

aws iam create-policy --no-cli-pager --policy-name Canarytokens-Inventory-ReadOnly-Policy --policy-document '${U}'

aws iam attach-role-policy --role-name ${a.roleName} --policy-arn arn:aws:iam::${a.accountNumber}:policy/Canarytokens-Inventory-ReadOnly-Policy
`}),C=F().shape({external_id:L().required("The external ID is required")});function I(t){l.value=t.external_id,l.value&&(p.value=!0,i.value=!0,y("updateExternalId",l.value),setTimeout(()=>{i.value=!1},2e3))}function S(){const{open:t,close:e}=W({component:x,attrs:{closeModal:()=>e()}});t()}return(t,e)=>{const A=j,m=G,k=z,E=K,$=Q,B=P("font-awesome-icon"),M=Z,N=V("tooltip");return n(),u(M,{title:"Restore Canarytoken IAM role and policy","has-close-button":!0,"content-class":"items-stretch"},{default:s(()=>[r("div",X,[o(_(O),{class:"flex flex-col justify-center items-center mb-24","validation-schema":_(C),"initial-values":g,onSubmit:I},{default:s(()=>[o(A,{id:"external_id",name:"external_id",label:"Add here your External ID",placeholder:"e.g. abCd7Lb6cEZrMCEm3OAoj",required:"","has-arrow":!0,"arrow-variant":"one","arrow-word-position":2,class:"flex-grow min-w-[300px]"}),o(m,{type:"submit"},{default:s(()=>e[0]||(e[0]=[f("Generate Snippet")])),_:1})]),_:1},8,["validation-schema"]),p.value?(n(),d(v,{key:0},[i.value?(n(),u(k,{key:0,class:"mt-24 h-[10svh] w-full"})):(n(),d(v,{key:1},[e[1]||(e[1]=r("h2",{class:"mb-24 mt-16 text-center"}," Run the AWS CLI command below ",-1)),r("div",Y,[o(E,{id:"aws-snippet",label:"Copy AWS CLI snippet","arrow-word-position":"last","arrow-variant":"two",class:"z-10"})]),o($,{id:"aws-snippet",lang:"bash",code:b.value,"custom-height":"120px",class:"wrap-code max-w-[100%]"},null,8,["code"])],64)),r("div",ee,[e[2]||(e[2]=r("p",null,"What's this snippet doing?",-1)),q((n(),d("button",{class:"w-24 h-24 text-sm duration-150 bg-transparent border border-solid rounded-full hover:text-white hover:bg-green-600 hover:border-green-300","aria-label":"What's this snippet doing?",onClick:S},[o(B,{icon:"question","aria-hidden":"true"})])),[[N,{content:"Check details",triggers:["hover"]}]])])],64)):T("",!0)])]),footer:s(()=>[o(m,{variant:"secondary",onClick:t.closeModal},{default:s(()=>e[3]||(e[3]=[f("Done")])),_:1},8,["onClick"])]),_:1})}}});export{se as default};
