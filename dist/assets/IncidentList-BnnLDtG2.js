import{d as D,r as S,o as te,K as O,e as o,h as r,k as i,i as x,w as $,ah as se,ai as ne,ag as E,l as A,m as P,j as C,v as I,M as w,I as V,O as T,V as U,$ as oe,W as ae,q as ie,H as q,az as M,D as le,f as F,X as Y}from"./index-DatEjxfX.js";import{g as j}from"./assetService-DkjO-ceG.js";import{a as re}from"./constants-leaU8Fgz.js";import{C as ce}from"./HistoryView-DO3pP428.js";import"./BannerDeviceCanarytools-BVjkzbPH.js";const de={class:"flex flex-row items-center gap-16 h-[2rem]"},ue=["alt"],pe={class:"flex flex-row items-center gap-8 h-[1.5rem]"},me=["alt"],_e=D({__name:"SelectIncidentType",props:{alertsList:{}},emits:["selectOption"],setup(L,{emit:k}){const b=L,g=k,c={label:"Choose asset",value:""},m={label:"All alerting decoys",value:"all_decoys"},l=S(c);te(()=>{l.value=v.value[0],g("selectOption",l.value.value)});function y(){const d=[];return b.alertsList.forEach(u=>{const a=u.additional_info.decoy_resource.asset_type;a&&!d.includes(a)&&d.push(a)}),Array.from(d)}const v=O(()=>{const d=y(),u=Object.values(re).filter(a=>d.includes(a)).map(a=>({label:j(a)||a,value:a}));return[m,...u]});function h(d){g("selectOption",d)}return(d,u)=>{const a=V("font-awesome-icon"),N=V("v-select");return o(),r("section",null,[u[2]||(u[2]=i("label",{for:"select_instance_type"},"Instance type:",-1)),x(N,{id:"select_instance_type",modelValue:l.value,"onUpdate:modelValue":u[0]||(u[0]=p=>l.value=p),class:"v-select mt-8",options:v.value,searchable:!1,onInput:h,"onOption:selected":u[1]||(u[1]=p=>h(p.value))},{"open-indicator":$(({attributes:p})=>[i("span",se(ne(p)),[x(a,{icon:"chevron-up",class:"w-6 h-6 hover:text-grey-400"})],16)]),option:$(({label:p,value:_})=>[i("div",de,[_?(o(),r("div",{key:0,alt:`icon-${_}`,style:E({backgroundImage:`url(${A(P)(`aws_infra_icons/${_}.svg`)})`}),class:"bg-cover w-[2rem] h-[2rem] duration-100 rounded-full"},null,12,ue)):C("",!0),I(" "+w(p),1)])]),"selected-option":$(({label:p,value:_})=>[i("div",pe,[_?(o(),r("div",{key:0,alt:`icon-${_}`,style:E({backgroundImage:`url(${A(P)(`aws_infra_icons/${_}.svg`)})`}),class:"bg-cover w-[1.5rem] h-[1.5rem] duration-100 rounded-full"},null,12,me)):C("",!0),I(" "+w(p),1)])]),_:1},8,["modelValue","options"])])}}}),fe={class:"w-full @container"},ye={class:"flex flex-row items-center flex-1 gap-16"},ve=["alt"],ge={class:"text-left break-all"},he={key:0,class:"capitalize text-grey-400"},we={key:1,class:"mr-8 font-semibold"},ke={class:"flex flex-row items-center justify-end gap-8 mt-8 font-semibold text-red sm:hidden"},be=D({__name:"IncidentCardAsset",props:{lastKey:{type:Boolean},assetPreviewInfo:{},assetType:{}},emits:["click"],setup(L,{emit:k}){const b=k;function g(){b("click")}return(c,m)=>{const l=V("font-awesome-icon");return o(),r("li",fe,[i("button",ae(c.$attrs,{class:["relative w-full px-16 py-8 transition duration-100 bg-white border text-grey-700 grouped group rounded-2xl shadow-solid-shadow-grey border-grey-200 error-card",{"mb-8":c.lastKey}],onClick:ie(g,["stop"])}),[i("span",ye,[i("div",{alt:`icon-${c.assetType}`,style:E({backgroundImage:`url(${A(P)(`aws_infra_icons/${c.assetType}.svg`)})`}),class:"bg-cover w-[2rem] h-[2rem] duration-100 rounded-full hidden @xs:block min-w-[2rem]"},null,12,ve),i("span",ge,[(o(!0),r(T,null,U(c.assetPreviewInfo,(y,v)=>(o(),r("span",{key:v,class:"block"},[y!==null?(o(),r("span",he,w(A(oe)(v))+": ",1)):C("",!0),y!==null?(o(),r("span",we,w(y),1)):C("",!0)]))),128))])]),i("span",ke,[m[0]||(m[0]=I("Check Incidents ")),x(l,{icon:"arrow-right",class:"text-red","aria-hidden":"true"})])],16)])}}}),xe=q(be,[["__scopeId","data-v-b27d10fe"]]),Ae={key:0,ref:"asset-section"},Ie={class:"p-8"},Le={class:"flex flex-col h-full gap-16 pb-16"},$e={key:1,ref:"incidents-section"},Te={class:"p-8 text-ellipsis overflow-hidden whitespace-nowrap"},Ce={class:"flex flex-col h-full gap-16 pb-16"},G="all_decoys",Ne=D({__name:"IncidentList",props:{hitsList:{}},emits:["select-alert"],setup(L,{emit:k}){const b=L,g=k,c=b.hitsList,m=S(G),l=S(""),y=M("asset-section"),v=M("incidents-section"),h=e=>{var t;return(t=e.additional_info.decoy_resource)==null?void 0:t["Asset Name"]},d=e=>{var t;return((t=e.additional_info.decoy_resource)==null?void 0:t.asset_type)||"Unknown"},u=O(()=>j(m.value)||"All alerting decoys"),a=O(()=>{const e=N(),t=_(e);return H(t)});function N(){return m.value===G?c:c.filter(e=>d(e)===m.value)}function p(){return c.filter(e=>h(e)===l.value)}function _(e){return e.reduce((t,n)=>{const s=h(n);return s&&(t[s]=t[s]||[],t[s].push(n)),t},{})}function H(e){return Object.fromEntries(Object.entries(e).map(([t,n])=>[t,n.sort((s,f)=>f.time_of_hit-s.time_of_hit)]).sort(([t,n],[s,f])=>{var z,K;const B=((z=n[0])==null?void 0:z.time_of_hit)||0;return(((K=f[0])==null?void 0:K.time_of_hit)||0)-B}))}function W(e){const t=h(e)||"",n=d(e)||"Unknown";return{asset_type:n&&j(n)||n,asset_name:t,last_date_of_hit:e.time_of_hit?Y(e.time_of_hit):null}}function X(e){var n,s;const t=(s=(n=e.additional_info)==null?void 0:n.event)==null?void 0:s["Event Name"];return{Date:Y(e.time_of_hit),IP:e.src_ip,"Event Name":t||"Unknown"}}const J=e=>{l.value="",m.value=e};function Q(e){var n,s;const t=(s=(n=e.additional_info)==null?void 0:n.decoy_resource)==null?void 0:s["Asset Name"];R("assetSection",()=>{l.value=t||""})}function Z(e){g("select-alert",e)}function ee(){R("",()=>{l.value=""})}function R(e,t){var n,s;e==="assetSection"?(n=y.value)==null||n.classList.add("exit-right"):(s=v.value)==null||s.classList.add("exit-left"),setTimeout(()=>{t()},250)}return(e,t)=>{const n=le;return o(),r(T,null,[x(_e,{"alerts-list":A(c),onSelectOption:t[0]||(t[0]=s=>J(s))},null,8,["alerts-list"]),l.value?(o(),r("section",$e,[x(n,{type:"button",variant:"text",icon:"angle-left",onClick:ee},{default:$(()=>t[1]||(t[1]=[I("Back")])),_:1}),i("h3",Te,[t[2]||(t[2]=i("span",{class:"text-grey"},"Alerts for:",-1)),I(" "+w(l.value),1)]),i("ul",Ce,[(o(!0),r(T,null,U(p(),(s,f)=>(o(),F(ce,{key:f,"last-key":f===p().length-1,"incident-id":s.time_of_hit,"incident-preview-info":X(s),onClick:B=>Z(s)},null,8,["last-key","incident-id","incident-preview-info","onClick"]))),128))])],512)):(o(),r("section",Ae,[i("h3",Ie,w(u.value)+" alerts list",1),i("ul",Le,[(o(!0),r(T,null,U(a.value,(s,f)=>(o(),F(xe,{key:s[0].time_of_hit,"last-key":f===Object.values(a.value).length-1,"asset-preview-info":W(s[0]),"asset-type":d(s[0]),onClick:B=>Q(s[0])},null,8,["last-key","asset-preview-info","asset-type","onClick"]))),128))])],512))],64)}}}),Ue=q(Ne,[["__scopeId","data-v-2131c23c"]]);export{Ue as default};
