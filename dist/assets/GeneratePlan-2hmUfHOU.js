import{r as b,d as B,K as A,ad as fe,e as a,h as v,ab as oe,y as P,q as se,k as c,l as w,m as ie,i as Z,M as T,P as qe,H as De,ar as Ee,aF as Xe,aG as Ge,g as He,I as pe,v as V,j as k,O as z,V as O,f as q,aB as ne,aH as Ue,aC as be,an as Ke,ao as Oe,L as te,w as U,p as Le,o as ge,ag as Qe,J as We,D as ye,C as we,az as et,aD as tt,aI as at,aE as je,E as st,F as ot}from"./index-BYcYhT0r.js";import{c as nt,g as rt,s as lt}from"./awsInfra-Dc8hB21S.js";import{h as Ve,a as de,g as Ye,b as X,c as ke,d as it}from"./assetService-DkjO-ceG.js";import{a as R}from"./constants-leaU8Fgz.js";import{_ as dt}from"./BaseLabel.vue_vue_type_script_setup_true_lang-w2ddoDUg.js";import{e as Ie}from"./StepState.vue_vue_type_script_setup_true_lang-DHQ7TGgA.js";function ut(r){return{assets:Object.fromEntries(Object.entries(r).filter(([e])=>Ve(e).length>0).map(([e,t])=>{if(!t)return[e,[]];const n=de(e),i=t.map(m=>{const f=m[n];return String(f)||""});return[e,i]}))}}function ct(r,o){const e=Object.fromEntries(Object.entries(o).map(([t,n])=>{const i=t,m=Ve(i),f=de(i),l=(r[i]||[]).map(d=>{const x=String(d[f]),s=n[x];return s?{...d,[m]:s}:d});return[i,l]}));return{...r,...e}}function mt(r,o,e,t,n,i){const m=b(""),f=b(0);function _(d){let x=0;Object.values(d).forEach(s=>{s&&(x+=s.length)}),f.value=x}async function l(d){var u,h;const x=ut(d);let s={};m.value="",Object.keys(x.assets).forEach(g=>{i.value[g]=!0});try{const g=await nt({canarytoken:r,auth_token:o,assets:x.assets});if(g.status===429){m.value="You have reached your limit for AI-generated decoy names. You can continue with manual setup.";const Y=Math.floor(g.data.data_generation_remaining);t(Y);return}if(g.status!==200){m.value=((u=g.data)==null?void 0:u.message)||"We encountered an issue while generating AI assets. You can continue setting up your decoys manually.";return}const D=g.data.assets,j=Math.floor(g.data.data_generation_remaining);t(j),Object.keys(D).length>0&&(s=ct(e.value,D)),e.value={...e.value,...s},_(e.value)}catch(g){m.value=((h=g.data)==null?void 0:h.message)||"We encountered an issue while generating AI assets. You can continue setting up your decoys manually."}finally{n()}}return{isAiGenerateErrorMessage:m,fetchAIgeneratedAssets:l,aiGeneratedAssetsCount:f}}const ft={class:"asset_category_card__wrapper"},pt=["aria-label"],vt={class:"asset_category_card__content"},_t=["src","alt"],bt={key:1},gt={class:"text-grey-600 text-pretty mt-8"},yt={class:"asset_category_card__list-data"},wt={class:"text-sm"},xt={class:"value"},ht={class:"asset_category_card__btn-edit"},jt=B({__name:"AssetCategoryCard",props:{assetType:{},assetData:{},isLoadingData:{type:Boolean}},emits:["openAsset","deleteAsset","selectAsset"],setup(r,{emit:o}){const e=o,t=r,n=b(),i=A(()=>t.isLoadingData),m=A(()=>Ye(t.assetType)),f=A(()=>t.assetData?Object.keys(t.assetData).length:0);function _(){i.value||e("openAsset")}return(l,d)=>{var u,h;const x=qe,s=fe("tooltip");return a(),v("li",ft,[oe((a(),v("button",{ref_key:"assetCardRef",ref:n,class:P(["asset_category_card group",{loading:i.value}]),"aria-label":`Open ${m.value} assets`,onClick:se(_,["stop"])},[c("div",vt,[i.value?(a(),v("span",bt,[Z(x,{class:"w-[5rem] h-[5rem] rounded-full",loading:i.value},null,8,["loading"])])):(a(),v("img",{key:0,src:w(ie)(`aws_infra_icons/${t.assetType}.svg`),alt:`logo-${l.assetType}`,class:P(["rounded-full w-[5rem] h-[5rem]",(u=l.assetData)!=null&&u.length?"":"grayscale opacity-50"])},null,10,_t)),c("p",gt,T(m.value),1)]),c("ul",yt,[c("li",wt,[d[0]||(d[0]=c("span",{class:"label text-grey-400"},"Totaly decoys:",-1)),c("span",xt,T(f.value),1)])]),c("div",ht,T((h=l.assetData)!=null&&h.length?"Review":"Add Decoys"),1)],10,pt)),[[s,{content:i.value?"Generating decoys...":"",triggers:["hover"]}]])])}}}),kt=De(jt,[["__scopeId","data-v-34b45c6f"]]);function St(){const r=Ee(20);return new Promise(o=>{setTimeout(()=>{o({result:"true",message:"",proposed_data:r})},200)})}b({S3Bucket:[{bucket_name:"dr-replication-storage-frpyccscczqipaq0oo1q",objects:["db_backups/prod_core_db/daily/2023/10/26/core-db-full-2023-10-26-0200.bak.gz","user_profiles_replication/sync_batch_20231026_001.parquet"],off_inventory:!1},{bucket_name:"ci-cd-build-artifacts-8avrmhvf026it098iog",objects:["db_backups/prod_auth_db/weekly/2023/auth-db-incr-2023-10-23-0100.sql.zip","replication_logs/aws_backup_service/daily_report_20231026.log.gz"],off_inventory:!1},{bucket_name:"ci-cd-build-artifacts-8avrmhvf026it098iog",objects:["web-app/prod/release-candidate-4/dist.zip","secrets/database-creds/main-production-db-202311.json.gpg"],off_inventory:!1}],SQSQueue:[{sqs_queue_name:"FinancialAuditLogs",off_inventory:!1},{sqs_queue_name:"FinancialReportingQueue",off_inventory:!1}],SSMParameter:[{ssm_parameter_name:"tableau-access-password",off_inventory:!1},{ssm_parameter_name:"api_key_private",off_inventory:!1}],SecretsManagerSecret:[{secret_name:"hr-payroll-system-token",off_inventory:!1},{secret_name:"legacy-app/crm-system/aws-role-key",off_inventory:!1}],DynamoDBTable:[{table_name:"ServiceAccountSecrets",off_inventory:!1,table_items:["AuditLogEntries","UserCredentialsTable","SSLCertificateMetadata"]}]});b({S3Bucket:[{bucket_name:"stagingcustomersab5rcqvgz",objects:["2016/9y6MmQsbxg/object","2012/4guCu7i4kU/object","2017/tIJXkV2zU9/text","2022/w1hWemKszJ/passwords","2016/YqkZZMKvCr/passwords","2003/9hfbHNqxlC/object","2005/kTwM5c8lx2/text","2011/OJVkCTiYNi/passwords","2009/uXTk29uqsj/object","2004/XLjRDbnTdQ/object","2005/6QgmMfrhTg/passwords","2014/sZRd7XM6PP/data","2016/YjTSGWepfy/text","2025/xhBYSpjPAV/passwords","2001/nr0Edh7dQl/data","2010/W1icZkS0OT/data","2023/EJhGkRAgFv/text","2022/tn895QcVLj/passwords","2008/IZCrFDN6kG/data","2012/kUv9Ehw37Q/passwords","2013/RQyAS9zeoS/data","2020/YU3i9Iu1HN/data","2022/JS2gwoPujj/object","2007/EnBveP5AFa/data","2005/ZGiyyorje0/data","2009/YGuvE5RRTA/data","2003/DqsG2jzJFj/data","2006/QMoVCuMStr/passwords","2004/gYOfMNJxJk/text","2004/GunT2jyMiV/passwords","2004/H67vC0whFx/object","2002/UwiCJe06XX/text","2016/ZgaVv6dIdw/text","2016/adf7FMk05j/data","2018/hmDqgqWf5S/object","2018/4iSdEKEvXc/text","2015/QdmswqFYI0/object","2019/M8YofqbETv/passwords","2021/LiRdw8Ahb5/data","2024/cDzCawt0aJ/passwords","2001/l8k6MUUxpD/data","2018/nbYktHECji/text","2013/wx8VyjuM8U/object","2011/Pw93HVUKfx/object","2006/7wUUpNuTDs/text","2004/yB7TXeqOga/object","2025/ZuSs8HbgVe/text","2003/mlkZmcCM0E/data"],off_inventory:!1},{bucket_name:"testinguseryq78uglinf",objects:["2016/9y6MmQsbxg/object","2012/4guCu7i4kU/object","2017/tIJXkV2zU9/text","2022/w1hWemKszJ/passwords","2016/YqkZZMKvCr/passwords","2003/9hfbHNqxlC/object","2005/kTwM5c8lx2/text","2011/OJVkCTiYNi/passwords","2009/uXTk29uqsj/object","2004/XLjRDbnTdQ/object","2005/6QgmMfrhTg/passwords","2014/sZRd7XM6PP/data","2016/YjTSGWepfy/text","2025/xhBYSpjPAV/passwords","2001/nr0Edh7dQl/data","2010/W1icZkS0OT/data","2023/EJhGkRAgFv/text","2022/tn895QcVLj/passwords","2008/IZCrFDN6kG/data","2012/kUv9Ehw37Q/passwords","2013/RQyAS9zeoS/data","2020/YU3i9Iu1HN/data","2022/JS2gwoPujj/object","2007/EnBveP5AFa/data","2005/ZGiyyorje0/data","2009/YGuvE5RRTA/data","2003/DqsG2jzJFj/data","2006/QMoVCuMStr/passwords","2004/gYOfMNJxJk/text","2004/GunT2jyMiV/passwords","2004/H67vC0whFx/object","2002/UwiCJe06XX/text","2016/ZgaVv6dIdw/text","2016/adf7FMk05j/data","2018/hmDqgqWf5S/object","2018/4iSdEKEvXc/text","2015/QdmswqFYI0/object","2019/M8YofqbETv/passwords","2021/LiRdw8Ahb5/data","2024/cDzCawt0aJ/passwords","2001/l8k6MUUxpD/data","2018/nbYktHECji/text","2013/wx8VyjuM8U/object","2011/Pw93HVUKfx/object","2006/7wUUpNuTDs/text","2004/yB7TXeqOga/object","2025/ZuSs8HbgVe/text","2003/mlkZmcCM0E/data"],off_inventory:!1},{bucket_name:"stagingaudite9cmwsae5q",objects:["2016/9y6MmQsbxg/object","2012/4guCu7i4kU/object","2017/tIJXkV2zU9/text","2022/w1hWemKszJ/passwords","2016/YqkZZMKvCr/passwords","2003/9hfbHNqxlC/object","2005/kTwM5c8lx2/text","2011/OJVkCTiYNi/passwords","2009/uXTk29uqsj/object","2004/XLjRDbnTdQ/object","2005/6QgmMfrhTg/passwords","2014/sZRd7XM6PP/data","2016/YjTSGWepfy/text","2025/xhBYSpjPAV/passwords","2001/nr0Edh7dQl/data","2010/W1icZkS0OT/data","2023/EJhGkRAgFv/text","2022/tn895QcVLj/passwords","2008/IZCrFDN6kG/data","2012/kUv9Ehw37Q/passwords","2013/RQyAS9zeoS/data","2020/YU3i9Iu1HN/data","2022/JS2gwoPujj/object","2007/EnBveP5AFa/data","2005/ZGiyyorje0/data","2009/YGuvE5RRTA/data","2003/DqsG2jzJFj/data","2006/QMoVCuMStr/passwords","2004/gYOfMNJxJk/text","2004/GunT2jyMiV/passwords","2004/H67vC0whFx/object","2002/UwiCJe06XX/text","2016/ZgaVv6dIdw/text","2016/adf7FMk05j/data","2018/hmDqgqWf5S/object","2018/4iSdEKEvXc/text","2015/QdmswqFYI0/object","2019/M8YofqbETv/passwords","2021/LiRdw8Ahb5/data","2024/cDzCawt0aJ/passwords","2001/l8k6MUUxpD/data","2018/nbYktHECji/text","2013/wx8VyjuM8U/object","2011/Pw93HVUKfx/object","2006/7wUUpNuTDs/text","2004/yB7TXeqOga/object","2025/ZuSs8HbgVe/text","2003/mlkZmcCM0E/data"],off_inventory:!1},{bucket_name:"staging-user-88s10ql3g9",objects:["2016/9y6MmQsbxg/object","2012/4guCu7i4kU/object","2017/tIJXkV2zU9/text","2022/w1hWemKszJ/passwords","2016/YqkZZMKvCr/passwords","2003/9hfbHNqxlC/object","2005/kTwM5c8lx2/text","2011/OJVkCTiYNi/passwords","2009/uXTk29uqsj/object","2004/XLjRDbnTdQ/object","2005/6QgmMfrhTg/passwords","2014/sZRd7XM6PP/data","2016/YjTSGWepfy/text","2025/xhBYSpjPAV/passwords","2001/nr0Edh7dQl/data","2010/W1icZkS0OT/data","2023/EJhGkRAgFv/text","2022/tn895QcVLj/passwords","2008/IZCrFDN6kG/data","2012/kUv9Ehw37Q/passwords","2013/RQyAS9zeoS/data","2020/YU3i9Iu1HN/data","2022/JS2gwoPujj/object","2007/EnBveP5AFa/data","2005/ZGiyyorje0/data","2009/YGuvE5RRTA/data","2003/DqsG2jzJFj/data","2006/QMoVCuMStr/passwords","2004/gYOfMNJxJk/text","2004/GunT2jyMiV/passwords","2004/H67vC0whFx/object","2002/UwiCJe06XX/text","2016/ZgaVv6dIdw/text","2016/adf7FMk05j/data","2018/hmDqgqWf5S/object","2018/4iSdEKEvXc/text","2015/QdmswqFYI0/object","2019/M8YofqbETv/passwords","2021/LiRdw8Ahb5/data","2024/cDzCawt0aJ/passwords","2001/l8k6MUUxpD/data","2018/nbYktHECji/text","2013/wx8VyjuM8U/object","2011/Pw93HVUKfx/object","2006/7wUUpNuTDs/text","2004/yB7TXeqOga/object","2025/ZuSs8HbgVe/text","2003/mlkZmcCM0E/data"],off_inventory:!1},{bucket_name:"staging-customer-bjcg4qempq",objects:["2016/9y6MmQsbxg/object","2012/4guCu7i4kU/object","2017/tIJXkV2zU9/text","2022/w1hWemKszJ/passwords","2016/YqkZZMKvCr/passwords","2003/9hfbHNqxlC/object","2005/kTwM5c8lx2/text","2011/OJVkCTiYNi/passwords","2009/uXTk29uqsj/object","2004/XLjRDbnTdQ/object","2005/6QgmMfrhTg/passwords","2014/sZRd7XM6PP/data","2016/YjTSGWepfy/text","2025/xhBYSpjPAV/passwords","2001/nr0Edh7dQl/data","2010/W1icZkS0OT/data","2023/EJhGkRAgFv/text","2022/tn895QcVLj/passwords","2008/IZCrFDN6kG/data","2012/kUv9Ehw37Q/passwords","2013/RQyAS9zeoS/data","2020/YU3i9Iu1HN/data","2022/JS2gwoPujj/object","2007/EnBveP5AFa/data","2005/ZGiyyorje0/data","2009/YGuvE5RRTA/data","2003/DqsG2jzJFj/data","2006/QMoVCuMStr/passwords","2004/gYOfMNJxJk/text","2004/GunT2jyMiV/passwords","2004/H67vC0whFx/object","2002/UwiCJe06XX/text","2016/ZgaVv6dIdw/text","2016/adf7FMk05j/data","2018/hmDqgqWf5S/object","2018/4iSdEKEvXc/text","2015/QdmswqFYI0/object","2019/M8YofqbETv/passwords","2021/LiRdw8Ahb5/data","2024/cDzCawt0aJ/passwords","2001/l8k6MUUxpD/data","2018/nbYktHECji/text","2013/wx8VyjuM8U/object","2011/Pw93HVUKfx/object","2006/7wUUpNuTDs/text","2004/yB7TXeqOga/object","2025/ZuSs8HbgVe/text","2003/mlkZmcCM0E/data"],off_inventory:!1},{bucket_name:"devcustomergtkbml1db1",objects:["2016/9y6MmQsbxg/object","2012/4guCu7i4kU/object","2017/tIJXkV2zU9/text","2022/w1hWemKszJ/passwords","2016/YqkZZMKvCr/passwords","2003/9hfbHNqxlC/object","2005/kTwM5c8lx2/text","2011/OJVkCTiYNi/passwords","2009/uXTk29uqsj/object","2004/XLjRDbnTdQ/object","2005/6QgmMfrhTg/passwords","2014/sZRd7XM6PP/data","2016/YjTSGWepfy/text","2025/xhBYSpjPAV/passwords","2001/nr0Edh7dQl/data","2010/W1icZkS0OT/data","2023/EJhGkRAgFv/text","2022/tn895QcVLj/passwords","2008/IZCrFDN6kG/data","2012/kUv9Ehw37Q/passwords","2013/RQyAS9zeoS/data","2020/YU3i9Iu1HN/data","2022/JS2gwoPujj/object","2007/EnBveP5AFa/data","2005/ZGiyyorje0/data","2009/YGuvE5RRTA/data","2003/DqsG2jzJFj/data","2006/QMoVCuMStr/passwords","2004/gYOfMNJxJk/text","2004/GunT2jyMiV/passwords","2004/H67vC0whFx/object","2002/UwiCJe06XX/text","2016/ZgaVv6dIdw/text","2016/adf7FMk05j/data","2018/hmDqgqWf5S/object","2018/4iSdEKEvXc/text","2015/QdmswqFYI0/object","2019/M8YofqbETv/passwords","2021/LiRdw8Ahb5/data","2024/cDzCawt0aJ/passwords","2001/l8k6MUUxpD/data","2018/nbYktHECji/text","2013/wx8VyjuM8U/object","2011/Pw93HVUKfx/object","2006/7wUUpNuTDs/text","2004/yB7TXeqOga/object","2025/ZuSs8HbgVe/text","2003/mlkZmcCM0E/data"],off_inventory:!1},{bucket_name:"devadminmgs7fk30k9",objects:["2016/9y6MmQsbxg/object","2012/4guCu7i4kU/object","2017/tIJXkV2zU9/text","2022/w1hWemKszJ/passwords","2016/YqkZZMKvCr/passwords","2003/9hfbHNqxlC/object","2005/kTwM5c8lx2/text","2011/OJVkCTiYNi/passwords","2009/uXTk29uqsj/object","2004/XLjRDbnTdQ/object","2005/6QgmMfrhTg/passwords","2014/sZRd7XM6PP/data","2016/YjTSGWepfy/text","2025/xhBYSpjPAV/passwords","2001/nr0Edh7dQl/data","2010/W1icZkS0OT/data","2023/EJhGkRAgFv/text","2022/tn895QcVLj/passwords","2008/IZCrFDN6kG/data","2012/kUv9Ehw37Q/passwords","2013/RQyAS9zeoS/data","2020/YU3i9Iu1HN/data","2022/JS2gwoPujj/object","2007/EnBveP5AFa/data","2005/ZGiyyorje0/data","2009/YGuvE5RRTA/data","2003/DqsG2jzJFj/data","2006/QMoVCuMStr/passwords","2004/gYOfMNJxJk/text","2004/GunT2jyMiV/passwords","2004/H67vC0whFx/object","2002/UwiCJe06XX/text","2016/ZgaVv6dIdw/text","2016/adf7FMk05j/data","2018/hmDqgqWf5S/object","2018/4iSdEKEvXc/text","2015/QdmswqFYI0/object","2019/M8YofqbETv/passwords","2021/LiRdw8Ahb5/data","2024/cDzCawt0aJ/passwords","2001/l8k6MUUxpD/data","2018/nbYktHECji/text","2013/wx8VyjuM8U/object","2011/Pw93HVUKfx/object","2006/7wUUpNuTDs/text","2004/yB7TXeqOga/object","2025/ZuSs8HbgVe/text","2003/mlkZmcCM0E/data"],off_inventory:!1},{bucket_name:"dev-audit-qa6lrh6f53",objects:["2016/9y6MmQsbxg/object","2012/4guCu7i4kU/object","2017/tIJXkV2zU9/text","2022/w1hWemKszJ/passwords","2016/YqkZZMKvCr/passwords","2003/9hfbHNqxlC/object","2005/kTwM5c8lx2/text","2011/OJVkCTiYNi/passwords","2009/uXTk29uqsj/object","2004/XLjRDbnTdQ/object","2005/6QgmMfrhTg/passwords","2014/sZRd7XM6PP/data","2016/YjTSGWepfy/text","2025/xhBYSpjPAV/passwords","2001/nr0Edh7dQl/data","2010/W1icZkS0OT/data","2023/EJhGkRAgFv/text","2022/tn895QcVLj/passwords","2008/IZCrFDN6kG/data","2012/kUv9Ehw37Q/passwords","2013/RQyAS9zeoS/data","2020/YU3i9Iu1HN/data","2022/JS2gwoPujj/object","2007/EnBveP5AFa/data","2005/ZGiyyorje0/data","2009/YGuvE5RRTA/data","2003/DqsG2jzJFj/data","2006/QMoVCuMStr/passwords","2004/gYOfMNJxJk/text","2004/GunT2jyMiV/passwords","2004/H67vC0whFx/object","2002/UwiCJe06XX/text","2016/ZgaVv6dIdw/text","2016/adf7FMk05j/data","2018/hmDqgqWf5S/object","2018/4iSdEKEvXc/text","2015/QdmswqFYI0/object","2019/M8YofqbETv/passwords","2021/LiRdw8Ahb5/data","2024/cDzCawt0aJ/passwords","2001/l8k6MUUxpD/data","2018/nbYktHECji/text","2013/wx8VyjuM8U/object","2011/Pw93HVUKfx/object","2006/7wUUpNuTDs/text","2004/yB7TXeqOga/object","2025/ZuSs8HbgVe/text","2003/mlkZmcCM0E/data"],off_inventory:!1}],SQSQueue:null,SSMParameter:[{ssm_parameter_name:"staging-admin-",off_inventory:!1},{ssm_parameter_name:"devadmin",off_inventory:!1},{ssm_parameter_name:"dev_user_",off_inventory:!1},{ssm_parameter_name:"staging_customer_",off_inventory:!1},{ssm_parameter_name:"devaudit",off_inventory:!1},{ssm_parameter_name:"devuser",off_inventory:!1},{ssm_parameter_name:"prod-customer-",off_inventory:!1},{ssm_parameter_name:"prodadmin",off_inventory:!1},{ssm_parameter_name:"prod_admin_",off_inventory:!1}],SecretsManagerSecret:[{secret_name:"testingadmin",off_inventory:!1},{secret_name:"staginguser",off_inventory:!1},{secret_name:"prod-customer-",off_inventory:!1},{secret_name:"prod=customer=",off_inventory:!1},{secret_name:"staging@admin@",off_inventory:!1},{secret_name:"prodcustomer",off_inventory:!1},{secret_name:"prod+admin+",off_inventory:!1}],DynamoDBTable:[{table_name:"testing_admin_",off_inventory:!1,table_items:["text_9d7w9","object-9qx1l","passwordskai75","passwords_x0ejf","objecty58h1","passwords4jxw3","object-g8isj","data-kri38","passwords-m6vkc","data_d5urt","dataki7xi","textt71wp","text_xvvi8","object_d2xul","object-48b3o","text_wfhbg","object1ig2x","textb828r","data_hqdf2","passwords-g2iym","passwords-tryuz","object-xjct6","data_gvj41","passwords-xbbd0","textt5l5k","text_1m2xu","passwords_6ejnl","data_m0n33","datamy5ix","object-ztzhx","text-0inho","passwords2qspa","text_qfnnr","data5tuhm","text_hsl4s","text-env9w","datag0b0z","text_lbckr","dataccwuq","passwords_jxhfb","data_8muf0","passwordskbezg","objecteflm9","passwords-317iz","data-b03qv","data-jor2p","passwords_362h1","textf5y2j","object_2a9rr","passwords-kafe7","text7ls9n","passwords-lnzhs","object2gx8l","data_uwtuv","text_51uvs","datafj2cl","data_rdlqc","textd6akk","text_daol6","text_nuttr","objectablo4","data4zthj","objectyd92u","textltepg","object8d4et","passwordsuy025","text_xn3ox","data_8ro6x","textnqfn6"]}]});b({S3Bucket:[{bucket_name:"devadminmgs7fk30k9",objects:["2016/9y6MmQsbxg/object","2012/4guCu7i4kU/object","2017/tIJXkV2zU9/text","2022/w1hWemKszJ/passwords","2016/YqkZZMKvCr/passwords","2003/9hfbHNqxlC/object","2005/kTwM5c8lx2/text","2011/OJVkCTiYNi/passwords","2009/uXTk29uqsj/object","2004/XLjRDbnTdQ/object","2005/6QgmMfrhTg/passwords","2014/sZRd7XM6PP/data","2016/YjTSGWepfy/text","2025/xhBYSpjPAV/passwords","2001/nr0Edh7dQl/data","2010/W1icZkS0OT/data","2023/EJhGkRAgFv/text","2022/tn895QcVLj/passwords","2008/IZCrFDN6kG/data","2012/kUv9Ehw37Q/passwords","2013/RQyAS9zeoS/data","2020/YU3i9Iu1HN/data","2022/JS2gwoPujj/object","2007/EnBveP5AFa/data","2005/ZGiyyorje0/data","2009/YGuvE5RRTA/data","2003/DqsG2jzJFj/data","2006/QMoVCuMStr/passwords","2004/gYOfMNJxJk/text","2004/GunT2jyMiV/passwords","2004/H67vC0whFx/object","2002/UwiCJe06XX/text","2016/ZgaVv6dIdw/text","2016/adf7FMk05j/data","2018/hmDqgqWf5S/object","2018/4iSdEKEvXc/text","2015/QdmswqFYI0/object","2019/M8YofqbETv/passwords","2021/LiRdw8Ahb5/data","2024/cDzCawt0aJ/passwords","2001/l8k6MUUxpD/data","2018/nbYktHECji/text","2013/wx8VyjuM8U/object","2011/Pw93HVUKfx/object","2006/7wUUpNuTDs/text","2004/yB7TXeqOga/object","2025/ZuSs8HbgVe/text","2003/mlkZmcCM0E/data"],off_inventory:!0},{bucket_name:"dev-audit-qa6lrh6f53",objects:["2016/9y6MmQsbxg/object","2012/4guCu7i4kU/object","2017/tIJXkV2zU9/text","2022/w1hWemKszJ/passwords","2016/YqkZZMKvCr/passwords","2003/9hfbHNqxlC/object","2005/kTwM5c8lx2/text","2016/ZgaVv6dIdw/text","2016/adf7FMk05j/data","2018/hmDqgqWf5S/object","2018/4iSdEKEvXc/text","2015/QdmswqFYI0/object","2019/M8YofqbETv/passwords","2021/LiRdw8Ahb5/data","2024/cDzCawt0aJ/passwords","2001/l8k6MUUxpD/data","2018/nbYktHECji/text","2013/wx8VyjuM8U/object","2011/Pw93HVUKfx/object","2006/7wUUpNuTDs/text","2004/yB7TXeqOga/object","2025/ZuSs8HbgVe/text","2003/mlkZmcCM0E/data"],off_inventory:!0}],SQSQueue:[{sqs_queue_name:"testing_admin_",off_inventory:!0},{sqs_queue_name:"prod-admin-",off_inventory:!0},{sqs_queue_name:"prod_audit_",off_inventory:!0},{sqs_queue_name:"staginguser",off_inventory:!0},{sqs_queue_name:"dev-audit-",off_inventory:!0},{sqs_queue_name:"staging-audit-",off_inventory:!0},{sqs_queue_name:"dev_user_",off_inventory:!0}],SSMParameter:[{ssm_parameter_name:"staging-admin-",off_inventory:!0},{ssm_parameter_name:"devadmin",off_inventory:!0},{ssm_parameter_name:"dev_user_",off_inventory:!0},{ssm_parameter_name:"staging_customer_",off_inventory:!0},{ssm_parameter_name:"devaudit",off_inventory:!0},{ssm_parameter_name:"devuser",off_inventory:!0},{ssm_parameter_name:"prod-customer-",off_inventory:!1},{ssm_parameter_name:"prodadmin",off_inventory:!1},{ssm_parameter_name:"prod_admin_",off_inventory:!1}],SecretsManagerSecret:[{secret_name:"testingadmin",off_inventory:!0},{secret_name:"staginguser",off_inventory:!0},{secret_name:"prod-customer-",off_inventory:!0},{secret_name:"prod=customer=",off_inventory:!0},{secret_name:"staging@admin@",off_inventory:!0},{secret_name:"prodcustomer",off_inventory:!0},{secret_name:"prod+admin+",off_inventory:!0}],DynamoDBTable:[{table_name:"testing_admin_",off_inventory:!0,table_items:["text_9d7w9","object-9qx1l","passwordskai75","passwords_x0ejf","objecty58h1","passwords4jxw3","object-g8isj","data-kri38","passwords-m6vkc","data_d5urt","dataki7xi","textt71wp","text_xvvi8","object_d2xul","object-48b3o","text_wfhbg","object1ig2x","textb828r","data_hqdf2","passwords-g2iym","passwords-tryuz","object-xjct6","data_gvj41","passwords-xbbd0","textt5l5k","text_1m2xu","passwords_6ejnl","data_m0n33","datamy5ix","object-ztzhx","text-0inho","passwords2qspa","text_qfnnr","data5tuhm","text_hsl4s","text-env9w","datag0b0z","text_lbckr","dataccwuq","passwords_jxhfb","data_8muf0","passwordskbezg","objecteflm9","passwords-317iz","data-b03qv","data-jor2p","passwords_362h1","textf5y2j","object_2a9rr","passwords-kafe7","text7ls9n","passwords-lnzhs","object2gx8l","data_uwtuv","text_51uvs","datafj2cl","data_rdlqc","textd6akk","text_daol6","text_nuttr","objectablo4","data4zthj","objectyd92u","textltepg","object8d4et","passwordsuy025","text_xn3ox","data_8ro6x","textnqfn6"]}]});b({S3Bucket:[{bucket_name:"stagingcustomersab5rcqvgz",objects:["2016/9y6MmQsbxg/object","2012/4guCu7i4kU/object","2017/tIJXkV2zU9/text","2022/w1hWemKszJ/passwords","2016/YqkZZMKvCr/passwords","2003/9hfbHNqxlC/object","2005/kTwM5c8lx2/text","2016/ZgaVv6dIdw/text","2016/adf7FMk05j/data","2018/hmDqgqWf5S/object","2018/4iSdEKEvXc/text","2015/QdmswqFYI0/object","2019/M8YofqbETv/passwords","2021/LiRdw8Ahb5/data","2024/cDzCawt0aJ/passwords","2001/l8k6MUUxpD/data","2018/nbYktHECji/text","2013/wx8VyjuM8U/object","2011/Pw93HVUKfx/object","2006/7wUUpNuTDs/text","2004/yB7TXeqOga/object","2025/ZuSs8HbgVe/text","2003/mlkZmcCM0E/data"],off_inventory:!1},{bucket_name:"testinguseryq78uglinf",objects:["2016/9y6MmQsbxg/object","2012/4guCu7i4kU/object","2017/tIJXkV2zU9/text","2022/w1hWemKszJ/passwords","2016/YqkZZMKvCr/passwords","2003/9hfbHNqxlC/object","2005/kTwM5c8lx2/text","2016/ZgaVv6dIdw/text","2016/adf7FMk05j/data","2018/hmDqgqWf5S/object","2018/4iSdEKEvXc/text","2015/QdmswqFYI0/object","2019/M8YofqbETv/passwords","2021/LiRdw8Ahb5/data","2024/cDzCawt0aJ/passwords","2001/l8k6MUUxpD/data","2018/nbYktHECji/text","2013/wx8VyjuM8U/object","2011/Pw93HVUKfx/object","2006/7wUUpNuTDs/text","2004/yB7TXeqOga/object","2025/ZuSs8HbgVe/text","2003/mlkZmcCM0E/data"],off_inventory:!1},{bucket_name:"stagingaudite9cmwsae5q",objects:["2021/LiRdw8Ahb5/data","2024/cDzCawt0aJ/passwords","2001/l8k6MUUxpD/data","2018/nbYktHECji/text","2013/wx8VyjuM8U/object","2011/Pw93HVUKfx/object","2006/7wUUpNuTDs/text","2004/yB7TXeqOga/object","2025/ZuSs8HbgVe/text","2003/mlkZmcCM0E/data"],off_inventory:!1},{bucket_name:"staging-user-88s10ql3g9",objects:["2016/9y6MmQsbxg/object","2012/4guCu7i4kU/object","2017/tIJXkV2zU9/text","2022/w1hWemKszJ/passwords","2016/YqkZZMKvCr/passwords","2003/9hfbHNqxlC/object","2005/kTwM5c8lx2/text","2016/ZgaVv6dIdw/text","2016/adf7FMk05j/data","2018/hmDqgqWf5S/object","2018/4iSdEKEvXc/text","2015/QdmswqFYI0/object","2019/M8YofqbETv/passwords","2021/LiRdw8Ahb5/data","2024/cDzCawt0aJ/passwords","2001/l8k6MUUxpD/data","2018/nbYktHECji/text","2013/wx8VyjuM8U/object","2011/Pw93HVUKfx/object","2006/7wUUpNuTDs/text","2004/yB7TXeqOga/object","2025/ZuSs8HbgVe/text","2003/mlkZmcCM0E/data"],off_inventory:!1},{bucket_name:"staging-customer-bjcg4qempq",objects:["2016/9y6MmQsbxg/object","2012/4guCu7i4kU/object","2017/tIJXkV2zU9/text","2022/w1hWemKszJ/passwords","2016/YqkZZMKvCr/passwords","2003/9hfbHNqxlC/object","2005/kTwM5c8lx2/text","2016/ZgaVv6dIdw/text","2016/adf7FMk05j/data","2018/hmDqgqWf5S/object","2018/4iSdEKEvXc/text","2015/QdmswqFYI0/object","2019/M8YofqbETv/passwords","2021/LiRdw8Ahb5/data","2024/cDzCawt0aJ/passwords","2001/l8k6MUUxpD/data","2018/nbYktHECji/text","2013/wx8VyjuM8U/object","2011/Pw93HVUKfx/object","2006/7wUUpNuTDs/text","2004/yB7TXeqOga/object","2025/ZuSs8HbgVe/text","2003/mlkZmcCM0E/data"],off_inventory:!1},{bucket_name:"devcustomergtkbml1db1",objects:["2016/9y6MmQsbxg/object","2012/4guCu7i4kU/object","2017/tIJXkV2zU9/text","2022/w1hWemKszJ/passwords","2016/YqkZZMKvCr/passwords","2003/9hfbHNqxlC/object","2005/kTwM5c8lx2/text","2016/ZgaVv6dIdw/text","2016/adf7FMk05j/data","2018/hmDqgqWf5S/object","2018/4iSdEKEvXc/text","2015/QdmswqFYI0/object","2019/M8YofqbETv/passwords","2021/LiRdw8Ahb5/data","2024/cDzCawt0aJ/passwords","2001/l8k6MUUxpD/data","2018/nbYktHECji/text","2013/wx8VyjuM8U/object","2011/Pw93HVUKfx/object","2006/7wUUpNuTDs/text","2004/yB7TXeqOga/object","2025/ZuSs8HbgVe/text","2003/mlkZmcCM0E/data"],off_inventory:!1},{bucket_name:"devadminmgs7fk30k9",objects:["2016/9y6MmQsbxg/object","2012/4guCu7i4kU/object","2017/tIJXkV2zU9/text","2022/w1hWemKszJ/passwords","2016/YqkZZMKvCr/passwords","2003/9hfbHNqxlC/object","2005/kTwM5c8lx2/text","2016/ZgaVv6dIdw/text","2016/adf7FMk05j/data","2018/hmDqgqWf5S/object","2018/4iSdEKEvXc/text","2015/QdmswqFYI0/object","2019/M8YofqbETv/passwords","2021/LiRdw8Ahb5/data","2024/cDzCawt0aJ/passwords","2001/l8k6MUUxpD/data","2018/nbYktHECji/text","2013/wx8VyjuM8U/object","2011/Pw93HVUKfx/object","2006/7wUUpNuTDs/text","2004/yB7TXeqOga/object","2025/ZuSs8HbgVe/text","2003/mlkZmcCM0E/data"],off_inventory:!1},{bucket_name:"dev-audit-qa6lrh6f53",objects:["2016/9y6MmQsbxg/object","2012/4guCu7i4kU/object","2017/tIJXkV2zU9/text","2022/w1hWemKszJ/passwords","2016/YqkZZMKvCr/passwords","2003/9hfbHNqxlC/object","2005/kTwM5c8lx2/text","2016/ZgaVv6dIdw/text","2016/adf7FMk05j/data","2018/hmDqgqWf5S/object","2018/4iSdEKEvXc/text","2015/QdmswqFYI0/object","2019/M8YofqbETv/passwords","2021/LiRdw8Ahb5/data","2024/cDzCawt0aJ/passwords","2001/l8k6MUUxpD/data","2018/nbYktHECji/text","2013/wx8VyjuM8U/object","2011/Pw93HVUKfx/object","2006/7wUUpNuTDs/text","2004/yB7TXeqOga/object","2025/ZuSs8HbgVe/text","2003/mlkZmcCM0E/data"],off_inventory:!1}],SQSQueue:[{sqs_queue_name:"testing_admin_",off_inventory:!1},{sqs_queue_name:"prod-admin-",off_inventory:!1},{sqs_queue_name:"prod_audit_",off_inventory:!1},{sqs_queue_name:"staginguser",off_inventory:!1},{sqs_queue_name:"dev-audit-",off_inventory:!1},{sqs_queue_name:"staging-audit-",off_inventory:!1},{sqs_queue_name:"dev_user_",off_inventory:!1}],SSMParameter:[{ssm_parameter_name:"staging-admin-",off_inventory:!1},{ssm_parameter_name:"devadmin",off_inventory:!1},{ssm_parameter_name:"dev_user_",off_inventory:!1},{ssm_parameter_name:"staging_customer_",off_inventory:!1},{ssm_parameter_name:"devaudit",off_inventory:!1},{ssm_parameter_name:"devuser",off_inventory:!1},{ssm_parameter_name:"prod-customer-",off_inventory:!1},{ssm_parameter_name:"prodadmin",off_inventory:!1},{ssm_parameter_name:"prod_admin_",off_inventory:!1}],SecretsManagerSecret:[{secret_name:"testingadmin",off_inventory:!1},{secret_name:"staginguser",off_inventory:!1},{secret_name:"prod-customer-",off_inventory:!1},{secret_name:"prod=customer=",off_inventory:!1},{secret_name:"staging@admin@",off_inventory:!1},{secret_name:"prodcustomer",off_inventory:!1},{secret_name:"prod+admin+",off_inventory:!1}]});const Mt=50,G=Xe({totalAiQuota:0,availableAiQuota:0,aiQuotaErrorShown:!1,isTotalQuotaInitialized:!1,isAvailableQuotaInitialized:!1});function Se(r){G.isTotalQuotaInitialized=!0,G.totalAiQuota=r}function Ze(r){G.isAvailableQuotaInitialized=!0,G.availableAiQuota=r}function Ne(r){if(!G.isAvailableQuotaInitialized){Ze(r);return}r<G.availableAiQuota&&(G.availableAiQuota=r)}function Re(){return Ge(G)}function At(r){G.aiQuotaErrorShown=r}const ae=b({S3Bucket:[],SQSQueue:[],SSMParameter:[],SecretsManagerSecret:[],DynamoDBTable:[]});function Tt(r){ae.value=r}function Ct(){return ae.value}function qt(r){var n;const{assetType:o,assetData:e,index:t}=r;ae.value[o]||(ae.value[o]=[]),t===-1?(n=ae.value[o])==null||n.unshift(e):ae.value[o][t]=e}function xe(r,o){const e=b(""),t=b(!1),n=b(""),i=b(""),m=b(""),f=He();if(f){const{auth_token:d,token:x}=f;i.value=d,m.value=x}t.value=!0,e.value="";const _=window.location.pathname.includes("/nest/plan-preview");async function l(d=""){const{aiQuotaErrorShown:x}=Re(),s={assets:Ct()};if(_){const u=await St();n.value=u.proposed_data,t.value=!1;return}if(x.value){const u=Ee(20);n.value=u;return}try{const u=await rt(m.value,i.value,r,o,d,s);u.data.result||(e.value=u.data.message),n.value=u.data.proposed_data;const h=u.data.data_generation_remaining||0;Ne(h)}catch(u){if(u.response.status===429){At(!0),e.value=u.response.data.message||"You have reached your limit for AI-generated decoy names. You can continue with manual setup.";return}e.value=u.response.data.message||"An error occurred while generating the asset name."}finally{t.value=!1}}return{handleGenerateName:l,isGenerateNameError:e,isGenerateNameLoading:t,generatedName:n}}const Dt={class:"asset-card__wrapper"},Et={key:0,class:"asset-card__badge text-xs text-white bg-yellow rounded-lg px-4 py-[2px] absolute"},Ut={class:"asset-card__content"},Qt=["src","alt"],Vt={class:"text-sm text-grey-400 text-pretty"},Yt={class:"asset-card__list-data list-none"},It={class:"label text-grey-400"},Zt=["src","alt"],Nt={class:"asset-card__options"},Rt=B({__name:"AssetCard",props:{assetType:{},assetData:{}},emits:["showAsset","deleteAsset","selectAsset"],setup(r,{emit:o}){const e=o,t=r,n=b(!1),i=b(),m=A(()=>{const s=de(t.assetType);return t.assetData[s]}),f=A(()=>{const s=de(t.assetType);return Object.entries(t.assetData).map(([h,g])=>h.includes(s)||h.includes("off_inventory")?null:Array.isArray(g)?[h,g.length]:[h,g]).filter(h=>h!==null)}),_=A(()=>t.assetData.off_inventory);function l(){e("showAsset"),i.value&&i.value.blur()}function d(){n.value=!0}function x(){n.value=!1}return(s,u)=>{const h=pe("font-awesome-icon"),g=fe("tooltip");return a(),v("li",Dt,[_.value?oe((a(),v("span",Et,u[1]||(u[1]=[V("Not found")]))),[[g,{html:!0,content:"We couldn`t find this resource in your inventory.<br/>If you wish to remove it permanently, delete it from the list."}]]):k("",!0),c("button",{ref_key:"assetCardRef",ref:i,class:P(["asset-card group border group bg-white rounded-2xl top-[0px] border-grey-200 duration-100 ease-in-out",{"border-yellow":_.value}]),onClick:se(l,["stop"]),onMouseover:d,onFocus:d,onMouseleave:x,onBlur:x},[c("div",Ut,[c("img",{src:w(ie)(`aws_infra_icons/${t.assetType}.svg`),alt:`logo-${s.assetType}`,class:"rounded-full"},null,8,Qt),c("p",Vt,T(m.value),1)]),c("ul",Yt,[(a(!0),v(z,null,O(f.value,([D,j])=>(a(),v("li",{key:D,class:"text-sm"},[c("span",It,T(w(X)(s.assetType,D))+": ",1),c("span",{class:P(["value text-grey-700",{"with-icon":w(ke)(t.assetType,D)}])},[w(ke)(t.assetType,D)?(a(),v("img",{key:0,src:w(ie)(`aws_infra_icons/${D}.svg`),alt:`${D} icon`,class:"w-[1.5rem] h-[1.5rem]"},null,8,Zt)):k("",!0),c("span",{class:P({"cropped-data":f.value.length>1})},T(j),3)],2)]))),128))])],34),c("div",Nt,[c("button",{type:"button",class:"list-btn-edit text-sm text-grey-400",onClick:se(l,["stop"])}," Edit "),oe((a(),v("button",{type:"button",class:"btn-delete w-[1.5rem] text-grey-300 rounded-full hover:text-green-500","aria-label":"Delete asset",onClick:u[0]||(u[0]=D=>e("deleteAsset"))},[Z(h,{"aria-hidden":"true",icon:"trash"})])),[[g,{content:"Delete asset"}]])])])}}}),Jt={class:"flex flex-col gap-8"},Pt=B({__name:"ModalAssetContentList",props:{assetType:{},assetData:{}},emits:["show-asset-details","delete-asset"],setup(r,{emit:o}){const e=r,t=o;function n(m,f){t("show-asset-details",m,f)}function i(m){t("delete-asset",m)}return(m,f)=>(a(),v("ul",Jt,[(a(!0),v(z,null,O(e.assetData,(_,l)=>(a(),q(Rt,{key:`${l}-${e.assetType}`,"asset-data":_,"asset-type":m.assetType,"view-type":"listView",onShowAsset:()=>n(_,l),onDeleteAsset:d=>i(l)},null,8,["asset-data","asset-type","onShowAsset","onDeleteAsset"]))),128))]))}}),zt=/^\d{1,3}(\.\d{1,3}){3}$/,Bt=/^[a-z0-9][a-z0-9.\-]*[a-z0-9]$/,Ft=/^(?!(xn--|sthree-|sthree-configurator|s3alias|s3-|s3control-))/,$t=/^[a-zA-Z0-9!_.\-~*'()/]+$/,Xt=/^[A-Za-z0-9_\-;]+$/,Gt=/^(?!aws|ssm)/i,Ht=/^[a-zA-Z0-9_.-]+$/,Kt=/^[A-Za-z0-9/_+=.@-]+$/,Me=/^[a-zA-Z0-9_.-]+$/,ue=(r,o)=>be().required().label(X(r,o)),Ot=ne().shape({bucket_name:ue(R.S3BUCKET,"bucket_name").min(3,"S3 Bucket name must be min 3 characters").max(63,"S3 Bucket name must be max 63 characters").matches(Ft,"S3 Bucket can't start with xn--, sthree-, sthree-configurator, s3alias, s3-, or s3control-").matches(Bt,"S3 Bucket name must contain only lowercase letters, numbers, dots, or hyphens").test("not-an-ipv4","S3 Bucket name cannot be formatted as an IP address.",r=>r?!zt.test(r):!0).test("not-end-with-ol-s3","S3 Bucket name must not end with --ol-s3",r=>r?!r.endsWith("--ol-s3"):!0),objects:Ue().of(be().required().max(200,"S3 Object must be max 200 characters").matches($t,"S3 Object must contain only alphanumeric characters, !_.-~*'()/").label(X(R.S3BUCKET,"objects")))}),Lt=ne().shape({sqs_queue_name:ue(R.SQSQUEUE,"sqs_queue_name").max(80,"SQS Queue name must be max 80 characters").matches(Xt,"SQS Queue name must contain only letters, numbers, underscores, hyphens, or semicolons")}),Wt=ne().shape({ssm_parameter_name:ue(R.SSMPARAMETER,"ssm_parameter_name").max(2048,"SSM Parameter name must be max 2048 characters").matches(Gt,"SSM Parameter name can't be equal or start with 'aws' and 'ssm'").matches(Ht,"SSM Parameter name must contain only letters, numbers, and '._-'.")}),ea=ne().shape({secret_name:ue(R.SECRETMANAGERSECRET,"secret_name").max(512,"Secret name must be max 512 characters").matches(Kt,"Secret name must contain only alphanumeric characters, /, _, +, =, ., @, or -")}),ta=ne().shape({table_name:ue(R.DYNAMODBTABLE,"table_name").max(255,"Table name must be max 255 characters").matches(Me,"Table name must contain only letters, numbers, underscores, hyphens, or semicolons"),table_items:Ue().of(be().required().max(255,"Table item must be max 200 characters").matches(Me,"Table item must contain only letters, numbers, underscores, hyphens, or semicolons").label(X(R.DYNAMODBTABLE,"table_items")))}),aa=ne(),sa=["src"],oa=["id","value","placeholder","aria-invalid","required","disabled"],na={class:"error-message"},ra={key:0,id:"error",class:"text-xs leading-4 text-red"},la={key:1,id:"error",class:"text-xs leading-4 text-red"},ia=B({__name:"AssetTextField",props:{id:{},label:{},placeholder:{},required:{type:Boolean},disabled:{type:Boolean},maxLength:{},variant:{},icon:{},hasRemove:{type:Boolean},hideLabel:{type:Boolean},assetType:{},fieldType:{},value:{},parentAssetName:{}},emits:["update:modelValue","handleRemoveInstance","handleRegenerateInstance"],setup(r,{emit:o}){const e=r,{variant:t="large",hasRemove:n=!1,hideLabel:i=!1}=e,m=o,f=Ke(e,"id"),{value:_,handleChange:l,errorMessage:d,resetField:x}=Oe(f,void 0,{initialValue:e.value}),s=b(""),u=b(!1);function h(j){d&&d.value&&l(j)}async function g(){s.value="";const{handleGenerateName:j,isGenerateNameError:Y,isGenerateNameLoading:M,generatedName:H}=xe(e.assetType,e.fieldType);u.value=M.value,await j(e.parentAssetName),s.value=Y.value,x({value:H.value}),u.value=!1}const D=A(()=>e.icon?ie(e.icon):"");return te(()=>e.value,j=>{l(j)}),(j,Y)=>{const M=dt,H=Le,F=pe("font-awesome-icon"),L=fe("tooltip");return a(),v("div",{class:P(["textfield-wrapper",w(t)])},[w(i)?k("",!0):(a(),q(M,{key:0,id:f.value},{default:U(()=>[V(T(e.label),1)]),_:1},8,["id"])),j.icon?(a(),v("img",{key:1,alt:"icon",class:P(["icon",[{"top-[2rem]":!w(i)},{"top-[0.3rem]":w(i)}]]),src:D.value},null,10,sa)):k("",!0),c("input",{id:f.value,value:w(_),class:P([{input__error:w(d)},{input__disabled:j.disabled},{"input__with-icon":j.icon}]),placeholder:j.placeholder,"aria-invalid":!!w(d),"aria-describedby":"helper error",required:j.required,disabled:j.disabled,onBlur:Y[0]||(Y[0]=(...$)=>w(l)&&w(l)(...$)),onInput:Y[1]||(Y[1]=$=>h($))},null,42,oa),u.value?(a(),q(H,{key:2,height:"1.5rem",class:"textfield__loading"})):k("",!0),c("div",{class:P(["textfield__cta",{"top-[2rem]":!w(i)}])},[u.value?k("",!0):oe((a(),v("button",{key:0,type:"button",class:"textfield__cta__regenerate","aria-label":"Regenerate input content",onClick:g},[Z(F,{"aria-hidden":"true",icon:"rotate-right"})])),[[L,{content:"Regenerate content"}]]),w(n)?oe((a(),v("button",{key:1,type:"button",class:"textfield__cta__remove","aria-label":"Remove instance",onClick:Y[2]||(Y[2]=$=>m("handleRemoveInstance"))},[Z(F,{"aria-hidden":"true",icon:"trash"})])),[[L,{content:"Remove instance"}]]):k("",!0)],2),c("div",na,[w(d)?(a(),v("p",ra,T(w(d)),1)):k("",!0),s.value?(a(),v("p",la,T(s.value),1)):k("",!0)])],2)}}}),Je=De(ia,[["__scopeId","data-v-b8a85271"]]),da={class:"paginated_object_list__wrapper"},ua={key:0,class:"flex flex-col items-center"},ca={class:"mt-16 flex flex-row gap-16"},ma=["disabled"],fa=["onClick"],pa=["disabled"],Ae=10,va=B({__name:"AssetFormPagination",props:{fields:{}},setup(r){const o=r,e=b(1),t=b(0),n=A(()=>Math.ceil(o.fields.length/Ae));ge(()=>{m(),window.addEventListener("resize",()=>m())});const i=A(()=>(e.value-1)*t.value);function m(){const l=document.querySelector(".paginated_object_list__wrapper");t.value=l instanceof HTMLElement?l.offsetWidth:0}function f(){e.value>=1&&e.value--}function _(){e.value<n.value&&e.value++}return(l,d)=>{const x=pe("font-awesome-icon");return a(),v(z,null,[c("div",da,[c("fieldset",{class:"paginated_object_list",style:Qe({"--page-count":n.value,"--list-rows":n.value>1?Ae:l.fields.length,"--scroll-position":`${i.value}`,"--container-width":`${t.value}px`})},[We(l.$slots,"default")],4)]),n.value>1?(a(),v("div",ua,[c("div",ca,[c("button",{type:"button",disabled:e.value===1,class:"text-grey-200 hover:text-green-500 pointer",onClick:se(f,["stop"])},[d[0]||(d[0]=c("span",{class:"sr-only"},"Prev",-1)),Z(x,{icon:"chevron-left","aria-hidden":"true"})],8,ma),(a(!0),v(z,null,O(n.value,s=>(a(),v("button",{key:s,class:"w-[1.5rem] h-[1.5rem] border border-solid border-grey-300 rounded-full text-sm text-grey-400 hover:text-green-500 pointer",type:"button",onClick:se(u=>e.value=s,["stop"])},[c("span",{class:P({"text-grey-700 font-semibold":e.value===s})},T(s),3)],8,fa))),128)),c("button",{type:"button",disabled:e.value===n.value,class:"text-grey-200 hover:text-green-500 pointer",onClick:se(_,["stop"])},[d[1]||(d[1]=c("span",{class:"sr-only"},"Next",-1)),Z(x,{icon:"chevron-right","aria-hidden":"true"})],8,pa)])])):k("",!0)],64)}}}),_a={class:"flex flex-row justify-between my-16"},ba={class:"flex flex-row gap-8 items-center"},ga=["src","alt"],ya={class:"flex flex-col"},wa={class:"text-grey-500"},Te=20,xa=B({__name:"AssetFormArray",props:{assetType:{},assetKey:{},fields:{},parentAssetName:{},prepend:{type:Function},remove:{type:Function}},setup(r){const o=r,e=b(!1),t=b("");function n(){return ie(`aws_infra_icons/${o.assetKey}.svg`)}const i=A(()=>Array.isArray(o.fields)&&o.fields.length>=Te);async function m(){if(e.value)return;e.value=!0,t.value="";const{handleGenerateName:f,isGenerateNameError:_,isGenerateNameLoading:l,generatedName:d}=xe(o.assetType,o.assetKey);if(await f(o.parentAssetName),t.value=_.value,e.value=l.value,t.value){e.value=!1;return}o.prepend(d.value),e.value=!1}return(f,_)=>{const l=ye,d=we;return a(),v(z,null,[c("div",_a,[c("div",ba,[c("img",{src:n(),alt:`icon ${w(X)(o.assetType,o.assetKey)}`,class:"h-[2rem] w-[2rem]"},null,8,ga),c("legend",ya,[c("span",wa,T(w(X)(o.assetType,o.assetKey)),1)])]),Z(l,{type:"button",variant:"text",icon:"plus",loading:e.value,disabled:i.value,onClick:m},{default:U(()=>_[0]||(_[0]=[V(" Add Decoy ")])),_:1},8,["loading","disabled"])]),t.value?(a(),q(d,{key:0,variant:"danger"},{default:U(()=>[V(T(w(Ie)(t.value)),1)]),_:1})):k("",!0),i.value?(a(),q(d,{key:1,variant:"warning",class:"mb-16"},{default:U(()=>[V("You have reached the maximum of "+T(Te)+" "+T(w(X)(o.assetType,o.assetKey))+". ",1)]),_:1})):k("",!0),Z(va,{fields:o.fields},{default:U(()=>[(a(!0),v(z,null,O(f.fields,(x,s)=>(a(),v("div",{key:s,class:"object_item pl-24"},[Z(Je,{id:`${o.assetKey}.${s}`,value:x.value,label:w(X)(o.assetType,o.assetKey),"field-type":o.assetKey,variant:"small",icon:`aws_infra_icons/${o.assetKey}.svg`,"hide-label":!0,"has-remove":!0,"asset-type":o.assetType,"parent-asset-name":o.parentAssetName,onHandleRemoveInstance:u=>f.remove(s)},null,8,["id","value","label","field-type","icon","asset-type","parent-asset-name","onHandleRemoveInstance"])]))),128))]),_:1},8,["fields"])],64)}}}),ha=["initial-values","validation-schema"],ja=B({__name:"AssetForm",props:{assetType:{},assetData:{},validationSchema:{},triggerSubmit:{type:Boolean},triggerCancel:{type:Boolean}},emits:["update-asset","invalid-submit","update-temporary-asset"],setup(r,{emit:o}){const e=r,t=o,n=b({}),i=et("formAssetRef"),{values:m,handleSubmit:f}=tt({initialValues:e.assetData,validationSchema:e.validationSchema});ge(()=>{var u;const s=(u=i.value)==null?void 0:u.querySelector("input");s==null||s.focus()});const _=A(()=>{const s=de(e.assetType);return String(e.assetData[s])||""});function l(s){f(()=>{t("update-asset",s)})()}function d(){f(l)()}function x(){t("update-asset",n.value)}return te(()=>e.assetData,s=>{n.value={...s}},{immediate:!0}),te(()=>e.triggerSubmit,s=>{if(s===!0)return d()},{immediate:!0}),te(()=>e.triggerCancel,s=>{if(s===!0)return x()},{immediate:!0}),te(m,s=>{t("update-temporary-asset",s)},{deep:!0}),(s,u)=>(a(),v("form",{ref_key:"formAssetRef",ref:i,"initial-values":n.value,"validation-schema":e.validationSchema,onSubmit:l},[(a(!0),v(z,null,O(n.value,(h,g)=>(a(),v("div",{key:g},[Array.isArray(h)?(a(),q(w(at),{key:0,name:g},{default:U(({fields:D,prepend:j,remove:Y})=>[Z(xa,{"asset-type":e.assetType,"asset-key":g,fields:D,"parent-asset-name":_.value,prepend:j,remove:Y},null,8,["asset-type","asset-key","fields","parent-asset-name","prepend","remove"])]),_:2},1032,["name"])):(a(),q(Je,{key:1,id:g,value:n.value[g],label:w(X)(e.assetType,g),"field-type":g,"asset-type":e.assetType},null,8,["id","value","label","field-type","asset-type"]))]))),128))],40,ha))}}),ka={class:"border bg-white rounded-2xl shadow-solid-shadow-grey border-grey-200 p-16 mx-24 my-16"},Sa=B({__name:"ModalAssetContentItem",props:{assetType:{},assetData:{},triggerSubmit:{type:Boolean},triggerCancel:{type:Boolean}},emits:["update-asset","update-temporary-asset"],setup(r,{emit:o}){const e=r,t=o;function n(f){t("update-asset",f)}function i(f){t("update-temporary-asset",f)}const m=A(()=>{switch(e.assetType){case R.S3BUCKET:return Ot;case R.SQSQUEUE:return Lt;case R.SSMPARAMETER:return Wt;case R.SECRETMANAGERSECRET:return ea;case R.DYNAMODBTABLE:return ta;default:return aa}});return(f,_)=>(a(),v("div",ka,[Z(ja,{"asset-type":e.assetType,"asset-data":e.assetData,"validation-schema":m.value,"trigger-submit":e.triggerSubmit,"trigger-cancel":e.triggerCancel,onUpdateAsset:n,onUpdateTemporaryAsset:i},null,8,["asset-type","asset-data","validation-schema","trigger-submit","trigger-cancel"])]))}}),Ma={key:0,class:"flex flex-col mb-8"},Aa={class:"text-center mb-16"},Ce=4,Ta=B({__name:"ModalAsset",props:{assetType:{},assetData:{},closeModal:{type:Function}},emits:["update-asset","delete-asset","add-asset","update-temporary-asset"],setup(r,{emit:o}){const e=r,t=o,n=b(!1),i=b({assetType:"",assetData:{},index:-1}),m=b(!1),f=b(!1),_=b(!1),l=b(""),d=A(()=>{var Q;return((Q=e.assetData)==null?void 0:Q.value)??e.assetData}),x=A(()=>Array.isArray(d.value)&&d.value.length===0),s=A(()=>Array.isArray(d.value)&&d.value.length>=Ce),u=A(()=>Ye(e.assetType)),h=A(()=>x.value?`You can add new decoys to your ${u.value}.`:`We generated ${u.value} names based on your current deployment.`);function g(Q,S){l.value="",n.value=!0,i.value={assetType:e.assetType,assetData:Q,index:S}}function D(Q){const{off_inventory:S,...K}=Q;return K}function j(Q){i.value.assetData=Q,t("update-asset",i.value),n.value=!1}function Y(Q){qt({...i.value,assetData:Q})}async function M(){if(_.value)return;const Q=()=>it(e.assetType),S={...Q()};async function K(){_.value=!0,l.value="";try{if((await Promise.all(Object.keys(Q()).map(async I=>{if(Array.isArray(S[I]))return null;if(I==="off_inventory")return{key:I,value:!1};const{handleGenerateName:re,isGenerateNameError:N,isGenerateNameLoading:le,generatedName:ve}=xe(e.assetType,I);return _.value=le.value,await re(),l.value=N.value,{key:I,value:ve.value}}))).forEach(I=>{I&&(S[I.key]=I.value)}),l.value)return null;t("add-asset",S)}catch(J){if(J.response.status===429){l.value=J.response.data.message||"You have reached your limit for AI-generated decoy names. You can continue with manual setup.";return}l.value=J.response.data.message||"An error occurred"}finally{_.value=!1}}await K()}function H(Q){l.value="",t("delete-asset",Q)}function F(){e.closeModal()}function L(){m.value=!0,je(()=>{m.value=!1})}function $(){f.value=!0,l.value="",je(()=>{f.value=!1})}return(Q,S)=>{const K=pe("font-awesome-icon"),J=ye,I=we,re=st;return a(),q(re,{title:`${u.value} Decoys`,"has-close-button":!n.value,class:"flex flex-row items-stretch","click-to-close":!1,"onUpdate:modelValue":F},{"header-btn-left":U(()=>[n.value?(a(),v("button",{key:0,type:"button","aria-label":"Back",class:"w-24 h-24 text-sm duration-150 bg-transparent border border-solid rounded-full hover:text-white text-grey-300 border-grey-300 hover:bg-green-600 hover:border-green-300",onClick:$},[Z(K,{icon:"angle-left","aria-hidden":"true"}),S[5]||(S[5]=c("span",{class:"fa-sr-only"},"Back",-1))])):k("",!0)]),footer:U(()=>[n.value?k("",!0):(a(),q(J,{key:0,variant:"grey",onClick:F},{default:U(()=>S[6]||(S[6]=[V(" Close ")])),_:1})),n.value?(a(),q(J,{key:1,variant:"grey",onClick:$},{default:U(()=>S[7]||(S[7]=[V(" Cancel ")])),_:1})):k("",!0),n.value?(a(),q(J,{key:2,variant:"primary",onClick:L},{default:U(()=>S[8]||(S[8]=[V(" Save ")])),_:1})):k("",!0)]),default:U(()=>[n.value?k("",!0):(a(),v("div",Ma,[c("p",Aa,T(h.value),1),n.value?k("",!0):(a(),q(J,{key:0,loading:_.value,disabled:s.value,class:"self-end",variant:"text",icon:"plus",onClick:S[0]||(S[0]=N=>M())},{default:U(()=>[V(" New "+T(u.value)+" Decoy ",1)]),_:1},8,["loading","disabled"]))])),s.value&&!n.value?(a(),q(I,{key:1,variant:"warning",class:"mb-16"},{default:U(()=>[V("You have reached the maximum of "+T(Ce)+" decoys for "+T(u.value)+". ",1)]),_:1})):k("",!0),l.value?(a(),q(I,{key:2,variant:"danger",class:"mb-16"},{default:U(()=>[V(T(w(Ie)(l.value)),1)]),_:1})):k("",!0),n.value?(a(),q(Sa,{key:4,"asset-type":e.assetType,"asset-data":D(i.value.assetData),"trigger-submit":m.value,"trigger-cancel":f.value,onUpdateAsset:S[3]||(S[3]=N=>{j(N)}),onUpdateTemporaryAsset:S[4]||(S[4]=N=>{Y(N)})},null,8,["asset-type","asset-data","trigger-submit","trigger-cancel"])):(a(),q(Pt,{key:3,"asset-type":e.assetType,"asset-data":d.value,onShowAssetDetails:S[1]||(S[1]=(N,le)=>g(N,le)),onDeleteAsset:S[2]||(S[2]=N=>{H(N)})},null,8,["asset-type","asset-data"]))]),_:1},8,["title","has-close-button"])}}}),Ca={class:"infra-token__title-wrapper"},qa={class:"grid md:grid-cols-3 gap-16 justify-center items-center"},Da={class:"flex flex-row items-center md:justify-end gap-16 justify-center"},Ea=["aria-valuemax","aria-valuenow"],Ua={key:1,class:"mt-[20px] grid gap-16 grid-cols-1 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-5 auto-rows-fr"},Qa={key:2,class:"flex items-stretch flex-col px-24"},Va={key:0},Ya={class:"grid gap-16 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 auto-rows-fr"},Ia={class:"flex flex-col items-center mt-32"},Fa=B({__name:"GeneratePlan",props:{initialStepData:{},currentStepData:{}},emits:["updateStep","storeCurrentStepData"],setup(r,{emit:o}){const e=o,t=r,{token:n,auth_token:i,proposed_plan:m,available_ai_names:f,is_managing_token:_}=t.initialStepData,l=b(!1),d=b(!1),x=b(""),s=b(!1),u=b(!1),h=b(!0),g=b({S3Bucket:!1,SQSQueue:!1,SSMParameter:!1,SecretsManagerSecret:!1,DynamoDBTable:!1}),{totalAiQuota:D,availableAiQuota:j,isTotalQuotaInitialized:Y}=Re(),M=b({S3Bucket:[],SQSQueue:[],SSMParameter:[],SecretsManagerSecret:[],DynamoDBTable:[]}),H=()=>{Object.keys(g.value).forEach(p=>{g.value[p]=!1})},{isAiGenerateErrorMessage:F,fetchAIgeneratedAssets:L,aiGeneratedAssetsCount:$}=mt(n,i,M,Pe,H,g);ge(()=>{var y;if((y=t.currentStepData)==null?void 0:y.proposed_plan){M.value=t.currentStepData.proposed_plan,h.value=!1;return}m.assets&&Object.keys(m.assets).length>0?M.value=m.assets:M.value={S3Bucket:[],SQSQueue:[],SSMParameter:[],SecretsManagerSecret:[],DynamoDBTable:[]},_?(Se(Mt),Ze(f)):L(M.value),setTimeout(()=>{h.value=!1},300)});const Q=A(()=>{const p=D.value,y=j.value,E=p?Math.min(y/p*100,100):0;return y>20?`--bar-color: #22c55e; --progress: ${E}%;`:y>8?`--bar-color: #eab308; --progress: ${E}%;`:`--bar-color: #ef4444; --progress: ${E}%;`}),S=A(()=>j.value>0?`We generate decoy names with AI. You have ${j.value} names available out of ${D.value}.`:"You have reached your limit for generated names. You can continue with manual setup."),K=A(()=>D.value<=0&&j.value<=0&&!_?"warning":"success"),J=A(()=>D.value<=0&&j.value<=0&&!_?"We analyzed your AWS account. It's not possible to generate decoys for your AWS account because you've run out of credits. However, you can still manually set up the decoys and then generate your Canarytoken.":_?"We analysed your account. You can review or edit the decoy resources before we generate your Terraform module.":`We analysed your account. Based on the names (and quantities) of your existing resources, we suggest adding the following ${$.value} decoy resources into your account. You can review or edit this before we generate your Terraform module.`),I=A(()=>Object.values(R).reduce((p,y)=>{const E=M.value[y];return E===null||(p[y]=E||[]),p},{})),re=A(()=>{var p,y,E,C,W;return!((p=M.value.S3Bucket)!=null&&p.length)&&!((y=M.value.SQSQueue)!=null&&y.length)&&!((E=M.value.SSMParameter)!=null&&E.length)&&!((C=M.value.SecretsManagerSecret)!=null&&C.length)&&!((W=M.value.DynamoDBTable)!=null&&W.length)}),N=A(()=>Object.entries(M.value).filter(([,p])=>p===null).map(([p])=>p)),le=A(()=>`We couldn't inventory the following asset${N.value.length>1?"s":""}:
  ${N.value.join(", ")}.
  Please check the permissions and run the inventory again.`);function ve(p){return g.value[p]||!1}function ce(){return Object.values(g.value).some(p=>p)}function Pe(p){Y.value||Se(Math.floor(p)||0),Ne(Math.floor(p)||0)}function ze(p,y){M.value[p].splice(y,1)}function Be(p){const{open:y,close:E}=ot({component:Ta,attrs:{assetType:p,assetData:A(()=>I.value[p]),closeModal:()=>{E()},"onUpdate-asset":C=>{const{assetType:W,assetData:_e,index:ee}=C;he(W,_e,ee)},"onDelete-asset":C=>{ze(p,C)},"onAdd-asset":C=>{he(p,C,-1)}}});y()}function he(p,y,E){var C;u.value=!1,M.value[p]||(M.value[p]=[]),E===-1?(C=M.value[p])==null||C.unshift(y):M.value[p][E]=y}async function Fe(){var y,E;l.value=!0,d.value=!1,x.value="",s.value=!1,u.value=!1;const p={assets:M.value};if(re.value){l.value=!1,u.value=!0;return}try{const C=await lt(n,i,p);if(C.status!==200){l.value=!1,d.value=!0,x.value=C.data.message;return}s.value=!0,e("storeCurrentStepData",{token:n,auth_token:i,proposed_plan:M.value,is_managing_token:_}),e("updateStep")}catch(C){d.value=!0,x.value=((E=(y=C.response)==null?void 0:y.data)==null?void 0:E.message)||C.message||"We couldn`t save the plan. Please, try again",s.value=!1}finally{l.value=!1}}return te(M,p=>{Tt(p)},{deep:!0}),(p,y)=>{const E=qe,C=we,W=ye,_e=fe("tooltip");return a(),v(z,null,[c("div",Ca,[c("div",qa,[y[2]||(y[2]=c("span",null,null,-1)),y[3]||(y[3]=c("h2",null,"Review your Decoys",-1)),c("div",Da,[y[1]||(y[1]=c("p",null,"Name generation requests left",-1)),ce()?(a(),q(E,{key:0,class:"w-[2.5rem] h-[2.5rem] shrink-0",type:"circle"})):oe((a(),v("div",{key:1,class:"ai-name-count",style:Qe(Q.value),role:"progressbar","aria-valuemax":w(D),"aria-valuemin":"0","aria-valuenow":w(j)},[c("span",null,T(w(j)),1)],12,Ea)),[[_e,{content:S.value,triggers:["hover"]}]])])])]),ce()||h.value?(a(),q(E,{key:0,class:"mb-24",type:"rectangle",style:{height:"100px",width:"100%"}})):k("",!0),h.value?(a(),v("div",Ua,[(a(),v(z,null,O(5,ee=>Z(E,{key:ee,type:"rectangle",class:"h-[210px]"})),64))])):k("",!0),h.value?k("",!0):(a(),v("div",Qa,[w(F)?(a(),q(C,{key:0,variant:"warning",class:"mt-16 mb-16"},{default:U(()=>[V(T(w(F)),1)]),_:1})):k("",!0),c("div",null,[!ce()&&!w(F)?(a(),v("div",Va,[Z(C,{variant:K.value,class:"mb-24"},{default:U(()=>[V(T(J.value),1)]),_:1},8,["variant"])])):k("",!0),c("ul",Ya,[(a(!0),v(z,null,O(I.value,(ee,me,$e)=>(a(),q(kt,{key:`${me}-${$e}`,"asset-data":ee,"asset-type":me,"is-loading-data":ve(me),onOpenAsset:Za=>Be(me)},null,8,["asset-data","asset-type","is-loading-data","onOpenAsset"]))),128))]),N.value.length>0?(a(),q(C,{key:1,variant:"warning",class:"mt-16 mb-16"},{default:U(()=>[V(T(le.value),1)]),_:1})):k("",!0)]),c("div",Ia,[u.value?(a(),q(C,{key:0,class:"mb-24",variant:"danger"},{default:U(()=>y[4]||(y[4]=[V("You haven't added any decoys to your plan. You must have at least one decoy to be able to get alerts.")])),_:1})):k("",!0),Z(W,{loading:l.value,disabled:ce(),onClick:y[0]||(y[0]=ee=>Fe())},{default:U(()=>[V(T(l.value?"Saving...":"Save configuration"),1)]),_:1},8,["loading","disabled"]),d.value?(a(),q(C,{key:1,class:"mt-24",variant:"danger"},{default:U(()=>[V(T(x.value),1)]),_:1})):k("",!0)])]))],64)}}});export{Fa as default};
