const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ManageToken-DePeiM2s.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-BM9StWka.js","assets/index-oMzHRwJc.js","assets/index-BRXqXBpq.css","assets/ManageToken-C_64fctr.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-BdgqdGJ6.js","assets/BaseCodeSnippet.vue_vue_type_script_setup_true_lang-DZf5eRC9.js","assets/BaseCopyButton-CHEgU_jO.js","assets/BaseCopyButton-LPnTCIdy.css","assets/BaseCodeSnippet-D6zLgBnL.css","assets/ManageToken-BrUdnn-H.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-B3Mn4Dvo.js","assets/ManageToken-BASY0i-y.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-DtTSxIg-.js","assets/ManageToken-DQdM_h0F.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-CFmBlU5F.js","assets/BaseSwitch-Cg5kWscd.js","assets/BaseSwitch-DoZCPshJ.css","assets/ManageToken-Eiu9-wfI.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-DBl6HkPW.js","assets/ManageToken-DYArDP6R.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-Vc0Un7wf.js","assets/TokenDisplay-BlTd1c62.css","assets/ManageToken-BDT3yMZt.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-DNt4xIiP.js","assets/ManageToken-Cef3rXU-.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-Dm9qFBB-.js","assets/ManageToken-CfPx913U.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-RXzv977R.js","assets/ManageToken-CCixf5oW.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-CtumRLoI.js","assets/ManageToken-CmTyPHF4.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-yPjQRdvX.js","assets/ManageToken-D4D0Sb-F.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-nRwZdbau.js","assets/ManageToken-Bn42Y_UL.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-DoY1s-TF.js","assets/ManageToken-B6QEhVi5.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-BfDzOHVw.js","assets/ManageToken-tB02S5pc.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-D9Z45niy.js","assets/pwaIconService-SorFleGz.js","assets/ManageToken-DLFXbeIg.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-D0tx9arg.js","assets/ManageToken-CLKJkIGM.js","assets/ManageToken-DM9CnTLw.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-yQCzyhQ4.js","assets/ManageToken-Dsy-8Z9G.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-DbJHKiUR.js","assets/ManageToken-D_J_tNIH.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-Dov-BtxX.js","assets/ManageToken-C4JPGaI9.js","assets/generateSVNToken-BckzcVBz.js","assets/ManageToken-CuEuOICH.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-BiThQVDw.js","assets/ManageToken-DMms1eZC.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-B098RTL6.js","assets/ManageToken-DEsWBTX4.js","assets/TokenDisplay-D4vxtgXD.js","assets/TokenDisplay-2eAMrOh4.css","assets/ManageToken-fIQZy4qU.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-DjjTSYqH.js","assets/ManageToken-DKRc1WF7.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-BLNecbLT.js","assets/ManageToken-BE93Ajzr.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-B6plmovl.js"])))=>i.map(i=>d[i]);
import{A as H}from"./AppLayoutOneColumn-f0o5jL4m.js";import{d as O,r as p,o as K,S as m,a as i,c as h,b as w,w as C,u as E,e as T,T as L,G as j,U,s as Y,f as u,g as P,h as x,i as d,j as f,_ as q,k as N,n as F,l as W,t as B,m as z,p as $,q as G,v as J,x as Z,y as Q,z as X,A as ee,B as oe,C as ae,D as te,E as V,F as ne,H as se,I as re,J as le,K as ue,L as ie,M as _e,N as a}from"./index-oMzHRwJc.js";import{_ as de}from"./BaseSwitch-Cg5kWscd.js";const ce={class:"flex flex-col gap-24"},D="An error occurred. Please try again.",me=O({__name:"SettingsToken",props:{tokenBackendResponse:{}},setup(R){const n=R;function s(){return n.tokenBackendResponse.canarydrop.type===L.WEB_BUG||n.tokenBackendResponse.canarydrop.type===L.WEB_IMAGE}function r(){return n.tokenBackendResponse.canarydrop.type===L.WEB_IMAGE}const v=p(n.tokenBackendResponse.canarydrop.alert_email_recipient),t=p(n.tokenBackendResponse.canarydrop.alert_webhook_url),M=p(s()),b=p(r()),e=p({[m.EMAIL]:!1,[m.WEB_HOOK]:!1,[m.BROWSER_SCANNER]:!1,[m.WEB_IMAGE]:!1}),k=p({[m.EMAIL]:!1,[m.WEB_HOOK]:!1,[m.BROWSER_SCANNER]:!1,[m.WEB_IMAGE]:!1}),_=p({[m.EMAIL]:!1,[m.WEB_HOOK]:!1,[m.BROWSER_SCANNER]:!1,[m.WEB_IMAGE]:!1});K(()=>{Object.keys(m).forEach(c=>{const l=j[c];e.value[c]=!!n.tokenBackendResponse.canarydrop[l],k.value[c]=!1,_.value[c]=!1})});function I(c){return c?"on":"off"}async function A(c,l){var o;const y={value:I(l),token:(o=n.tokenBackendResponse.canarydrop.canarytoken)==null?void 0:o._value,auth:n.tokenBackendResponse.canarydrop.auth,setting:U[c]};Object.keys(_.value).forEach(g=>{_.value[g]=!1}),k.value[c]=!0;try{const g=await Y(y);g.status===200?e.value[c]=l:(console.log("Error:",g.data.detail),_.value[c]=!0)}catch(g){console.log(g,"error!"),_.value[c]=!0}finally{k.value[c]=!1}}return(c,l)=>{const y=de;return i(),h("div",ce,[v.value?(i(),w(y,{key:0,id:"email-alert",modelValue:e.value.EMAIL,"onUpdate:modelValue":l[0]||(l[0]=o=>e.value.EMAIL=o),label:"Email alerts","helper-message":c.tokenBackendResponse.canarydrop.alert_email_recipient,loading:k.value.EMAIL,"has-error":_.value.EMAIL,"error-message":D,onClick:l[1]||(l[1]=C(o=>A(E(m).EMAIL,!e.value.EMAIL),["prevent"]))},null,8,["modelValue","helper-message","loading","has-error"])):T("",!0),t.value?(i(),w(y,{key:1,id:"webhook-alert",modelValue:e.value.WEB_HOOK,"onUpdate:modelValue":l[2]||(l[2]=o=>e.value.WEB_HOOK=o),label:"Webhook reporting","helper-message":n.tokenBackendResponse.canarydrop.alert_webhook_url,loading:k.value.WEB_HOOK,"has-error":_.value.WEB_HOOK,"error-message":D,onClick:l[3]||(l[3]=C(o=>A(E(m).WEB_HOOK,!e.value.WEB_HOOK),["prevent"]))},null,8,["modelValue","helper-message","loading","has-error"])):T("",!0),M.value?(i(),w(y,{key:2,id:"browser-alert",modelValue:e.value.BROWSER_SCANNER,"onUpdate:modelValue":l[4]||(l[4]=o=>e.value.BROWSER_SCANNER=o),label:"Browser scanner","helper-message":"Runs Javascript fingerprinting when the token is browsed",loading:k.value.BROWSER_SCANNER,"has-error":_.value.BROWSER_SCANNER,"error-message":D,onClick:l[5]||(l[5]=C(o=>A(E(m).BROWSER_SCANNER,!e.value.BROWSER_SCANNER),["prevent"]))},null,8,["modelValue","loading","has-error"])):T("",!0),b.value?(i(),w(y,{key:3,id:"custom-image",modelValue:e.value.WEB_IMAGE,"onUpdate:modelValue":l[6]||(l[6]=o=>e.value.WEB_IMAGE=o),label:"Custom web image","helper-message":"Serve your alternative image",loading:k.value.WEB_IMAGE,"has-error":_.value.WEB_IMAGE,"error-message":D,onClick:l[7]||(l[7]=C(o=>A(E(m).WEB_IMAGE,!e.value.WEB_IMAGE),["prevent"]))},null,8,["modelValue","loading","has-error"])):T("",!0)])}}}),pe={class:"grid sm:grid-cols-[1fr_5fr] border gap-32 border-grey-200 items-center p-32 bg-white rounded-3xl shadow-solid-shadow-grey"},ve={class:"justify-center hidden sm:flex"},ke=["src"],ge={class:"text-left"},fe={class:"mt-16 leading-relaxed text-balance text-grey-500"},Ee=O({__name:"BannerTextCanarytools",setup(R){return(n,s)=>{const r=q;return i(),h("div",pe,[u("div",ve,[u("img",{src:E(P)("thinkst_canary_logo.png"),alt:"logo Canarytokens",class:"w-full sm:block max-w-[8rem]"},null,8,ke)]),u("div",ge,[s[2]||(s[2]=u("p",{class:"text-xl font-semibold leading-normal text-grey-800"}," We hope you enjoy the free version of Canarytokens! ",-1)),u("p",fe,[s[1]||(s[1]=x(" For more (non-public) tokens, support, mass-deployment-tools and better management of your deployed tokens, check out our commercial offering at ")),d(r,{class:"font-semibold",href:"https://canary.tools",target:"_blank"},{default:f(()=>s[0]||(s[0]=[x("https://canary.tools")])),_:1})])])])}}}),ye={class:"relative mb-16"},he=["src","alt"],Te={key:1,class:"flex flex-row justify-center w-full"},we=O({__name:"DeleteTokenModal",props:{auth:{},token:{},type:{},closeModal:{type:Function}},setup(R){const n=N(),s=p(!1),r=p(""),v=p(""),t=R,M=async()=>{s.value=!0,r.value="";const b={auth:t.auth,token:t.token};try{const e=await z(b);e.status===200?(v.value="Yay! Your Canarytoken, plus associated alerts, has been successfully deleted.",setTimeout(()=>{t.closeModal(),n.push({name:"home"})},3e3)):e.status===404?(t.closeModal(),n.push({name:"error"})):r.value="Oh no! Something went wrong when deleting your Canarytoken."}catch(e){console.log(e,"err!"),r.value=e.toString()}finally{s.value=!1}};return(b,e)=>{const k=$,_=G,I=J;return i(),w(I,{"documentation-link":"","has-back-button":!1,title:"Delete token","has-close-button":!0},{footer:f(()=>[u("div",null,[r.value||v.value?(i(),w(k,{key:0,class:F(`w-[90%] m-auto ${r.value?"mb-16":""}`),variant:v.value?"success":"danger",message:r.value||v.value},null,8,["class","variant","message"])):T("",!0),v.value?T("",!0):(i(),h("div",Te,[d(_,{variant:"grey",class:"mr-8",onClick:e[0]||(e[0]=A=>b.closeModal())},{default:f(()=>e[2]||(e[2]=[x("No, keep it")])),_:1}),d(_,{variant:"danger",loading:s.value,onClick:e[1]||(e[1]=A=>M())},{default:f(()=>e[3]||(e[3]=[x("Yes, delete")])),_:1},8,["loading"])]))])]),default:f(()=>[u("span",ye,[d(W,{title:E(B)[t.type].label,"logo-img-url":E(B)[t.type].icon,class:"h-[6rem] w-[6rem]","has-shadow":!0,"has-animation":!0},null,8,["title","logo-img-url"]),u("img",{src:E(P)("token_icons/delete_token_badge.png"),alt:`${E(B)[t.type].label}`,class:"absolute w-[1.3rem] bottom-[.5rem] right-[.3rem]"},null,8,he)]),e[4]||(e[4]=u("div",{class:"text-center"},[u("p",{class:"text-xl font-semibold leading-normal text-grey-800"}," Are you sure you want to delete this Canarytoken? "),u("p",{class:"mt-8 leading-normal text-normal text-grey-300"}," All associated alerts will be permanently lost ")],-1))]),_:1})}}}),xe={class:"flex flex-row items-center justify-between mt-32"},Re=O({__name:"DeleteTokenButton",props:{memo:{},token:{},auth:{},type:{}},setup(R){function n(s,r,v){const{open:t,close:M}=Z({component:we,attrs:{type:s,auth:r,token:v,closeModal:()=>M()}});t()}return(s,r)=>{const v=G;return i(),h("div",xe,[r[2]||(r[2]=u("div",{class:"flex flex-col"},[u("span",null,"Delete Canarytoken"),u("span",{class:"text-xs leading-4 text-grey-500 pr-[3rem]"},"Remove this Canarytoken and delete all related alerts")],-1)),u("div",null,[d(v,{variant:"danger",border:!0,onClick:r[0]||(r[0]=t=>n(s.type,s.auth,s.token))},{default:f(()=>r[1]||(r[1]=[x("Delete")])),_:1})])])}}}),be={},Ae={class:"flex flex-row items-center self-start flex-grow gap-16 py-8 w-full bg-grey-100 rounded-2xl min-h-[3rem] text-grey"},Me={class:"py-8 text-pretty"};function Be(R,n){const s=X("font-awesome-icon");return i(),h("div",null,[n[0]||(n[0]=u("h3",{class:"inline-block mb-8 text-grey-500"},"Your Memo for this token",-1)),u("div",Ae,[d(s,{icon:"quote-left",class:"pl-16 text-2xl text-grey-300"}),u("p",Me,[ee(R.$slots,"default")])])])}const Oe=Q(be,[["render",Be]]),Ie={key:0,class:"flex flex-col items-center gap-8 mb-24"},Ce={class:"text-xl text-center text-grey-800"},Ve={key:1,class:"flex flex-col items-center w-full gap-8"},De={key:3,class:"md:mx-32 md:max-w-[50vw] w-full"},Le={class:"flex flex-col justify-center p-16 md:p-32 rounded-3xl bg-grey-50"},Se={class:"flex flex-col w-full gap-8"},Pe={key:0},Ne={key:1},We={class:"font-bold"},$e=["href"],Ge={class:"flex justify-center sm:max-w-[50vw]"},He=O({__name:"ManageToken",setup(R){const n=oe(),s=N(),r=p(!1),v=p(null),t=p(),M=p(),b=p({props:{}}),e=p(0),k=p(),_=ae(()=>t.value.canarydrop.expected_referrer==="microsoftonline.com"?L.AZURE_ENTRA_CONFIG:t.value.canarydrop.type);function I(){const y=n.params.auth,o=n.params.token;s.push({name:"history",params:{auth:y,token:o}})}function A(){window.open(k.value.public_location,"_blank")}async function c(){r.value=!0;const y={auth:n.params.auth,token:n.params.token};try{const o=await ie(y);r.value=!1,t.value=o.data,M.value=`token_icons/${B[_.value].icon}`,e.value=t.value.canarydrop.triggered_details.hits.length,k.value=t.value.canarydrop.key_exposed_details,l()}catch(o){console.log(o,"err!"),v.value=o.toString(),s.push({name:"error"})}finally{r.value=!1}}async function l(){b.value=await le(()=>_e(Object.assign({"./tokens/adobe_pdf/ManageToken.vue":()=>a(()=>import("./ManageToken-DePeiM2s.js"),__vite__mapDeps([0,1,2,3])),"./tokens/aws_keys/ManageToken.vue":()=>a(()=>import("./ManageToken-C_64fctr.js"),__vite__mapDeps([4,5,6,7,2,3,8,9])),"./tokens/azure_id/ManageToken.vue":()=>a(()=>import("./ManageToken-BrUdnn-H.js"),__vite__mapDeps([10,11,2,3,6,7,8,9])),"./tokens/azure_id_config/ManageToken.vue":()=>a(()=>import("./ManageToken-BASY0i-y.js"),__vite__mapDeps([12,13,2,3])),"./tokens/clonedsite/ManageToken.vue":()=>a(()=>import("./ManageToken-DQdM_h0F.js"),__vite__mapDeps([14,15,16,2,3,17,6,7,8,9])),"./tokens/cmd/ManageToken.vue":()=>a(()=>import("./ManageToken-Eiu9-wfI.js"),__vite__mapDeps([18,19,2,3])),"./tokens/credit_card_v2/ManageToken.vue":()=>a(()=>import("./ManageToken-DYArDP6R.js"),__vite__mapDeps([20,21,2,3,7,8,22])),"./tokens/cssclonedsite/ManageToken.vue":()=>a(()=>import("./ManageToken-BDT3yMZt.js"),__vite__mapDeps([23,24,6,7,2,3,8,9])),"./tokens/dns/ManageToken.vue":()=>a(()=>import("./ManageToken-Cef3rXU-.js"),__vite__mapDeps([25,26,6,7,2,3,8,9])),"./tokens/fast_redirect/ManageToken.vue":()=>a(()=>import("./ManageToken-CfPx913U.js"),__vite__mapDeps([27,28,6,7,2,3,8,9])),"./tokens/kubeconfig/ManageToken.vue":()=>a(()=>import("./ManageToken-CCixf5oW.js"),__vite__mapDeps([29,30,2,3])),"./tokens/log4shell/ManageToken.vue":()=>a(()=>import("./ManageToken-CmTyPHF4.js"),__vite__mapDeps([31,32,6,7,2,3,8,9])),"./tokens/ms_excel/ManageToken.vue":()=>a(()=>import("./ManageToken-D4D0Sb-F.js"),__vite__mapDeps([33,34,2,3])),"./tokens/ms_word/ManageToken.vue":()=>a(()=>import("./ManageToken-Bn42Y_UL.js"),__vite__mapDeps([35,36,2,3])),"./tokens/my_sql/ManageToken.vue":()=>a(()=>import("./ManageToken-B6QEhVi5.js"),__vite__mapDeps([37,38,16,2,3,17,6,7,8,9])),"./tokens/pwa/ManageToken.vue":()=>a(()=>import("./ManageToken-tB02S5pc.js"),__vite__mapDeps([39,40,2,3,41])),"./tokens/qr_code/ManageToken.vue":()=>a(()=>import("./ManageToken-DLFXbeIg.js"),__vite__mapDeps([42,43,2,3])),"./tokens/signed_exe/ManageToken.vue":()=>a(()=>import("./ManageToken-CLKJkIGM.js"),__vite__mapDeps([44,2,3])),"./tokens/slow_redirect/ManageToken.vue":()=>a(()=>import("./ManageToken-DM9CnTLw.js"),__vite__mapDeps([45,46,6,7,2,3,8,9])),"./tokens/smtp/ManageToken.vue":()=>a(()=>import("./ManageToken-Dsy-8Z9G.js"),__vite__mapDeps([47,48,6,7,2,3,8,9])),"./tokens/sql_server/ManageToken.vue":()=>a(()=>import("./ManageToken-D_J_tNIH.js"),__vite__mapDeps([49,50,6,7,2,3,8,9])),"./tokens/svn/ManageToken.vue":()=>a(()=>import("./ManageToken-C4JPGaI9.js"),__vite__mapDeps([51,52,6,7,2,3,8,9])),"./tokens/web/ManageToken.vue":()=>a(()=>import("./ManageToken-CuEuOICH.js"),__vite__mapDeps([53,54,6,7,2,3,8,9])),"./tokens/web_image/ManageToken.vue":()=>a(()=>import("./ManageToken-DMms1eZC.js"),__vite__mapDeps([55,56,6,7,2,3,8,9])),"./tokens/webdav/ManageToken.vue":()=>a(()=>import("./ManageToken-DEsWBTX4.js"),__vite__mapDeps([57,58,6,7,2,3,8,9,59])),"./tokens/windows_dir/ManageToken.vue":()=>a(()=>import("./ManageToken-fIQZy4qU.js"),__vite__mapDeps([60,2,3,61])),"./tokens/windows_fake_fs/ManageToken.vue":()=>a(()=>import("./ManageToken-DKRc1WF7.js"),__vite__mapDeps([62,63,2,3])),"./tokens/wireguard/ManageToken.vue":()=>a(()=>import("./ManageToken-BE93Ajzr.js"),__vite__mapDeps([64,65,6,7,2,3,8,9]))}),`./tokens/${_.value}/ManageToken.vue`,4))}return l(),te(()=>n.params.token,c,{immediate:!0}),(y,o)=>{const g=ue,S=$;return i(),h(re,null,[t.value?(i(),h("div",Ie,[d(W,{title:E(B)[_.value].label,"logo-img-url":E(B)[_.value].icon,class:"h-[4rem] w-[4rem]","has-shadow":!1},null,8,["title","logo-img-url"]),u("h2",Ce,V(E(B)[_.value].label),1)])):T("",!0),r.value?(i(),h("div",Ve,[d(g,{type:"circle",class:"w-[60px] h-[60px]"}),d(g,{type:"header",class:"w-[200px]"}),d(g,{type:"rectangle",class:"md:max-w-[50vw] w-full h-[250px] mt-16"})])):T("",!0),v.value?(i(),w(S,{key:2,variant:"danger",message:"Oh no! Something went wrong when managing your Canarytoken data. Please refresh the page or try again later."})):T("",!0),t.value?(i(),h("div",De,[u("div",Le,[(i(),w(se,null,{fallback:f(()=>[u("div",Se,[d(g,{class:"w-[100px]",type:"text"}),d(g,{class:"w-full",type:"header"})])]),default:f(()=>[(i(),w(ne(b.value),{"token-backend-response":t.value},null,8,["token-backend-response"]))]),_:1})),d(Oe,{class:"mt-32"},{default:f(()=>[x(V(t.value.canarydrop.memo),1)]),_:1}),d(me,{"token-backend-response":t.value,class:"mt-32"},null,8,["token-backend-response"]),d(S,{class:"mt-32",variant:e.value?"danger":"info","text-link":e.value?"Check History":"",onClick:I},{default:f(()=>[e.value?(i(),h("span",Ne,[o[0]||(o[0]=x(" This Canarytoken has been triggered ")),u("span",We,V(e.value),1),x(" time"+V(e.value>1?"s":""),1)])):(i(),h("span",Pe,"This Canarytoken has never been triggered"))]),_:1},8,["variant","text-link"]),k.value?(i(),w(S,{key:0,class:"mt-32",variant:"warning","text-link":"Go to token",onClick:A},{default:f(()=>[o[1]||(o[1]=x(" This Canarytoken has been found ")),u("a",{class:"font-bold",href:k.value.public_location,target:"_blank"},"here",8,$e),o[2]||(o[2]=x(" on the internet. Please replace it with a new Canarytoken. "))]),_:1})):T("",!0),d(Re,{memo:t.value.canarydrop.memo,token:t.value.canarydrop.canarytoken._value,auth:t.value.canarydrop.auth,type:t.value.canarydrop.type},null,8,["memo","token","auth","type"])]),u("div",Ge,[d(Ee,{class:"mt-32 mb-8"})])])):T("",!0)],64)}}}),Ye=O({__name:"ManageView",setup(R){return(n,s)=>(i(),w(H,null,{default:f(()=>[d(He)]),_:1}))}});export{Ye as default};
