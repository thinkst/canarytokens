const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ManageToken-BGeB7uuX.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-DarZ75Q8.js","assets/index-DhIzIdaJ.js","assets/index-Cx5a3qil.css","assets/ManageToken-CT-wSJ-P.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-CVPWzEjn.js","assets/BaseCodeSnippet.vue_vue_type_script_setup_true_lang-BIPwYJTE.js","assets/BaseCopyButton-B5SkmyTf.js","assets/BaseCopyButton-BVl_HsmY.css","assets/BaseCodeSnippet-D6zLgBnL.css","assets/ManageToken-lnnjoiJk.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-C2JQFeAa.js","assets/ManageToken-Dk4BWDzw.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-BH-QvGZr.js","assets/ManageToken-BixcKsSd.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-BCkG34Vd.js","assets/BaseSwitch-Iwt08TJq.js","assets/BaseSwitch-DoZCPshJ.css","assets/ManageToken-CH7KxvLG.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-w_wptKOd.js","assets/ManageToken-C-jIbRba.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-ahDMUer8.js","assets/TokenDisplay-pRsrUqCi.css","assets/ManageToken-D6BrPQyJ.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-vaiul_I3.js","assets/ManageToken-CY2OqiuQ.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-BccGXaAe.js","assets/ManageToken-r7uLbQIP.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-MDtATWYf.js","assets/ManageToken-DFmapKpY.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-C3tj9f4o.js","assets/ManageToken-Bh3dPYAk.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-B9MIaTTM.js","assets/ManageToken-nfusffV1.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-KdQtCAHc.js","assets/ManageToken-DMUUIXSH.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-BTGd9vf9.js","assets/ManageToken-CQqSJsXF.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-Fq7B_M_p.js","assets/ManageToken-D6gQF2dH.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-CzamK0pq.js","assets/pwaIconService-D89q6y8O.js","assets/ManageToken-CJfV-JKr.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-BcSsi2sM.js","assets/ManageToken-X9RwNfMZ.js","assets/ManageToken-B8vvEifW.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-A74pNfxC.js","assets/ManageToken-CY7z-hJ3.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-CgpIxveZ.js","assets/ManageToken-BPwZ0qk4.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-MJ5FMNhi.js","assets/ManageToken-DwHd1dlX.js","assets/generateSVNToken-Div0npK6.js","assets/ManageToken-BUle6of_.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-BbGQ_lrW.js","assets/ManageToken-Cp-IeMB6.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-CEs4dKNq.js","assets/ManageToken-IF7cmpPe.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-CuIY9hBa.js","assets/ManageToken-DX0wEt1U.js","assets/TokenDisplay.vue_vue_type_script_setup_true_lang-F3GHXDIi.js"])))=>i.map(i=>d[i]);
import{A as G}from"./AppLayoutOneColumn-PNOQHTSM.js";import{d as O,r as m,o as H,S as c,a as u,c as E,b as h,w as C,u as f,e as T,T as D,G as K,U as j,s as U,f as l,g as L,h as A,i,j as y,_ as Y,k as P,n as q,l as N,t as b,m as F,p as W,q as $,v as z,x as J,y as Z,z as Q,A as X,B as ee,C as oe,D as ae,E as V,F as te,H as ne,I as se,J as re,K as le,L as ue,M as _e,N as t}from"./index-DhIzIdaJ.js";import{_ as ie}from"./BaseSwitch-Iwt08TJq.js";const de={class:"flex flex-col gap-24"},S="An error occurred. Please try again.",ce=O({__name:"SettingsToken",props:{tokenBackendResponse:{}},setup(x){const n=x;function s(){return n.tokenBackendResponse.canarydrop.type===D.WEB_BUG||n.tokenBackendResponse.canarydrop.type===D.WEB_IMAGE}function r(){return n.tokenBackendResponse.canarydrop.type===D.WEB_IMAGE}const v=m(n.tokenBackendResponse.canarydrop.alert_email_recipient),a=m(n.tokenBackendResponse.canarydrop.alert_webhook_url),M=m(s()),w=m(r()),e=m({[c.EMAIL]:!1,[c.WEB_HOOK]:!1,[c.BROWSER_SCANNER]:!1,[c.WEB_IMAGE]:!1}),p=m({[c.EMAIL]:!1,[c.WEB_HOOK]:!1,[c.BROWSER_SCANNER]:!1,[c.WEB_IMAGE]:!1}),k=m({[c.EMAIL]:!1,[c.WEB_HOOK]:!1,[c.BROWSER_SCANNER]:!1,[c.WEB_IMAGE]:!1});H(()=>{Object.keys(c).forEach(_=>{const o=K[_];e.value[_]=!!n.tokenBackendResponse.canarydrop[o],p.value[_]=!1,k.value[_]=!1})});function I(_){return _?"on":"off"}async function R(_,o){var d;const g={value:I(o),token:(d=n.tokenBackendResponse.canarydrop.canarytoken)==null?void 0:d._value,auth:n.tokenBackendResponse.canarydrop.auth,setting:j[_]};Object.keys(k.value).forEach(B=>{k.value[B]=!1}),p.value[_]=!0;try{const B=await U(g);B.status===200?e.value[_]=o:(console.log("Error:",B.data.detail),k.value[_]=!0)}catch(B){console.log(B,"error!"),k.value[_]=!0}finally{p.value[_]=!1}}return(_,o)=>{const g=ie;return u(),E("div",de,[v.value?(u(),h(g,{key:0,id:"email-alert",modelValue:e.value.EMAIL,"onUpdate:modelValue":o[0]||(o[0]=d=>e.value.EMAIL=d),label:"Email alerts","helper-message":_.tokenBackendResponse.canarydrop.alert_email_recipient,loading:p.value.EMAIL,"has-error":k.value.EMAIL,"error-message":S,onClick:o[1]||(o[1]=C(d=>R(f(c).EMAIL,!e.value.EMAIL),["prevent"]))},null,8,["modelValue","helper-message","loading","has-error"])):T("",!0),a.value?(u(),h(g,{key:1,id:"webhook-alert",modelValue:e.value.WEB_HOOK,"onUpdate:modelValue":o[2]||(o[2]=d=>e.value.WEB_HOOK=d),label:"Webhook reporting","helper-message":n.tokenBackendResponse.canarydrop.alert_webhook_url,loading:p.value.WEB_HOOK,"has-error":k.value.WEB_HOOK,"error-message":S,onClick:o[3]||(o[3]=C(d=>R(f(c).WEB_HOOK,!e.value.WEB_HOOK),["prevent"]))},null,8,["modelValue","helper-message","loading","has-error"])):T("",!0),M.value?(u(),h(g,{key:2,id:"browser-alert",modelValue:e.value.BROWSER_SCANNER,"onUpdate:modelValue":o[4]||(o[4]=d=>e.value.BROWSER_SCANNER=d),label:"Browser scanner","helper-message":"Runs Javascript fingerprinting when the token is browsed",loading:p.value.BROWSER_SCANNER,"has-error":k.value.BROWSER_SCANNER,"error-message":S,onClick:o[5]||(o[5]=C(d=>R(f(c).BROWSER_SCANNER,!e.value.BROWSER_SCANNER),["prevent"]))},null,8,["modelValue","loading","has-error"])):T("",!0),w.value?(u(),h(g,{key:3,id:"custom-image",modelValue:e.value.WEB_IMAGE,"onUpdate:modelValue":o[6]||(o[6]=d=>e.value.WEB_IMAGE=d),label:"Custom web image","helper-message":"Serve your alternative image",loading:p.value.WEB_IMAGE,"has-error":k.value.WEB_IMAGE,"error-message":S,onClick:o[7]||(o[7]=C(d=>R(f(c).WEB_IMAGE,!e.value.WEB_IMAGE),["prevent"]))},null,8,["modelValue","loading","has-error"])):T("",!0)])}}}),me={class:"grid sm:grid-cols-[1fr_5fr] border gap-32 border-grey-200 items-center p-32 bg-white rounded-3xl shadow-solid-shadow-grey"},pe={class:"justify-center hidden sm:flex"},ve=["src"],ke={class:"text-left"},ge={class:"mt-16 leading-relaxed text-balance text-grey-500"},fe=O({__name:"BannerTextCanarytools",setup(x){return(n,s)=>{const r=Y;return u(),E("div",me,[l("div",pe,[l("img",{src:f(L)("thinkst_canary_logo.png"),alt:"logo Canarytokens",class:"w-full sm:block max-w-[8rem]"},null,8,ve)]),l("div",ke,[s[2]||(s[2]=l("p",{class:"text-xl font-semibold leading-normal text-grey-800"}," We hope you enjoy the free version of Canarytokens! ",-1)),l("p",ge,[s[1]||(s[1]=A(" For more (non-public) tokens, support, mass-deployment-tools and better management of your deployed tokens, check out our commercial offering at ")),i(r,{class:"font-semibold",href:"https://canary.tools",target:"_blank"},{default:y(()=>s[0]||(s[0]=[A("https://canary.tools")])),_:1})])])])}}}),Ee={class:"relative mb-16"},ye=["src","alt"],he={key:1,class:"flex flex-row justify-center w-full"},Te=O({__name:"DeleteTokenModal",props:{auth:{},token:{},type:{},closeModal:{type:Function}},setup(x){const n=P(),s=m(!1),r=m(""),v=m(""),a=x,M=async()=>{s.value=!0,r.value="";const w={auth:a.auth,token:a.token};try{const e=await F(w);e.status===200?(v.value="Yay! Your Canarytoken, plus associated alerts, has been successfully deleted.",setTimeout(()=>{a.closeModal(),n.push({name:"home"})},3e3)):e.status===404?(a.closeModal(),n.push({name:"error"})):r.value="Oh no! Something went wrong when deleting your Canarytoken."}catch(e){console.log(e,"err!"),r.value=e.toString()}finally{s.value=!1}};return(w,e)=>{const p=W,k=$,I=z;return u(),h(I,{"documentation-link":"","has-back-button":!1,title:"Delete token","has-close-button":!0},{footer:y(()=>[l("div",null,[r.value||v.value?(u(),h(p,{key:0,class:q(`w-[90%] m-auto ${r.value?"mb-16":""}`),variant:v.value?"success":"danger",message:r.value||v.value},null,8,["class","variant","message"])):T("",!0),v.value?T("",!0):(u(),E("div",he,[i(k,{variant:"grey",class:"mr-8",onClick:e[0]||(e[0]=R=>w.closeModal())},{default:y(()=>e[2]||(e[2]=[A("No, keep it")])),_:1}),i(k,{variant:"danger",loading:s.value,onClick:e[1]||(e[1]=R=>M())},{default:y(()=>e[3]||(e[3]=[A("Yes, delete")])),_:1},8,["loading"])]))])]),default:y(()=>[l("span",Ee,[i(N,{title:f(b)[a.type].label,"logo-img-url":f(b)[a.type].icon,class:"h-[6rem] w-[6rem]","has-shadow":!0,"has-animation":!0},null,8,["title","logo-img-url"]),l("img",{src:f(L)("token_icons/delete_token_badge.png"),alt:`${f(b)[a.type].label}`,class:"absolute w-[1.3rem] bottom-[.5rem] right-[.3rem]"},null,8,ye)]),e[4]||(e[4]=l("div",{class:"text-center"},[l("p",{class:"text-xl font-semibold leading-normal text-grey-800"}," Are you sure you want to delete this Canarytoken? "),l("p",{class:"mt-8 leading-normal text-normal text-grey-300"}," All associated alerts will be permanently lost ")],-1))]),_:1})}}}),xe={class:"flex flex-row items-center justify-between mt-32"},Re=O({__name:"DeleteTokenButton",props:{memo:{},token:{},auth:{},type:{}},setup(x){function n(s,r,v){const{open:a,close:M}=J({component:Te,attrs:{type:s,auth:r,token:v,closeModal:()=>M()}});a()}return(s,r)=>{const v=$;return u(),E("div",xe,[r[2]||(r[2]=l("div",{class:"flex flex-col"},[l("span",null,"Delete Canarytoken"),l("span",{class:"text-xs leading-4 text-grey-500 pr-[3rem]"},"Remove this Canarytoken and delete all related alerts")],-1)),l("div",null,[i(v,{variant:"danger",border:!0,onClick:r[0]||(r[0]=a=>n(s.type,s.auth,s.token))},{default:y(()=>r[1]||(r[1]=[A("Delete")])),_:1})])])}}}),we={},Ae={class:"flex flex-row items-center self-start flex-grow gap-16 py-8 w-full bg-grey-100 rounded-2xl min-h-[3rem] text-grey"},Me={class:"py-8 text-pretty"};function be(x,n){const s=Q("font-awesome-icon");return u(),E("div",null,[n[0]||(n[0]=l("h3",{class:"inline-block mb-8 text-grey-500"},"Your Memo for this token",-1)),l("div",Ae,[i(s,{icon:"quote-left",class:"pl-16 text-2xl text-grey-300"}),l("p",Me,[X(x.$slots,"default")])])])}const Be=Z(we,[["render",be]]),Oe={key:0,class:"flex flex-col items-center gap-8 mb-24"},Ie={class:"text-xl text-center text-grey-800"},Ce={key:1,class:"flex flex-col items-center w-full gap-8"},Ve={key:3,class:"md:mx-32 md:max-w-[50vw] w-full"},Se={class:"flex flex-col justify-center p-16 md:p-32 rounded-3xl bg-grey-50"},De={class:"flex flex-col w-full gap-8"},Le={key:0},Pe={key:1},Ne={class:"font-bold"},We={class:"flex justify-center sm:max-w-[50vw]"},$e=O({__name:"ManageToken",setup(x){const n=ee(),s=P(),r=m(!1),v=m(null),a=m(),M=m(),w=m({props:{}}),e=m(0),p=oe(()=>a.value.canarydrop.expected_referrer==="microsoftonline.com"?D.AZURE_ENTRA_CONFIG:a.value.canarydrop.type);function k(){const _=n.params.auth,o=n.params.token;s.push({name:"history",params:{auth:_,token:o}})}async function I(){r.value=!0;const _={auth:n.params.auth,token:n.params.token};try{const o=await ue(_);r.value=!1,a.value=o.data,M.value=`token_icons/${b[p.value].icon}`,e.value=a.value.canarydrop.triggered_details.hits.length,R()}catch(o){console.log(o,"err!"),v.value=o.toString(),s.push({name:"error"})}finally{r.value=!1}}async function R(){w.value=await re(()=>_e(Object.assign({"./tokens/adobe_pdf/ManageToken.vue":()=>t(()=>import("./ManageToken-BGeB7uuX.js"),__vite__mapDeps([0,1,2,3])),"./tokens/aws_keys/ManageToken.vue":()=>t(()=>import("./ManageToken-CT-wSJ-P.js"),__vite__mapDeps([4,5,6,7,2,3,8,9])),"./tokens/azure_id/ManageToken.vue":()=>t(()=>import("./ManageToken-lnnjoiJk.js"),__vite__mapDeps([10,11,2,3,6,7,8,9])),"./tokens/azure_id_config/ManageToken.vue":()=>t(()=>import("./ManageToken-Dk4BWDzw.js"),__vite__mapDeps([12,13,2,3])),"./tokens/clonedsite/ManageToken.vue":()=>t(()=>import("./ManageToken-BixcKsSd.js"),__vite__mapDeps([14,15,16,2,3,17,6,7,8,9])),"./tokens/cmd/ManageToken.vue":()=>t(()=>import("./ManageToken-CH7KxvLG.js"),__vite__mapDeps([18,19,2,3])),"./tokens/credit_card_v2/ManageToken.vue":()=>t(()=>import("./ManageToken-C-jIbRba.js"),__vite__mapDeps([20,21,2,3,7,8,22])),"./tokens/cssclonedsite/ManageToken.vue":()=>t(()=>import("./ManageToken-D6BrPQyJ.js"),__vite__mapDeps([23,24,6,7,2,3,8,9])),"./tokens/dns/ManageToken.vue":()=>t(()=>import("./ManageToken-CY2OqiuQ.js"),__vite__mapDeps([25,26,6,7,2,3,8,9])),"./tokens/fast_redirect/ManageToken.vue":()=>t(()=>import("./ManageToken-r7uLbQIP.js"),__vite__mapDeps([27,28,6,7,2,3,8,9])),"./tokens/kubeconfig/ManageToken.vue":()=>t(()=>import("./ManageToken-DFmapKpY.js"),__vite__mapDeps([29,30,2,3])),"./tokens/log4shell/ManageToken.vue":()=>t(()=>import("./ManageToken-Bh3dPYAk.js"),__vite__mapDeps([31,32,6,7,2,3,8,9])),"./tokens/ms_excel/ManageToken.vue":()=>t(()=>import("./ManageToken-nfusffV1.js"),__vite__mapDeps([33,34,2,3])),"./tokens/ms_word/ManageToken.vue":()=>t(()=>import("./ManageToken-DMUUIXSH.js"),__vite__mapDeps([35,36,2,3])),"./tokens/my_sql/ManageToken.vue":()=>t(()=>import("./ManageToken-CQqSJsXF.js"),__vite__mapDeps([37,38,16,2,3,17,6,7,8,9])),"./tokens/pwa/ManageToken.vue":()=>t(()=>import("./ManageToken-D6gQF2dH.js"),__vite__mapDeps([39,40,2,3,41])),"./tokens/qr_code/ManageToken.vue":()=>t(()=>import("./ManageToken-CJfV-JKr.js"),__vite__mapDeps([42,43,2,3])),"./tokens/signed_exe/ManageToken.vue":()=>t(()=>import("./ManageToken-X9RwNfMZ.js"),__vite__mapDeps([44,2,3])),"./tokens/slow_redirect/ManageToken.vue":()=>t(()=>import("./ManageToken-B8vvEifW.js"),__vite__mapDeps([45,46,6,7,2,3,8,9])),"./tokens/smtp/ManageToken.vue":()=>t(()=>import("./ManageToken-CY7z-hJ3.js"),__vite__mapDeps([47,48,6,7,2,3,8,9])),"./tokens/sql_server/ManageToken.vue":()=>t(()=>import("./ManageToken-BPwZ0qk4.js"),__vite__mapDeps([49,50,6,7,2,3,8,9])),"./tokens/svn/ManageToken.vue":()=>t(()=>import("./ManageToken-DwHd1dlX.js"),__vite__mapDeps([51,52,6,7,2,3,8,9])),"./tokens/web/ManageToken.vue":()=>t(()=>import("./ManageToken-BUle6of_.js"),__vite__mapDeps([53,54,6,7,2,3,8,9])),"./tokens/web_image/ManageToken.vue":()=>t(()=>import("./ManageToken-Cp-IeMB6.js"),__vite__mapDeps([55,56,6,7,2,3,8,9])),"./tokens/windows_dir/ManageToken.vue":()=>t(()=>import("./ManageToken-IF7cmpPe.js"),__vite__mapDeps([57,2,3,58])),"./tokens/wireguard/ManageToken.vue":()=>t(()=>import("./ManageToken-DX0wEt1U.js"),__vite__mapDeps([59,60,6,7,2,3,8,9]))}),`./tokens/${p.value}/ManageToken.vue`,4))}return R(),ae(()=>n.params.token,I,{immediate:!0}),(_,o)=>{const g=le,d=W;return u(),E(se,null,[a.value?(u(),E("div",Oe,[i(N,{title:f(b)[p.value].label,"logo-img-url":f(b)[p.value].icon,class:"h-[4rem] w-[4rem]","has-shadow":!1},null,8,["title","logo-img-url"]),l("h2",Ie,V(f(b)[p.value].label),1)])):T("",!0),r.value?(u(),E("div",Ce,[i(g,{type:"circle",class:"w-[60px] h-[60px]"}),i(g,{type:"header",class:"w-[200px]"}),i(g,{type:"rectangle",class:"md:max-w-[50vw] w-full h-[250px] mt-16"})])):T("",!0),v.value?(u(),h(d,{key:2,variant:"danger",message:"Oh no! Something went wrong when managing your Canarytoken data. Please refresh the page or try again later."})):T("",!0),a.value?(u(),E("div",Ve,[l("div",Se,[(u(),h(ne,null,{fallback:y(()=>[l("div",De,[i(g,{class:"w-[100px]",type:"text"}),i(g,{class:"w-full",type:"header"})])]),default:y(()=>[(u(),h(te(w.value),{"token-backend-response":a.value},null,8,["token-backend-response"]))]),_:1})),i(Be,{class:"mt-32"},{default:y(()=>[A(V(a.value.canarydrop.memo),1)]),_:1}),i(ce,{"token-backend-response":a.value,class:"mt-32"},null,8,["token-backend-response"]),i(d,{class:"mt-32",variant:e.value?"danger":"info","text-link":e.value?"Check History":"",onClick:k},{default:y(()=>[e.value?(u(),E("span",Pe,[o[0]||(o[0]=A(" This Canarytoken has been triggered ")),l("span",Ne,V(e.value),1),A(" time"+V(e.value>1?"s":""),1)])):(u(),E("span",Le,"This Canarytoken has never been triggered"))]),_:1},8,["variant","text-link"]),i(Re,{memo:a.value.canarydrop.memo,token:a.value.canarydrop.canarytoken._value,auth:a.value.canarydrop.auth,type:a.value.canarydrop.type},null,8,["memo","token","auth","type"])]),l("div",We,[i(fe,{class:"mt-32 mb-8"})])])):T("",!0)],64)}}}),je=O({__name:"ManageView",setup(x){return(n,s)=>(u(),h(G,null,{default:y(()=>[i($e)]),_:1}))}});export{je as default};
